<audio title="11ï½œäº‹ä»¶å¤„ç†ï¼šReactåˆæˆäº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸ç”¨åŸç”ŸDOMäº‹ä»¶ï¼Ÿ" src="https://static001.geekbang.org/resource/audio/6e/44/6e962ab9b6a7853b786a6dc78c7acd44.mp3" controls="controls"></audio> 
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å®‹ä¸€ç®ï¼Œæ¬¢è¿å›åˆ°Reactåº”ç”¨å¼€å‘çš„å­¦ä¹ ã€‚</p><p>å‰é¢ä¸¤èŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†React Hooksï¼ŒåŠ ä¸Šå‰é¢ç¬¬8èŠ‚è¯¾å­¦åˆ°çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè¿™äº›APIéƒ½å¯ä»¥ç”¨æ¥ç¼–å†™ç»„ä»¶é€»è¾‘ã€‚ä¸è¿‡åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®²åˆ°çš„ç»„ä»¶é€»è¾‘ä»¥å±•ç¤ºä¸ºä¸»ï¼Œä¸ç”¨æˆ·çš„äº¤äº’æ˜¯åå•å‘çš„ï¼Œè€Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒWebåº”ç”¨ä¹ŸåŒ…å«å¾ˆå¤š<strong>åŒå‘äº¤äº’</strong>ã€‚å®ç°åŒå‘äº¤äº’çš„ä¸€ä¸ªé‡è¦é€”å¾„ï¼Œå°±æ˜¯<strong>äº‹ä»¶å¤„ç†</strong>ã€‚</p><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œäº‹ä»¶å¤„ç†ä¸æ˜¯ä¸€ä¸ªæ–°é²œçš„æ¦‚å¿µã€‚æ ‡å‡†çš„DOM APIä¸­ï¼Œæœ‰å®Œæ•´çš„DOMäº‹ä»¶ä½“ç³»ã€‚åˆ©ç”¨DOMäº‹ä»¶ï¼Œå°¤å…¶æ˜¯å…¶æ•è·å’Œå†’æ³¡æœºåˆ¶ï¼Œç½‘é¡µå¯ä»¥å®ç°å¾ˆå¤šå¤æ‚äº¤äº’ã€‚</p><p>Reacté‡Œå†…å»ºäº†ä¸€å¥—åä¸º<strong>åˆæˆäº‹ä»¶</strong>ï¼ˆSyntheticEventï¼‰çš„äº‹ä»¶ç³»ç»Ÿï¼Œå’ŒDOMäº‹ä»¶æœ‰æ‰€åŒºåˆ«ã€‚ä¸è¿‡ç¬¬ä¸€æ¬¡æ¥è§¦åˆ°åˆæˆäº‹ä»¶æ¦‚å¿µçš„å¼€å‘è€…ï¼Œå¸¸ä¼šæœ‰ä»¥ä¸‹ç–‘é—®ï¼š</p><ul>
<li>ä»€ä¹ˆæ˜¯Reactåˆæˆäº‹ä»¶ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆè¦ç”¨åˆæˆäº‹ä»¶è€Œä¸ç›´æ¥ç”¨åŸç”ŸDOMäº‹ä»¶ï¼Ÿ</li>
<li>åˆæˆäº‹ä»¶æœ‰å“ªäº›ä½¿ç”¨åœºæ™¯ï¼Ÿ</li>
<li>æœ‰å“ªäº›åœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨åŸç”ŸDOMäº‹ä»¶ï¼Ÿ</li>
</ul><p>ç»è¿‡è¿™èŠ‚è¯¾çš„å­¦ä¹ ï¼Œä½ å°†äº†è§£åˆ°<strong>åˆæˆäº‹ä»¶çš„åº•å±‚ä»ç„¶æ˜¯DOMäº‹ä»¶ï¼Œä½†éšè—äº†å¾ˆå¤šå¤æ‚æ€§å’Œè·¨æµè§ˆå™¨æ—¶çš„ä¸ä¸€è‡´æ€§</strong>ï¼Œæ›´æ˜“äºåœ¨Reactæ¡†æ¶ä¸­ä½¿ç”¨ã€‚åœ¨ <code>oh-my-kanban</code> å‡ºç°è¿‡çš„å—æ§ç»„ä»¶ï¼Œå°±æ˜¯åˆæˆäº‹ä»¶çš„é‡è¦ä½¿ç”¨åœºæ™¯ä¹‹ä¸€ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šåˆ©ç”¨å…¶ä»–åˆæˆäº‹ä»¶ä¸ºçœ‹æ¿å¡ç‰‡åŠ å…¥æ‹–æ‹½åŠŸèƒ½ï¼Œé¡ºä¾¿äº†è§£ä¸€ä¸‹åˆæˆäº‹ä»¶çš„å†’æ³¡æ•è·æœºåˆ¶ã€‚æœ€åï¼Œæˆ‘ä¼šä»‹ç»ä¸€äº›åœ¨Reactä¸­ä½¿ç”¨åŸç”ŸDOMäº‹ä»¶çš„åœºæ™¯ã€‚</p><!-- [[[read_end]]] --><h2>ä»€ä¹ˆæ˜¯Reactåˆæˆäº‹ä»¶ï¼Ÿ</h2><p>å¦‚æœä½ å¾ˆç†Ÿæ‚‰åŸç”ŸDOMäº‹ä»¶çš„ä½¿ç”¨ï¼Œé‚£ä½ åº”è¯¥å¾ˆç†Ÿæ‚‰è¿™ç§å†™æ³•ï¼š</p><pre><code class="language-xml">&lt;!-- è¿™æ˜¯HTMLä¸æ˜¯JSX --&gt;
&lt;button onclick="handleClick()"&gt;æŒ‰é’®&lt;/button&gt;
&lt;input type="text" onkeydown="handleKeyDown(event)" /&gt;
</code></pre><p>åœ¨Reactä¸­ï¼ŒHTMLå…ƒç´ ä¹Ÿæœ‰ç±»ä¼¼çš„ã€ä»¥ <code>on*</code> å¼€å¤´çš„<strong>äº‹ä»¶å¤„ç†å±æ€§ã€‚</strong>æœ€ç›´æ¥çš„ä¸åŒæ˜¯ï¼Œè¿™äº›å±æ€§çš„å‘½åæ–¹å¼éµå¾ªé©¼å³°æ ¼å¼ï¼ˆcamelCaseï¼‰ï¼Œå¦‚<code>onClick</code>ã€<code>onKeyDown</code>ã€‚åœ¨JSXä¸­ä½¿ç”¨è¿™äº›å±æ€§æ—¶ï¼Œéœ€è¦ä¼ å…¥å‡½æ•°ï¼Œè€Œä¸èƒ½æ˜¯å­—ç¬¦ä¸²ï¼š</p><pre><code class="language-javascript">const Component = () =&gt; {
  const handleClick = () =&gt; {/* ...çœç•¥ */};
  const handleKeyDown = evt =&gt; {/* ...çœç•¥ */};
  return (
    &lt;&gt;
      {/* è¿™æ¬¡æ˜¯JSXäº† */}
      &lt;button onClick={handleClick}&gt;æŒ‰é’®&lt;/button&gt;
      &lt;input type="text" onKeyDown={evt =&gt; handleKeyDown(evt)} /&gt;
    &lt;/&gt;
  );
};
</code></pre><p>ä»¥ä¸Šé¢çš„ <code>button</code> ä¸ºä¾‹ï¼Œå¼€å‘è€…å°† <code>handleClick</code> å‡½æ•°ä¼ å…¥ <code>onClick</code> å±æ€§ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œ<code>handleClick</code> ä¼šè¢«è°ƒç”¨ï¼Œæ— è®ºå¼€å‘è€…æ˜¯å¦éœ€è¦ï¼ŒReactéƒ½ä¼šä¼ å…¥ä¸€ä¸ªæè¿°ç‚¹å‡»äº‹ä»¶çš„å¯¹è±¡ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚è€Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯Reactä¸­çš„åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰ã€‚</p><p>åˆæˆäº‹ä»¶æ˜¯åŸç”ŸDOMäº‹ä»¶çš„ä¸€ç§åŒ…è£…ï¼Œå®ƒ<strong>ä¸åŸç”Ÿäº‹ä»¶çš„æ¥å£ç›¸åŒ</strong>ï¼Œæ ¹æ®W3cè§„èŒƒï¼ŒReactå†…éƒ¨<strong>è§„èŒƒåŒ–</strong>ï¼ˆNormalizeï¼‰<strong>äº†è¿™äº›æ¥å£åœ¨ä¸åŒæµè§ˆå™¨ä¹‹é—´çš„è¡Œä¸º</strong>ï¼Œå¼€å‘è€…ä¸ç”¨å†æ‹…å¿ƒäº‹ä»¶å¤„ç†çš„æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ã€‚</p><h2>åˆæˆäº‹ä»¶ä¸åŸç”ŸDOMäº‹ä»¶çš„åŒºåˆ«</h2><p>åŒ…æ‹¬åˆšæ‰æåˆ°çš„ï¼Œå¯¹äº‹ä»¶æ¥å£åœ¨ä¸åŒæµè§ˆå™¨è¡Œä¸ºçš„è§„èŒƒåŒ–ï¼Œåˆæˆäº‹ä»¶ä¸åŸç”ŸDOMäº‹ä»¶ä¹‹é—´ä¹Ÿæœ‰ç€ä¸€ç³»åˆ—çš„åŒºåˆ«ã€‚</p><h3>æ³¨å†Œäº‹ä»¶ç›‘å¬å‡½æ•°çš„æ–¹å¼ä¸åŒ</h3><p>ç›‘å¬åŸç”ŸDOMäº‹ä»¶åŸºæœ¬æœ‰ä¸‰ç§æ–¹å¼ã€‚</p><ol>
<li>ä¸Reactåˆæˆäº‹ä»¶ç±»ä¼¼çš„ï¼Œä»¥å†…è”æ–¹å¼å†™åœ¨HTMLæ ‡ç­¾ä¸­ï¼š</li>
</ol><pre><code class="language-xml">&lt;button id="btn" onclick="handleClick()"&gt;æŒ‰é’®&lt;/button&gt;
</code></pre><ol start="2">
<li>åœ¨JSä¸­èµ‹å€¼ç»™DOMå…ƒç´ çš„äº‹ä»¶å¤„ç†å±æ€§ï¼š</li>
</ol><pre><code class="language-javascript">document.getElementById('btn').onclick = handleClick;
</code></pre><ol start="3">
<li>åœ¨JSä¸­è°ƒç”¨DOMå…ƒç´ çš„ <code>addEventListener</code> æ–¹æ³•ï¼ˆéœ€è¦åœ¨åˆé€‚æ—¶æœºè°ƒç”¨ <code>removeEventListener</code> ä»¥é˜²å†…å­˜æ³„æ¼ï¼‰ï¼š</li>
</ol><pre><code class="language-javascript">document.getElementById('btn').addEventListener('click', handleClick);
</code></pre><p>è€Œåˆæˆäº‹ä»¶ä¸èƒ½é€šè¿‡ <code>addEventListener</code> æ–¹æ³•ç›‘å¬ï¼Œå®ƒçš„JSXå†™æ³•ç­‰åŒäºJSå†™æ³•ï¼š</p><pre><code class="language-javascript">const Button = () =&gt; (&lt;button onClick={handleClick}&gt;æŒ‰é’®&lt;/button&gt;);
// ç¼–è¯‘ä¸º
const Button = () =&gt; React.createElement('button', {
  onClick: handleClick
}, 'æŒ‰é’®');
</code></pre><p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦ä»¥æ•è·æ–¹å¼ç›‘å¬äº‹ä»¶ï¼Œåœ¨åŸç”Ÿäº‹ä»¶ä¸­ä»¥<code>addEventListener</code> æ–¹æ³•åŠ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š</p><pre><code class="language-javascript">div.addEventListener('click', handleClick, true);
</code></pre><p>è€Œåœ¨Reactåˆæˆäº‹ä»¶ä¸­ï¼Œåˆ™éœ€è¦ç”¨åœ¨äº‹ä»¶å±æ€§åé¢åŠ ä¸€ä¸ª <code>Capture</code> åç¼€ï¼š</p><pre><code class="language-javascript">() =&gt; (&lt;div onClickCapture={handleClick}&gt;...&lt;/div&gt;);
</code></pre><h3>ç‰¹å®šäº‹ä»¶çš„è¡Œä¸ºä¸åŒ</h3><p>Reactåˆæˆäº‹ä»¶è§„èŒƒåŒ–äº†ä¸€äº›åœ¨å„ä¸ªæµè§ˆå™¨é—´è¡Œä¸ºä¸ä¸€è‡´ï¼Œç”šè‡³æ˜¯åœ¨ä¸åŒå…ƒç´ ä¸Šè¡Œä¸ºä¸ä¸€è‡´çš„äº‹ä»¶ï¼Œå…¶ä¸­æœ‰ä»£è¡¨æ€§çš„æ˜¯ <code>onChange</code> ã€‚</p><p>åœ¨Chromeæˆ–Firefoxä¸­ï¼Œä¸€ä¸ªæ–‡æœ¬æ¡† <code>&lt;input type="text" /&gt;</code> çš„ <code>change</code> äº‹ä»¶å‘ç”Ÿåœ¨æ–‡æœ¬æ¡†å†…å®¹è¢«æ”¹å˜ã€ç„¶åå¤±å»ç„¦ç‚¹çš„æ—¶å€™ã€‚ä¸è¿‡ï¼Œå¯¹ä¸€ä¸ªä¸‹æ‹‰æ¡†<code>&lt;select&gt;</code> çš„<code>change</code> äº‹ä»¶ï¼ŒChromeå’Œè€ç‰ˆæœ¬Firefoxï¼ˆv63ä»¥å‰ï¼‰å°±æœ‰åˆ†æ­§äº†ï¼Œå‰è€…æ¯æ¬¡æŒ‰ä¸‹é”®ç›˜ç®­å¤´é”®éƒ½ä¼šè§¦å‘ <code>change</code> äº‹ä»¶ï¼Œä½†åè€…åªæœ‰ä¸‹æ‹‰æ¡†å¤±å»ç„¦ç‚¹æ—¶æ‰ä¼šè§¦å‘ã€‚</p><p>è€Œåœ¨Reactä¸­ï¼Œ<code>&lt;input&gt;</code> ã€<code>&lt;textarea&gt;</code> å’Œ <code>&lt;select&gt;</code> ä¸‰ç§è¡¨å•å…ƒç´ çš„<code>onChange</code> åˆæˆäº‹ä»¶è¢«è§„èŒƒæˆäº†ä¸€è‡´çš„è¡Œä¸ºï¼š<strong>åœ¨ä¸ä¼šå¯¼è‡´æ˜¾ç¤ºæŠ–åŠ¨çš„å‰æä¸‹ï¼Œè¡¨å•å…ƒç´ å€¼çš„æ”¹å˜ä¼šå°½å¯èƒ½åŠæ—¶åœ°è§¦å‘è¿™ä¸€äº‹ä»¶</strong>ã€‚</p><p>ä»¥æ–‡æœ¬æ¡†ä¸ºä¾‹ï¼ŒåŒæ ·æ˜¯è¾“å…¥ä¸€å¥è¯ï¼Œåˆæˆ <code>change</code> äº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°è¦å¤šäºåŸç”Ÿçš„æ¬¡æ•°ï¼Œåœ¨<code>onChange</code> äº‹ä»¶å¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼ å…¥çš„äº‹ä»¶å¯¹è±¡å‚æ•°æä¾›çš„è¡¨å•å…ƒç´ å€¼ä¹Ÿå°½å¯èƒ½æ˜¯æœ€æ–°çš„ã€‚</p><p>é¡ºä¾¿æä¸€ä¸‹ï¼ŒåŸç”Ÿ <code>change</code> äº‹ä»¶è¡Œä¸ºçš„ä¸ä¸€è‡´ï¼Œåªæ˜¯å‰ç«¯é¢†åŸŸæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜çš„å†°å±±ä¸€è§’ã€‚Reactè¿™æ ·çš„æ¡†æ¶ä¸ºæˆ‘ä»¬å±è”½äº†è¿™äº›ç–‘éš¾æ‚ç—‡ï¼Œæˆ‘ä»¬åœ¨äº«å—ä¾¿åˆ©çš„åŒæ—¶ï¼Œä¹Ÿéœ€è¦çŸ¥é“æ¡†æ¶ä»¬åœ¨è´Ÿé‡å‰è¡Œã€‚</p><p>é™¤äº† <code>onChange</code> ï¼Œåˆæˆäº‹ä»¶ä¹Ÿè§„èŒƒåŒ–äº† <code>onBeforeInput</code> ã€ <code>onMouseEnter</code> ã€ <code>onMouseLeave</code> ã€ <code>onSelect</code> ã€‚</p><h3>å®é™…æ³¨å†Œçš„ç›®æ ‡DOMå…ƒç´ ä¸åŒ</h3><p>è¿™ä¸€ç‚¹å…¶å®å¹¶ä¸å½±å“åˆæˆäº‹ä»¶å¤„ç†æ¥å£çš„ä½¿ç”¨ï¼Œæ›´å¤šæ˜¯åœ¨è®²åº•å±‚å®ç°ã€‚</p><p>å¯¹äºä¸‹é¢è¿™ä¸ªåŸç”ŸDOMäº‹ä»¶ï¼Œå®ƒçš„å½“å‰ç›®æ ‡ï¼ˆ <code>event.currentTarget</code> ï¼‰æ˜¯å¾ˆæ˜ç¡®çš„ï¼Œå°±æ˜¯IDä¸º <code>btn</code> çš„æŒ‰é’®ï¼š</p><pre><code class="language-javascript">document.getElementById('btn').addEventListener('click', handleClick);
</code></pre><p>ä½†åˆæˆäº‹ä»¶å°±ä¸ä¸€æ ·äº†ï¼</p><p>æˆ‘ä»¬åœ¨ <code>oh-my-kanban</code> çš„ä»£ç ï¼Œâ€œæ·»åŠ æ–°å¡ç‰‡â€çš„ <code>onClick</code> äº‹ä»¶å¤„ç†å‡½æ•° <code>handleAdd</code> ä¸­è®¾ä¸ªæ–­ç‚¹ï¼Œä¼ å…¥çš„ <code>evt</code> å‚æ•°å°±æ˜¯ä¸€ä¸ªåˆæˆäº‹ä»¶ï¼Œå·²çŸ¥é€šè¿‡ <code>evt.nativeEvent</code> å±æ€§ï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸ªåˆæˆäº‹ä»¶æ‰€åŒ…è£…çš„åŸç”Ÿäº‹ä»¶ã€‚</p><p>çœ‹ä¸€ä¸‹è¿™å‡ ä¸ªå€¼ï¼š</p><pre><code class="language-javascript">evt.currentTarget
evt.target
evt.nativeEvent.currentTarget
evt.nativeEvent.target
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸å‡ºæ„å¤–åœ°ï¼Œä¸¤ç§äº‹ä»¶çš„ <code>target</code> éƒ½æ˜¯æŒ‰é’®å…ƒç´ æœ¬èº«ï¼Œåˆæˆäº‹ä»¶çš„ <code>currentTarget</code> ä¹Ÿæ˜¯æŒ‰é’®å…ƒç´ ï¼Œè¿™æ˜¯ç¬¦åˆW3cè§„èŒƒçš„ï¼›ä½†åŸç”Ÿäº‹ä»¶çš„ <code>currentTarget</code> ä¸å†æ˜¯æŒ‰é’®ï¼Œè€Œæ˜¯Reactåº”ç”¨çš„æ ¹å®¹å™¨DOMå…ƒç´  <code>&lt;div id="root"&gt;&lt;/div&gt;</code> ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/48/05/48132e6d34958fd33632ac62aaa0f205.png?wh=1312x712" alt="å›¾ç‰‡"></p><p>è¿™æ˜¯å› ä¸ºReactä½¿ç”¨äº†<strong>äº‹ä»¶ä»£ç†æ¨¡å¼</strong>ã€‚Reactåœ¨åˆ›å»ºæ ¹ï¼ˆ <code>createRoot</code> ï¼‰çš„æ—¶å€™ï¼Œä¼šåœ¨å®¹å™¨ä¸Šç›‘å¬æ‰€æœ‰è‡ªå·±æ”¯æŒçš„åŸç”ŸDOMäº‹ä»¶ã€‚å½“åŸç”Ÿäº‹ä»¶è¢«è§¦å‘æ—¶ï¼ŒReactä¼šæ ¹æ®äº‹ä»¶çš„ç±»å‹å’Œç›®æ ‡å…ƒç´ ï¼Œæ‰¾åˆ°å¯¹åº”çš„FiberNodeå’Œäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ›å»ºç›¸åº”çš„åˆæˆäº‹ä»¶å¹¶è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°ã€‚</p><p>ä»è¡¨å±‚æ¥å£ä¸Šçœ‹ï¼Œåˆæˆäº‹ä»¶çš„å±æ€§æ˜¯ç¬¦åˆW3Cäº‹ä»¶è§„èŒƒçš„ï¼Œè¿™å°±å±è”½äº†ä¸åŒæµè§ˆå™¨åŸç”ŸDOMäº‹ä»¶å¯èƒ½äº§ç”Ÿçš„ä¸ä¸€è‡´ã€‚</p><h2>å—æ§ç»„ä»¶ä¸è¡¨å•</h2><p>è¡¨å•å¤„ç†æ˜¯å‰ç«¯é¢†åŸŸä¸€ä¸ªå¸¸è§éœ€æ±‚ï¼Œåœ¨Reactä¸­ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦åœºæ™¯ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹ç›®å‰ <code>oh-my-kanban</code> é¡¹ç›®ä¸­å”¯ä¸€çš„è¡¨å•ä»£ç ï¼ˆçœç•¥äº†éƒ¨åˆ†ä»£ç ï¼‰ï¼š</p><pre><code class="language-javascript">const KanbanNewCard = ({ onSubmit }) =&gt; {
&nbsp; const [title, setTitle] = useState('');
&nbsp; const handleChange = (evt) =&gt; {
&nbsp; &nbsp; setTitle(evt.target.value);
&nbsp; };
  // ...çœç•¥

&nbsp; return (
&nbsp; &nbsp; &lt;li&gt;
&nbsp; &nbsp; &nbsp; &lt;h3&gt;æ·»åŠ æ–°å¡ç‰‡&lt;/h3&gt;
&nbsp; &nbsp; &nbsp; &lt;div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="text" value={title} onChange={handleChange} /&gt;
&nbsp; &nbsp; &nbsp; &lt;/div&gt;
&nbsp; &nbsp; &lt;/li&gt;
&nbsp; );
};
</code></pre><p>ç”¨æˆ·åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥æ–‡æœ¬æ—¶ï¼Œä¼šè§¦å‘ <code>onChange</code> åˆæˆäº‹ä»¶ï¼Œè°ƒç”¨ <code>handleChange(evt)</code> å‡½æ•°ï¼Œ<code>handleChange</code> å‡½æ•°åˆä¼šå°†æ–‡æœ¬æ¡†å˜æ›´åçš„å€¼ä¿å­˜åœ¨ç»„ä»¶state <code>title</code> ä¸­ï¼Œstateçš„å˜åŒ–å¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œæ–‡æœ¬æ¡†çš„å½“å‰å€¼ä¼šæ›´æ–°æˆ <code>title</code> ï¼Œä¸åˆšæ‰çš„æ›´æ–°å€¼ä¿æŒä¸€è‡´ã€‚</p><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸€è¿‡ç¨‹å½¢æˆäº†ä¸€ä¸ªé—­ç¯ã€‚è¿™ç§<strong>ä»¥React stateä¸ºå•ä¸€äº‹å®æ¥æº</strong>ï¼ˆSingle Source of Truthï¼‰<strong>ï¼Œå¹¶ç”¨Reactåˆæˆäº‹ä»¶å¤„ç†ç”¨æˆ·äº¤äº’çš„ç»„ä»¶ï¼Œè¢«ç§°ä¸ºâ€œå—æ§ç»„ä»¶â€</strong>ã€‚</p><p>é™¤äº†æ–‡æœ¬æ¡†ä¹‹å¤–ï¼Œå¤§éƒ¨åˆ†è¡¨å•å…ƒç´ ï¼ŒåŒ…æ‹¬å•é€‰æ¡†ã€å¤šé€‰æ¡†ã€ä¸‹æ‹‰æ¡†ç­‰éƒ½å¯ä»¥åšæˆå—æ§ç»„ä»¶ã€‚å½“è¿™äº›å…ƒç´ ç»„åˆæˆä¸€ä¸ªè¡¨å•æ—¶ï¼Œå¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“è·å–åˆ°ä»»ä¸€æ—¶åˆ»çš„è¡¨å•æ•°æ®ï¼Œç„¶åè¿›ä¸€æ­¥åšéªŒè¯ã€æäº¤åˆ°æœåŠ¡å™¨ç«¯ç­‰æ“ä½œã€‚</p><p>å…¶å®çœ‹æ¿æ–°å¡ç‰‡ç»„ä»¶é‡Œæ–‡æœ¬æ¡†çš„ <code>onKeyDown</code> ï¼Œå¯ä»¥çœ‹ä½œæ˜¯æäº¤è¡¨å•ã€‚ç”¨æˆ·æŒ‰å›è½¦åï¼Œ <code>handleKeyDown</code> å‡½æ•°ä¼šé€šè¿‡ <code>onSubmit</code> å±æ€§å°†è¡¨å•å€¼ä¼ ç»™çˆ¶ç»„ä»¶ï¼š</p><pre><code class="language-javascript">const KanbanNewCard = ({ onSubmit }) =&gt; {
&nbsp; const [title, setTitle] = useState('');
&nbsp; const handleChange = (evt) =&gt; {
&nbsp; &nbsp; setTitle(evt.target.value);
&nbsp; };
&nbsp; const handleKeyDown = (evt) =&gt; {
&nbsp; &nbsp; if (evt.key === 'Enter') {
&nbsp; &nbsp; &nbsp; onSubmit(title);
&nbsp; &nbsp; }
&nbsp; };

&nbsp; return (
&nbsp; &nbsp; &lt;li&gt;
&nbsp; &nbsp; &nbsp; &lt;h3&gt;æ·»åŠ æ–°å¡ç‰‡&lt;/h3&gt;
&nbsp; &nbsp; &nbsp; &lt;div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="text" value={title}
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; onChange={handleChange} onKeyDown={handleKeyDown} /&gt;
&nbsp; &nbsp; &nbsp; &lt;/div&gt;
&nbsp; &nbsp; &lt;/li&gt;
&nbsp; );
};
</code></pre><p>ä½ ä¹Ÿå¯ä»¥é€‰æ‹©æ˜¾å¼åœ°å°†è¿™äº›è¡¨å•å…ƒç´ é›†ä¸­åœ¨ä¸€ä¸ª <code>&lt;form&gt;</code> è¡¨å•é‡Œï¼Œè¿™æ ·ä½ å°±å¯ä»¥åˆ©ç”¨è¡¨å•çš„ <code>onSubmit</code> äº‹ä»¶æ¥è§„èŒƒæäº¤è¡¨å•çš„æ—¶æœºã€‚ä½†è¦æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦ç¦ç”¨æ‰è¡¨å•æäº¤äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼š</p><pre><code class="language-javascript">const Form = () =&gt; {
  // ...çœç•¥
  const handleSubmit(evt) {
&nbsp; &nbsp; console.log('è¡¨å•å…ƒç´ state');
&nbsp; &nbsp; evt.preventDefault();
&nbsp; }
  return (
&nbsp; &nbsp; &lt;form onSubmit={handleSubmit}&gt;
&nbsp; &nbsp; &nbsp; {/* çœç•¥ */}
&nbsp; &nbsp; &nbsp; &lt;input type="submit" value="æäº¤" /&gt;
&nbsp; &nbsp; &lt;/form&gt;
&nbsp; );
};
</code></pre><p>åç»­è¯¾ç¨‹ä¸­è¿˜ä¼šå¤šæ¬¡æ¶‰åŠåˆ°å—æ§ç»„ä»¶å’Œè¡¨å•å¤„ç†ï¼Œæˆ‘ä»¬åœ¨æ­¤æš‚ä¸ç»§ç»­å±•å¼€ã€‚</p><h2>åˆæˆäº‹ä»¶çš„å†’æ³¡ä¸æ•è·</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨åˆšå­¦åˆ°çš„Reactäº‹ä»¶å¤„ç†ï¼Œä¸Šæ‰‹ç»§ç»­ä¸º <code>oh-my-kanban</code> æ·»åŠ åŠŸèƒ½ï¼Œå…¶é—´ä¹Ÿä¼šæ¶µç›–åˆæˆäº‹ä»¶çš„å†’æ³¡å’Œæ•è·æœºåˆ¶ã€‚</p><p>å¦‚æœä½ å¯¹ç¬¬3èŠ‚è¯¾æœ«å°¾æå‡ºçš„éœ€æ±‚è¿˜æœ‰å°è±¡ï¼Œè¿™ä¸ªå‘æˆ‘ä»¬ç»ˆäºè¦å¡«äº†ã€‚</p><blockquote>
<p>åœ¨ä¸‰ä¸ªçœ‹æ¿åˆ—é—´ï¼Œè¿˜æœ‰è¿›ä¸€æ­¥çš„äº¤äº’ã€‚</p>
<ol>
<li>å¯¹äºä»»æ„çœ‹æ¿åˆ—é‡Œçš„ä»»æ„å¡ç‰‡ï¼Œå¯ä»¥ç”¨é¼ æ ‡æ‹–æ‹½åˆ°å…¶ä»–çš„çœ‹æ¿åˆ—ï¼›</li>
<li>åœ¨é‡Šæ”¾æ‹–æ‹½æ—¶ï¼Œè¢«æ‹–æ‹½çš„å¡ç‰‡æ’å…¥åˆ°ç›®æ ‡çœ‹æ¿åˆ—ï¼Œå¹¶ä»åŸçœ‹æ¿åˆ—ä¸­ç§»é™¤ã€‚</li>
</ol>
</blockquote><p>æˆ‘ä»¬ç®€å•åˆ†æä¸€ä¸‹è¿™ä¸ªéœ€æ±‚ã€‚å°†è¢«æ‹–æ‹½çš„é¡¹ç›®æ˜¯çœ‹æ¿å¡ç‰‡ï¼Œæœ‰æ•ˆçš„æ”¾ç½®ç›®æ ‡æ˜¯çœ‹æ¿åˆ—ï¼Œæ”¾ç½®æˆåŠŸæ—¶ä¼šç§»åŠ¨è¿™å¼ å¡ç‰‡ã€‚è¿™æ ·çš„äº¤äº’å¯¹åº”çš„æ•°æ®é€»è¾‘å¦‚ä¸‹ï¼š</p><ul>
<li>è¢«æ‹–æ‹½çš„å¡ç‰‡å¯¹åº”çš„æ•°æ®ï¼Œæ˜¯å¾…å¤„ç†ã€è¿›è¡Œä¸­æˆ–å·²å®Œæˆæ•°ç»„çš„å…¶ä¸­ä¸€ä¸ªæˆå‘˜ï¼›</li>
<li>æ”¾ç½®æˆåŠŸæ—¶ï¼Œè¯¥æˆå‘˜ä¼šä»æºå¤´æ•°ç»„ä¸­ç§»é™¤ï¼ŒåŒæ—¶ä¼šæ·»åŠ åˆ°ç›®æ ‡æ•°ç»„ä¸­ã€‚</li>
</ul><p>é‚£åŸºæœ¬ä¸Šå°±å¯ä»¥ç¡®å®šè¿™ä¸ªéœ€æ±‚çš„å®ç°æ–¹æ³•äº†ï¼š</p><ul>
<li>åœ¨çœ‹æ¿åˆ—å’Œçœ‹æ¿å¡ç‰‡ç»„ä»¶å…ƒç´ ä¸Šï¼Œéœ€è¦åˆ†åˆ«ç›‘å¬æ‹–æ‹½äº‹ä»¶ï¼›</li>
<li>åœ¨ç»„ä»¶çŠ¶æ€ä¸­åº”è®°å½•å½“å‰è¢«æ‹–æ‹½å¡ç‰‡çš„æ•°æ®ï¼Œä»¥åŠå“ªä¸ªçœ‹æ¿åˆ—å¯¹åº”çš„çš„æ•°ç»„æ˜¯æ‹–æ‹½æºå¤´ï¼Œå“ªä¸ªæ˜¯æ”¾ç½®ç›®æ ‡ã€‚</li>
</ul><p>ç°åœ¨æ¥åˆ° <code>oh-my-kanban</code> çš„  <code>src/App.js</code> æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬å…ˆä¸ºçœ‹æ¿å¡ç‰‡ <code>KanbanCard</code> ç»„ä»¶çš„ <code>&lt;li&gt;</code> å…ƒç´ æ·»åŠ  <code>draggable</code> å’Œ  <code>onDragStart</code> å±æ€§ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/1a/5e/1ae98dab2e8c52b056db2678fc26ed5e.png?wh=1318x776" alt="å›¾ç‰‡"></p><p>ç„¶åä¸ºçœ‹æ¿åˆ—KanbanColumnç»„ä»¶çš„ <code>&lt;section&gt;</code> å…ƒç´ æ·»åŠ  <code>onDragOver</code> ã€ <code>onDragLeave</code>ã€<code>onDrop</code> ã€<code>onDragEnd</code> å±æ€§ï¼š</p><pre><code class="language-javascript">const KanbanColumn = ({ children, bgColor, title }) =&gt; {
&nbsp; return (
&nbsp; &nbsp; &lt;section
&nbsp; &nbsp; &nbsp; onDragOver={(evt) =&gt; {
&nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();
&nbsp; &nbsp; &nbsp; &nbsp; evt.dataTransfer.dropEffect = 'move';
&nbsp; &nbsp; &nbsp; }}
&nbsp; &nbsp; &nbsp; onDragLeave={(evt) =&gt; {
&nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();
&nbsp; &nbsp; &nbsp; &nbsp; evt.dataTransfer.dropEffect = 'none';
&nbsp; &nbsp; &nbsp; }}
&nbsp; &nbsp; &nbsp; onDrop={(evt) =&gt; {
&nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();
&nbsp; &nbsp; &nbsp; }}
&nbsp; &nbsp; &nbsp; onDragEnd={(evt) =&gt; {
&nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();
&nbsp; &nbsp; &nbsp; }}
&nbsp; &nbsp; &nbsp; css={css`...çœç•¥`}
&nbsp; &nbsp; &gt;
&nbsp; &nbsp; &nbsp; &lt;h2&gt;{title}&lt;/h2&gt;
&nbsp; &nbsp; &nbsp; &lt;ul&gt;{children}&lt;/ul&gt;
&nbsp; &nbsp; &lt;/section&gt;
&nbsp; );
};
</code></pre><p>è¿™æ—¶åœ¨æµè§ˆå™¨é‡Œå·²ç»å¯ä»¥æ‹–æ‹½å¡ç‰‡äº†ï¼Œä½†æ”¾ç½®æ—¶è²Œä¼¼æ²¡ä»€ä¹ˆååº”ï¼ŒåŠ¨å›¾å±•ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/a9/79/a9b0e4de6cb7bd81ddf0f703d4e58f79.gif?wh=760x500" alt="å›¾ç‰‡"></p><p>æ¥ä¸‹æ¥ï¼Œéœ€è¦åœ¨æ ¹éƒ¨çš„ <code>App</code> ç»„ä»¶é‡Œåˆ›å»ºä¸‰ä¸ªæ–°çš„stateï¼Œåˆ†åˆ«æ˜¯ <code>draggedItem</code> ã€ <code>dragSource</code> ã€ <code>dragTarget</code> ï¼Œä»¥åŠä½œä¸º<code>dragSource</code> å’Œ <code>dragTarget</code> æšä¸¾å€¼çš„ä¸‰ä¸ª <code>COLUMN_KEY_*</code> å¸¸é‡ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/f0/36/f08c321e374ca582d4b86bd29973df36.png?wh=1378x968" alt="å›¾ç‰‡"></p><p>è¿™æ—¶æˆ‘ä»¬éœ€è¦åœ¨çœ‹æ¿å¡ç‰‡ <code>KanbanCard</code> ç»„ä»¶ <code>onDragStart</code> äº‹ä»¶ä¸­æ›´æ–° draggedItemçŠ¶æ€çš„å€¼ï¼Œä½†è¿™ä¸ªstateæ˜¯åœ¨Appç»„ä»¶ä¸­ç»´æŠ¤çš„ï¼Œé‚£ä¹ˆå¦‚ä½•æ‰èƒ½è®©KanbanCardä¿®æ”¹å®ƒå‘¢ï¼Ÿ</p><p>æ˜¯çš„ï¼Œè·Ÿä¹‹å‰çš„onSubmitä¸€æ ·ï¼Œå°†æ›´æ–°å‡½æ•°é€šè¿‡propsä¼ ç»™KanbanCardï¼ŒKanbanCardä¼šåœ¨å†…éƒ¨çš„onDragStartä¸­è°ƒç”¨å®ƒï¼š</p><p><img src="https://static001.geekbang.org/resource/image/b6/ae/b667ca3abedf86f4f3420b20a4255dae.png?wh=886x1260" alt="å›¾ç‰‡"></p><p>ä¸Šé¢ä»£ç åªå±•ç¤ºäº†todoListï¼Œå¦å¤–ä¸¤ä¸ªç»„ä»¶åˆ—ï¼Œä¹Ÿå°±æ˜¯ongoingListå’ŒdoneListä¹Ÿè¦åšç›¸åŒå¤„ç†ï¼Œä½ å¯ä»¥è‡ªå·±ä¸Šæ‰‹è¯•ä¸€è¯•ã€‚</p><p>ç„¶åæ¥çœ‹ï¼Œå¦‚ä½•åœ¨çœ‹æ¿åˆ—KanbanColumnä¸­è®¾ç½®<code>dragSource</code> å’Œ <code>dragTarget</code> ã€‚</p><p>ä¸ºäº†è®©KanbanColumnå†…éƒ¨çš„é€»è¾‘æ›´æ¸…æ™°äº›ï¼Œæˆ‘æ²¡æœ‰æŠŠ<code>dragSource</code> å’Œ <code>dragTarget</code> ç›´æ¥ä¼ ç»™KanbanColumnï¼Œè€Œæ˜¯ä¸ºå®ƒæ·»åŠ äº†ä¸¤ä¸ªä¿®æ”¹å¸ƒå°”å€¼çš„å‡½æ•°propsï¼Œä¹Ÿå°±æ˜¯setIsDragSource å’Œ setIsDragTargetï¼š</p><p><img src="https://static001.geekbang.org/resource/image/ea/a2/ea2daa062e09eefa03bfdf1baa3be6a2.png?wh=862x1156" alt="å›¾ç‰‡"></p><p>ä¸Šé¢çš„KanbanCardçš„ä»£ç ä¸­ï¼Œ<code>&lt;li&gt;</code> å·²ç»ç›‘å¬è¿‡ <code>onDragStart</code> äº‹ä»¶ï¼Œåœ¨KanbanColumnçš„ <code>&lt;section&gt;</code> ä¸­æ˜¯ç¬¬äºŒæ¬¡å‡ºç°äº†ã€‚åœ¨è¿è¡Œæ—¶ï¼Œç”±äºHTMLå…ƒç´ çš„<code>onDragStart</code> äº‹ä»¶åœ¨è§¦å‘åä¼š<strong>å†’æ³¡</strong>ï¼ˆEvent Bubblingï¼‰åˆ°ç¥–å…ˆå…ƒç´ ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°éƒ½ä¼šæ‰§è¡Œã€‚</p><p>å¯¹åº”çš„ï¼Œåœ¨Appç»„ä»¶ä¸­éœ€è¦è®¾ç½®è¿™äº›propsï¼š</p><pre><code class="language-diff"> const DATA_STORE_KEY = 'kanban-data-store';
 const COLUMN_KEY_TODO = 'todo';
 const COLUMN_KEY_ONGOING = 'ongoing';
 const COLUMN_KEY_DONE = 'done';

 function App() {
 &nbsp; // ...çœç•¥
 &nbsp; const [draggedItem, setDraggedItem] = useState(null);
 &nbsp; const [dragSource, setDragSource] = useState(null);
 &nbsp; const [dragTarget, setDragTarget] = useState(null);

&nbsp;  return (
     {/* çœç•¥ */}
-&nbsp; &nbsp; &lt;KanbanColumn bgColor={COLUMN_BG_COLORS.todo} title={
 &nbsp; &nbsp; &nbsp; /* ... */
-&nbsp; &nbsp; }&gt;
+&nbsp; &nbsp; &lt;KanbanColumn
+&nbsp; &nbsp; &nbsp; bgColor={COLUMN_BG_COLORS.todo}
+&nbsp; &nbsp; &nbsp; title={
 &nbsp; &nbsp; &nbsp; &nbsp; /* ... */
+&nbsp; &nbsp; &nbsp; }
+&nbsp; &nbsp; &nbsp; setIsDragSource={(isSrc) =&gt; setDragSource(isSrc ? COLUMN_KEY_TODO : null)}
+&nbsp; &nbsp; &nbsp; setIsDragTarget={(isTgt) =&gt; setDragTarget(isTgt ? COLUMN_KEY_TODO : null)}
+&nbsp; &nbsp; &gt;
</code></pre><p>ä»¥ä¸Šçš„ä»£ç åªå±•ç¤ºäº†å¾…å¤„ç†åˆ—çš„æ”¹æ³•ï¼Œè¿›è¡Œä¸­å’Œå·²å®Œæˆä¸¤åˆ—åˆ†åˆ«å¯¹åº”å¸¸é‡COLUMN_KEY_ONGOINGå’ŒCOLUMN_KEY_DONEï¼Œéœ€è¦è¯·ä½ è¡¥å…¨å®ƒä»¬çš„setIsDragSource å’Œ setIsDragTargetã€‚</p><p>è¿™æ—¶æˆ‘ä»¬å€ŸåŠ©React Developer Toolsçœ‹çœ‹æ‹–æ‹½æ˜¯å¦‚ä½•ä¿®æ”¹stateçš„ï¼ŒåŠ¨å›¾æ•ˆæœå±•ç¤ºå¦‚ä¸‹ï¼š</p><p><video poster="https://media001.geekbang.org/795793366c4e4ea3bcfb9ad275523354/snapshots/03252dc0108f4e219ac8b33e07da2337-00002.jpg" preload="none" controls=""><source src="https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/279b1130-183405a3c16-0000-0000-01d-dbacd.mp4" type="video/mp4"><source src=" https://media001.geekbang.org/3527a58b0e12488d91706622fcab252b/5665d21cdfe14547b65862952206da53-da09f8590e67a7f17ee4980a98ee9abf-sd.m3u8" type="application/x-mpegURL"></video></p><p>èµï¼Œç¬¦åˆé¢„æœŸã€‚å¥½äº†ï¼Œæœ€åä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œæ˜¯åŠ å…¥onDropçš„æ•°æ®å¤„ç†é€»è¾‘ã€‚é¦–å…ˆæ˜¯KanbanColumnè¿½åŠ ä¸€ä¸ªonDropå±æ€§ï¼š</p><pre><code class="language-diff"> const KanbanColumn = ({
   children,
   bgColor,
   title, 
   setIsDragSource = () =&gt; {},
   setIsDragTarget = () =&gt; {},
+  onDrop
 }) =&gt; {
 &nbsp; return (
&nbsp;  &nbsp; &lt;section
       onDragStart={() =&gt; setIsDragSource(true)}
&nbsp; &nbsp; &nbsp;  onDragOver={(evt) =&gt; {
&nbsp; &nbsp; &nbsp;  &nbsp; evt.preventDefault();
&nbsp; &nbsp; &nbsp;  &nbsp; evt.dataTransfer.dropEffect = 'move';
         setIsDragTarget(true);
&nbsp; &nbsp;  &nbsp; }}
&nbsp; &nbsp;  &nbsp; onDragLeave={(evt) =&gt; {
&nbsp; &nbsp; &nbsp;  &nbsp; evt.preventDefault();
&nbsp; &nbsp; &nbsp;  &nbsp; evt.dataTransfer.dropEffect = 'none';
         setIsDragTarget(false);
&nbsp; &nbsp; &nbsp;  }}
&nbsp; &nbsp;  &nbsp; onDrop={(evt) =&gt; {
&nbsp; &nbsp;  &nbsp; &nbsp; evt.preventDefault();
+        onDrop &amp;&amp; onDrop(evt);
&nbsp;  &nbsp; &nbsp; }}
&nbsp; &nbsp; &nbsp;  onDragEnd={(evt) =&gt; {
&nbsp; &nbsp; &nbsp;  &nbsp; evt.preventDefault();
         setIsDragSource(false);
         setIsDragTarget(false);
&nbsp; &nbsp;  &nbsp; }}
&nbsp;  &nbsp; &nbsp; css={css`...çœç•¥`}
&nbsp;  &nbsp; &gt;
&nbsp;  &nbsp; &nbsp; &lt;h2&gt;{title}&lt;/h2&gt;
&nbsp;  &nbsp; &nbsp; &lt;ul&gt;{children}&lt;/ul&gt;
&nbsp;  &nbsp; &lt;/section&gt;
&nbsp;  );
 };
</code></pre><p>ç„¶ååœ¨Appç»„ä»¶ä¸­å®šä¹‰handleDropå‡½æ•°ï¼Œå½“å‰é¢çš„ä¸‰ä¸ªstateæ»¡è¶³æ¡ä»¶æ—¶ï¼Œä¿®æ”¹æºæ•°ç»„å’Œç›®æ ‡æ•°ç»„ï¼Œé€šè¿‡onDropå±æ€§æŠŠåŒä¸€ä¸ªå‡½æ•°åˆ†åˆ«ä¼ é€’ç»™ä¸‰ä¸ªKanbanColumnã€‚</p><p>åœ¨è¿™é‡Œï¼Œä¸ºäº†å‡å°‘ä»£ç é‡å¤ï¼Œæˆ‘åœ¨å‡½æ•°å†…éƒ¨ç»™ä¸‰ä¸ªæ•°ç»„çš„æ›´æ–°å‡½æ•°å¥—äº†ä¸€ä¸ªç´¢å¼•å¯¹è±¡ï¼š</p><pre><code class="language-javascript">const COLUMN_KEY_TODO = 'todo';
const COLUMN_KEY_ONGOING = 'ongoing';
const COLUMN_KEY_DONE = 'done';

function App() {
&nbsp; const [showAdd, setShowAdd] = useState(false);
&nbsp; const [todoList, setTodoList] = useState([/*çœç•¥*/]);
&nbsp; const [ongoingList, setOngoingList ] = useState([/*çœç•¥*/]);
&nbsp; const [doneList, setDoneList ] = useState([/*çœç•¥*/]);
&nbsp; // çœç•¥
  const handleSubmit = (title) =&gt; {/*çœç•¥*/};
  const [draggedItem, setDraggedItem] = useState(null);
&nbsp; const [dragSource, setDragSource] = useState(null);
&nbsp; const [dragTarget, setDragTarget] = useState(null);
&nbsp; const handleDrop = (evt) =&gt; {
&nbsp; &nbsp; if (!draggedItem || !dragSource || !dragTarget || dragSource === dragTarget) {
&nbsp; &nbsp; &nbsp; return;
&nbsp; &nbsp; }
&nbsp; &nbsp; const updaters = {
&nbsp; &nbsp; &nbsp; [COLUMN_KEY_TODO]: setTodoList,
&nbsp; &nbsp; &nbsp; [COLUMN_KEY_ONGOING]: setOngoingList,
&nbsp; &nbsp; &nbsp; [COLUMN_KEY_DONE]: setDoneList
&nbsp; &nbsp; }
&nbsp; &nbsp; if (dragSource) {
&nbsp; &nbsp; &nbsp; updaters[dragSource]((currentStat) =&gt;
&nbsp; &nbsp; &nbsp; &nbsp; currentStat.filter((item) =&gt; !Object.is(item, draggedItem))
&nbsp; &nbsp; &nbsp; );
&nbsp; &nbsp; }
&nbsp; &nbsp; if (dragTarget) {
&nbsp; &nbsp; &nbsp; updaters[dragTarget]((currentStat) =&gt; [draggedItem, ...currentStat]);
&nbsp; &nbsp; }
&nbsp; };

  return (
  &nbsp; &lt;div className="App"&gt;
      {/* çœç•¥ */}
  &nbsp; &nbsp; &lt;KanbanColumn
&nbsp; &nbsp; &nbsp; &nbsp; bgColor={COLUMN_BG_COLORS.ongoing}
&nbsp; &nbsp; &nbsp; &nbsp; title="è¿›è¡Œä¸­"
&nbsp; &nbsp; &nbsp; &nbsp; setIsDragSource={(isDragSource) =&gt; setDragSource(isDragSource ? COLUMN_KEY_ONGOING : null)}
&nbsp; &nbsp; &nbsp; &nbsp; setIsDragTarget={(isDragTarget) =&gt; setDragTarget(isDragTarget ? COLUMN_KEY_ONGOING : null)}
&nbsp; &nbsp; &nbsp; &nbsp; onDrop={handleDrop}
&nbsp; &nbsp; &nbsp; &gt;
      {/* çœç•¥ */}
    &lt;/div&gt;
  );
}
</code></pre><p>ç°åœ¨è®©æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­çœ‹çœ‹æ•ˆæœï¼ŒåŠ¨æ€å±•ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/5b/df/5b5940cd32811372206ce3e9789155df.gif?wh=1200x696" alt="å›¾ç‰‡"></p><p>æ­å–œä½ ï¼Œå¤§åŠŸå‘Šæˆï¼åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªçœ‹æ¿çš„åŠŸèƒ½æ€»ç®—æ˜¯å½¢æˆä¸€ä¸ªé—­ç¯äº†ã€‚è¿™ä¹ˆé‡è¦çš„é‡Œç¨‹ç¢‘ï¼Œè¯·ä½ åŠ¡å¿…æäº¤åˆ°ä½ çš„ä»£ç ä»“åº“é‡Œï¼ˆä¹Ÿæ¬¢è¿æŠŠä½ çš„ä»£ç é“¾æ¥åˆ†äº«åœ¨ç•™è¨€åŒºï¼‰ã€‚</p><p>ä¸è¿‡ï¼Œåˆšæ‰æˆ‘ä»¬æåˆ°äº†åˆæˆäº‹ä»¶çš„äº‹ä»¶å†’æ³¡ï¼Œä½ å¯èƒ½ä¼šé—®ï¼Œé‚£æœ‰<strong>äº‹ä»¶æ•è·ï¼ˆEvent Captureï¼‰</strong>çš„ä¾‹å­å—ï¼Ÿä½ å¯ä»¥æŠŠsrc/App.jsæ–‡ä»¶ä¸­çš„ <code>onDragStart</code> å…¨å±€æ›¿æ¢æˆ <code>onDragStartCapture</code> ï¼Œç„¶åçœ‹çœ‹æ•ˆæœã€‚</p><p>å…¶å®ä»äº¤äº’ä¸Šçœ‹ä¸å‡ºåŒºåˆ«ï¼Œåªæ˜¯ä¸¤ä¸ªç»„ä»¶å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°çš„æ‰§è¡Œé¡ºåºé¢ å€’äº†è¿‡æ¥ã€‚å…³äºäº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·çš„ä½¿ç”¨åœºæ™¯ï¼Œåç»­çš„è¯¾ç¨‹ä¸­è¿˜ä¼šæ¶‰åŠåˆ°ã€‚</p><h2>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŸç”ŸDOMäº‹ä»¶ï¼Ÿ</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒReactçš„åˆæˆäº‹ä»¶å·²ç»èƒ½æ»¡è¶³ä½ çš„å¤§éƒ¨åˆ†éœ€æ±‚äº†ï¼Œæœ‰ä¸¤ç§æƒ…å†µä¾‹å¤–ã€‚</p><ol>
<li>éœ€è¦ç›‘å¬Reactç»„ä»¶æ ‘ä¹‹å¤–çš„DOMèŠ‚ç‚¹çš„äº‹ä»¶ï¼Œè¿™ä¹ŸåŒ…æ‹¬äº†windowå’Œdocumentå¯¹è±¡çš„äº‹ä»¶ã€‚æ³¨æ„æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç»„ä»¶é‡Œç›‘å¬åŸç”ŸDOMäº‹ä»¶ï¼Œå±äºå…¸å‹çš„å‰¯ä½œç”¨ï¼Œæ‰€ä»¥è¯·åŠ¡å¿…åœ¨useEffectä¸­ç›‘å¬ï¼Œå¹¶åœ¨æ¸…é™¤å‡½æ•°ä¸­åŠæ—¶å–æ¶ˆç›‘å¬ã€‚å¦‚ï¼š</li>
</ol><pre><code class="language-javascript">useEffect(() =&gt; {
  window.addEventListener('resize', handleResize);
  return function cleanup() {
    window.removeEventListener('resize', handleResize);
  };
}, []);
</code></pre><ol start="2">
<li>å¾ˆå¤šç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œå°¤å…¶æ˜¯ä¸Reactå¼‚æ„çš„æ¡†æ¶ï¼Œåœ¨è¿è¡Œæ—¶ä¼šç”Ÿæˆé¢å¤–çš„DOMèŠ‚ç‚¹ã€‚åœ¨Reactåº”ç”¨ä¸­æ•´åˆè¿™ç±»æ¡†æ¶æ—¶ï¼Œå¸¸ä¼šæœ‰éReactçš„DOMä¾µå…¥Reactæ¸²æŸ“çš„DOMæ ‘ä¸­ã€‚å½“éœ€è¦ç›‘å¬è¿™ç±»æ¡†æ¶çš„äº‹ä»¶æ—¶ï¼Œè¦ç›‘å¬åŸç”ŸDOMäº‹ä»¶ï¼Œè€Œä¸æ˜¯Reactåˆæˆäº‹ä»¶ã€‚è¿™åŒæ ·ä¹Ÿæ˜¯useEffectæˆ–useLayoutEffectçš„é¢†åŸŸã€‚<br>
å½“ç„¶ï¼Œåªè¦ä½ çŸ¥é“åŸç†ï¼Œä¹Ÿå®Œå…¨å¯ä»¥ç”¨åŸç”ŸDOMäº‹ä»¶åŠ ä¸Šä¸€äº›ç‰¹æ®Šå¤„ç†æ¥æ›¿ä»£åˆæˆäº‹ä»¶ï¼Œä½†è¿™ç§åšæ³•å°±æ²¡é‚£ä¹ˆâ€œReactâ€äº†ã€‚</li>
</ol><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä»‹ç»äº†Reactåˆæˆäº‹ä»¶ï¼ŒçŸ¥é“äº†åˆæˆäº‹ä»¶æ˜¯åŸç”ŸDOMäº‹ä»¶çš„ä¸€ç§è§„èŒƒåŒ–çš„å°è£…ï¼Œä¹Ÿäº†è§£äº†å®ƒåœ¨æ³¨å†Œç›‘å¬æ–¹å¼ã€onChangeç­‰ç‰¹å®šäº‹ä»¶çš„è¡Œä¸ºã€å®é™…æ³¨å†Œçš„ç›®æ ‡DOMè¿™ä¸‰ä¸ªæ–¹é¢ä¸åŸç”ŸDOMäº‹ä»¶çš„åŒºåˆ«ã€‚</p><p>ç„¶ååœ¨oh-my-kanbanä»£ç åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥å­¦ä¹ äº†å—æ§ç»„ä»¶å’Œè¡¨å•å¤„ç†ï¼Œä¹Ÿä¸Šæ‰‹ä¸ºçœ‹æ¿åŠ å…¥äº†å¡ç‰‡æ‹–æ‹½çš„åŠŸèƒ½ï¼Œå¹¶é¡ºè·¯å®è·µäº†åˆæˆäº‹ä»¶çš„äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬è¿˜åˆ—ä¸¾äº†ä¸€äº›åˆæˆäº‹ä»¶åŠ›ä¸èƒ½åŠï¼Œå¿…é¡»ç›‘å¬åŸç”ŸDOMäº‹ä»¶çš„åœºæ™¯ã€‚æŒ‰ç…§è€è§„çŸ©ï¼Œè¿™é‡Œæˆ‘ä¹Ÿé™„ä¸Šæœ¬èŠ‚è¯¾æ‰€æ¶‰åŠçš„é¡¹ç›®æºä»£ç ï¼š<a href="https://gitee.com/evisong/geektime-column-oh-my-kanban/releases/tag/v0.11.0">https://gitee.com/evisong/geektime-column-oh-my-kanban/releases/tag/v0.11.0</a></p><p>ä¸‹èŠ‚è¯¾æˆ‘ä»¬å°†è¿æ¥ç»„ä»¶é€»è¾‘å¼€å‘çš„é‡å¤´æˆâ€”â€”å•å‘æ•°æ®æµï¼Œäº†è§£æ•°æ®å¦‚ä½•åœ¨Reactç»„ä»¶ä¸­æµè½¬ï¼Œå­¦ä¹ å¦‚ä½•è®¾è®¡å’Œæ“æ§Reactåº”ç”¨çš„æ•°æ®æµã€‚</p><h2>æ€è€ƒé¢˜</h2><ol>
<li>è¿™èŠ‚è¯¾æˆ‘ä»¬è®²åˆ°äº†åˆæˆäº‹ä»¶çš„äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·ï¼Œæˆ‘æƒ³è¯·ä½ è®¾è®¡ä¸€äº›å®éªŒï¼Œæ¥éªŒè¯äº‹ä»¶å¤„ç†å‡½æ•°åœ¨çˆ¶å­ç»„ä»¶é—´çš„æ‰§è¡Œé¡ºåºã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿæåˆ°äº†åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å¯ä»¥é€šè¿‡è°ƒç”¨ <code>event.stopPropogation()</code> æ¥é˜»æ­¢äº‹ä»¶è¿›ä¸€æ­¥å†’æ³¡æˆ–æ•è·ï¼Œè¯·ä½ æ€è€ƒä¸€ä¸‹ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šç”¨åˆ°ã€‚</li>
<li>æˆ‘ä»¬æ—¶ä¸æ—¶ä¹Ÿå›æ¥å…³æ³¨ä¸€ä¸‹æ€§èƒ½ï¼Œæˆ‘æƒ³è¯·ä½ åœ¨React Developer Toolsä¸­æ‰“å¼€â€œç»„ä»¶æ¸²æŸ“æ—¶é«˜äº®å˜åŒ–â€ã€‚ç„¶åè§‚å¯Ÿä¸€ä¸‹åœ¨æ‹–æ‹½æ“ä½œæœŸé—´ï¼Œéƒ½æœ‰å“ªäº›ç»„ä»¶åšäº†æ— è°“çš„æ¸²æŸ“ã€‚<br>
<img src="https://static001.geekbang.org/resource/image/f5/33/f53edef52dd7171db3c0766f9fyyf533.png?wh=1312x812" alt="å›¾ç‰‡"></li>
</ol><p>æ¬¢è¿æŠŠä½ çš„æ€è€ƒå’Œæƒ³æ³•åˆ†äº«åœ¨è¯„è®ºåŒºï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ğŸ‘</span>
  </div>
  <div class="_2_QraFYR_0">ä½ å¥½ï¼Œæˆ‘æ˜¯ã€Šç°ä»£React Webå¼€å‘å®æˆ˜ã€‹çš„ç¼–è¾‘è¾°æ´‹ï¼Œè¿™æ˜¯ğŸ‘‡é¡¹ç›®çš„æºä»£ç é“¾æ¥ï¼Œä¾›ä½ å­¦ä¹ ä¸å‚è€ƒï¼šhttps:&#47;&#47;gitee.com&#47;evisong&#47;geektime-column-oh-my-kanban&#47;releases&#47;tag&#47;v0.11.0</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-09-19 19:41:22</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/2c/a5/f4/9bf287ea.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>WL</span>
  </div>
  <div class="_2_QraFYR_0">æ„Ÿè§‰è€å¸ˆè®²å¾—è¿‡äºå¤šå†…å®¹äº†ï¼Œçœ‹ç€æŒºèŠ±æ—¶é—´ï¼›å¯ä»¥ç®€åŒ–äº›å°±æ›´å¥½äº†</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼ŒWLï¼Œæ„Ÿè°¢ä½ çš„åé¦ˆã€‚ç›®å‰è¿™ä¸ªä¸“æ çš„æ•´ä½“ï¼Œè¿˜æœ‰æ¯èŠ‚è¯¾çš„å±€éƒ¨ï¼ŒåŸºæœ¬éƒ½æ˜¯æŒ‰ç…§è¡¨å±‚-åº•å±‚-è¡¨å±‚-åº•å±‚é€»è¾‘è®¾è®¡çš„ï¼Œæ¯èŠ‚è¯¾è®¾è®¡çš„å†…å®¹å¯†åº¦ä¸è¿™å¥—é€»è¾‘ç›¸å…³ã€‚æˆ‘å’Œä¸“æ ç¼–è¾‘ä¹Ÿå•†é‡è¿‡ï¼Œåœ¨ä¸æ”¹å˜è¯¾ç¨‹æ€»ä½“è®¾è®¡çš„å‰æä¸‹ï¼Œæˆ‘ä»¬ä¼šå°½é‡å¹³è¡¡å„ä½åŒå­¦çš„å­¦ä¹ éœ€æ±‚ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-09-15 21:00:06</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/e7/20/70a95f94.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ½®æ±</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œè¿™èŠ‚è¯¾çš„æ‹–æ‹½çš„ä¾‹å­ï¼Œä½ çš„æ‹–æ‹½å¼€å§‹çš„æ—¶å€™ï¼Œå¡ç‰‡ä¼šä¸ä¼šæœ‰ä¸€é—ªè€Œè¿‡çš„å¡ç‰‡æ—¶é—´ä»statusçš„æ—¶é—´å˜æˆç›¸å¯¹æ—¶é—´çš„ç”»é¢ã€‚åˆ†æäº†ä¸‹ï¼Œæ„Ÿè§‰åƒæ˜¯KanbanCardçš„setDraggedItemè§¦å‘äº†Appçš„æ›´æ–°æ¸²æŸ“ï¼ŒKanbanColumnå’ŒKanbanCardä¹Ÿä¼šè¢«é‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯draggedItemä¹Ÿå¹¶æ²¡æœ‰ä¼ ç»™KanbanCardï¼Œä¸ºå•¥ä¼šè§¦å‘KanbanCardçš„åè°ƒæ›´æ–°å‘¢ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼Œæ½®æ±ï¼Œæˆ‘ç”¨ https:&#47;&#47;gitee.com&#47;evisong&#47;geektime-column-oh-my-kanban&#47;releases&#47;tag&#47;v0.11.0 çš„ä»£ç åœ¨æœ¬åœ°è·‘äº†ä¸€ä¸‹ï¼Œæ²¡è§‚å¯Ÿåˆ°ä½ è¯´çš„æƒ…å†µï¼Œè¯·é—®ä½ ä½¿ç”¨çš„ git commit id å’Œæµè§ˆå™¨ç‰ˆæœ¬æ˜¯æ€æ ·çš„ï¼Ÿ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2023-01-08 14:03:47</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/c9/f9/39492855.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>é˜¿é˜³</span>
  </div>
  <div class="_2_QraFYR_0">æ¯èŠ‚è¯¾çš„å†…å®¹å¥½å¤šï¼Œå…¨æ˜¯å¹²è´§ã€‚éœ€è¦åå¤çš„å¬ï¼Œçœ‹ï¼ŒåŠ¨æ‰‹å®è·µã€‚è¯·é—®è€å¸ˆï¼Œæ¯èŠ‚è¯¾çš„è¯¾åä¹ é¢˜æœ‰æ²¡æœ‰ä¸“é—¨çš„ç« èŠ‚åšè§£ç­”å•Šï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼Œé˜¿é˜³ï¼Œæ„Ÿè°¢ä½ çš„è®¤å¯ï¼Œè¡·å¿ƒå¸Œæœ›ä½ ä»æœ¬ä¸“æ ä¸­æœ‰æ‰€æ”¶è·ã€‚<br><br>ä¸“æ æ¯èŠ‚è¯¾è¯¾åéƒ½æœ‰1ï½2ä¸ªæ€è€ƒé¢˜ï¼Œåˆè¡·æ˜¯ä¸ºäº†é¼“åŠ±åŒå­¦ä»¬æ€è€ƒã€è®¨è®ºï¼Œæå‡å­¦ä¹ æ•ˆæœã€‚å¯ä»¥çœ‹åˆ°åœ¨æ¯èŠ‚è¯¾çš„ç•™è¨€åŒºï¼Œå·²ç»æœ‰äº†ä¸å°‘ä¼˜ç§€çš„ç­”æ¡ˆï¼Œä¸€äº›ç­”æ¡ˆä¸‹é¢æœ‰æˆ‘çš„è¯„è®ºï¼Œä¹Ÿæœ‰éƒ¨åˆ†ç­”æ¡ˆå¼•èµ·äº†åŒå­¦ä»¬çš„çƒ­çƒˆè®¨è®ºã€‚<br><br>åœ¨è¿è½½æœŸé—´ï¼Œæ ¹æ®åŒå­¦ä»¬çš„ç•™è¨€ï¼Œæˆ‘ä»¬ä¹Ÿé€‰äº†3ä¸ªä¸»é¢˜åˆ¶ä½œä¸Šçº¿äº†ä¸¤èŠ‚åŠ é¤ï¼šã€ŠåŠ é¤01ï½œç•™è¨€åŒºå¿ƒæ„¿å•ï¼šçœŸÂ·å­ç»„ä»¶ä»¥åŠjsx-runtimeã€‹å’Œã€ŠåŠ é¤02ï½œç•™è¨€åŒºå¿ƒæ„¿å•ï¼šFiberåè°ƒå¼•æ“ã€‹ã€‚ç›®å‰è™½ç„¶è¿è½½å·²ç»å‘Šä¸€æ®µè½ï¼Œè¿˜æ˜¯éå¸¸æ¬¢è¿åŒå­¦ä»¬ç•™è¨€å‚ä¸äº’åŠ¨ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæ ¹æ®åŒå­¦ä»¬çš„éœ€æ±‚ï¼Œè€ƒè™‘æ˜¯å¦é¢å¤–åŠ é¤ã€‚<br><br>åœ¨æ­¤ä¹Ÿæ„Ÿè°¢æ‰€æœ‰å‚ä¸äº’åŠ¨çš„åŒå­¦ä»¬ï¼Œè°¢è°¢ä½ ä»¬ï¼</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-11-29 14:59:11</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/5c/31/d7b92b6b.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ç™¡ç™¡çš„ç­‰ä½ æ­¸</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œè¯¾ç¨‹æºç ä¸è§äº†ï¼Œ404äº†</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼Œç™¡ç™¡çš„ç­‰ä½ æ­¸ï¼Œä½ è¯´çš„æºç é“¾æ¥æ˜¯ä¸‹é¢è¿™ä¸ªå—ï¼Ÿ<br><br>    https:&#47;&#47;gitee.com&#47;evisong&#47;geektime-column-oh-my-kanban&#47;releases&#47;tag&#47;v0.11.0<br><br>æˆ‘ç”¨ç”µä¿¡å®½å¸¦å’Œè”é€š5Géƒ½è¯•äº†è¯•ï¼Œç›®å‰éƒ½èƒ½æ­£å¸¸è®¿é—®ï¼ˆè™½ç„¶åè€…æœ‰ç‚¹æ…¢ï¼‰ã€‚è¯·å†è¯•è¯•ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œè¯·å‘Šè¯‰æˆ‘ä»¬ä½ çš„ç”µä¿¡æä¾›å•†å’Œè¿æ¥æ–¹å¼ï¼Œæˆ‘ä¼šè¯·Giteeæ’æŸ¥ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-11-16 16:06:33</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/15/b9/d8/92c2b3ab.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æµ·åå‘€</span>
  </div>
  <div class="_2_QraFYR_0">1ã€æ‰§è¡Œé¡ºåº æ˜¯çˆ¶-å­-çˆ¶ï¼Œæœ‰äº›æ´‹è‘±åœˆæ¨¡å‹çš„æ„Ÿè§‰ <br>&lt;div onClickCapture={() =&gt; console.log(1)} onClick={() =&gt;console.log(4)} &gt;<br>      &lt;p onClickCapture={() =&gt; console.log(2)} onClick={() =&gt; { console.log(3) }}&gt;<br>        target<br>      &lt;&#47;p&gt;<br>    &lt;&#47;div &gt; <br>ä¾‹å¦‚è¿™ä¸ªç‚¹å‡»ä¼šä¾æ¬¡æ‰“å°å‡º1ã€2ã€3ã€4ï¼›<br>é˜»æ­¢å†’æ³¡ ä¸€èˆ¬æ˜¯çˆ¶å­ç»„ä»¶éƒ½å¯¹äº‹ä»¶åšäº†å¤„ç†ï¼Œä¾‹å¦‚ æ–‡ç« åˆ—è¡¨é¡µ ï¼Œç‚¹èµæŒ‰é’®ï¼Œå’Œæ‰“å¼€è¯¦æƒ…é¡µé¢ï¼›<br></div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼Œæµ·åå‘€ï¼Œå¾ˆç®€æ´æœ‰æ•ˆçš„å®éªŒï¼Œèµï¼</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-10-18 23:11:48</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Geek_8e9c8d</span>
  </div>
  <div class="_2_QraFYR_0">å·²ç»å¼€å§‹æœŸå¾…ä»¥åå¼€çš„é¡¹ç›®è¯¾äº†<br>å¸Œæœ›èƒ½å¾—åˆ°çœä»½å’ŒåŸå¸‚çš„é‚£ä¸ªæ€è€ƒé¢˜çš„æ›´å¤šæç¤º~,è°¢è°¢</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼ŒGeek_8e9c8dï¼ŒæŠ±æ­‰ç”±äºä¹‹å‰ä¸€ç›´åœ¨èµ¶ç¨¿ï¼Œè¿™ä¹ˆä¹…æ‰å›å¤ã€‚ç¬¬24èŠ‚è¯¾çš„ç‰¹åˆ«ä¼åˆ’å¼€æºé¡¹ç›®åœ¨ï¼š<br><br>    https:&#47;&#47;gitee.com&#47;evisong&#47;geektime-column-oh-my-kit<br><br>å¾ˆå¿«å°±ä¼šæ­£å¼è¿è½¬èµ·æ¥ï¼Œéå¸¸æœŸå¾…ä½ çš„åŠ å…¥ã€‚<br><br>å…³äºç¬¬10èŠ‚è¯¾çœä»½+åŸå¸‚çš„æ€è€ƒé¢˜ï¼ŒåŸºæœ¬çŸ¥è¯†ç‚¹å°±æ˜¯é‚£ä¸ªä¾èµ–å€¼æ•°ç»„ã€‚æ–‡ç¨¿ä¸­çš„ä»£ç ï¼š<br><br>    &#47;&#47;   ------------   --------------<br>    &#47;&#47;   | çœä»½... |v|   | åŸå¸‚...  |v|<br>    &#47;&#47;   ------------   --------------<br><br>    const [province, setProvince] = useState(null);<br>    const [cities, setCities] = useState([]);<br>    useEffect(() =&gt; {<br>      if (province === &#39;å±±ä¸œ&#39;) {<br>        &#47;&#47; è¿™äº›æ•°æ®å¯ä»¥æ˜¯æœ¬åœ°æ•°æ®ï¼Œä¹Ÿå¯ä»¥ç°ä»æœåŠ¡å™¨ç«¯è¯»å–<br>        setCities([&#39;æµå—&#39;, &#39;é’å²›&#39;, &#39;æ·„åš&#39;]);<br>      }<br>    }, [province]);<br><br>æ„æ€å°±æ˜¯å½“ provinceå€¼æœ‰å˜åŒ–æ‰ä¼šå†æ¬¡æ‰§è¡Œå‰é¢çš„å‰¯ä½œç”¨å›è°ƒå‡½æ•°ï¼Œæ¥æ›´æ–°åŸå¸‚åˆ—è¡¨stateã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-10-10 20:09:55</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/19/64/6f2b7b86.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>01</span>
  </div>
  <div class="_2_QraFYR_0">å¯¹ç›®å‰å‘å±•æ¥è®²ï¼Œ åˆæˆäº‹ä»¶æ˜¯å¦æ˜¯ä¸ªå¥½çš„é€‰æ‹©ã€‚ åŒæ—¶æ˜¯å¦å¢åŠ äº†å¼€å‘çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚ è®¸å¤šç±»reactç›¸å…³åº“ä¸é‡‡ç”¨åˆæˆäº‹ä»¶ä»£æ›¿åŸç”Ÿäº‹ä»¶ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼Œ01ï¼Œè¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚æˆ‘ä¹ŸèµåŒåˆæˆäº‹ä»¶å¢åŠ äº†å¼€å‘è€…çš„è®¤çŸ¥è´Ÿæ‹…ã€‚ä¸è¿‡æˆ‘ä¹Ÿä¼šä»ä¸‹é¢å‡ ä¸ªæ–¹é¢æ€è€ƒåˆæˆäº‹ä»¶å¯¹äºReactçš„å¿…è¦æ€§ï¼š<br><br>1. Reactå¯¹äº‹ä»¶ç³»ç»Ÿçš„é™åˆ¶ã€‚å¯¹äºDOM eventï¼Œåªè¦å¼€å‘è€…æ„¿æ„ï¼Œå¯ä»¥åšåˆ°å¾ˆå¤šæ›¿ä»£Reactæ•°æ®æµçš„äº‹æƒ…ï¼Œè€Œåˆæˆäº‹ä»¶ï¼Œåˆ™åªä¿ç•™äº†ä¸»è¦æ˜¯ä¸ç”¨æˆ·äº¤äº’ç›¸å…³çš„éƒ¨åˆ†èƒ½åŠ›ï¼Œä¿è¯å®ƒä¸ä¼šè·ŸReactå…¶ä»–ç‰¹æ€§æŠ¢æ´»å„¿ã€‚<br><br>2. åˆæˆäº‹ä»¶å¯¹äºç‰¹å®šäº‹ä»¶çš„æ‰€è°“è§„èŒƒåŒ–ï¼Œå°¤å…¶æ˜¯onChangeï¼Œç®—æ˜¯å—æ§ç»„ä»¶çš„åŸºæœ¬å®ç°åŸç†ï¼Œå¦‚æœæ”¾æ‰‹ç»™åŸç”ŸDOMäº‹ä»¶ï¼Œå—æ§ç»„ä»¶æ–¹æ¡ˆå¯èƒ½éœ€è¦è°ƒæ•´ã€‚<br><br>3. åŸç”ŸDOM eventçš„äº‹ä»¶å¤„ç†æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œå¯èƒ½ä¼šé˜»å¡é¡µé¢ï¼Œæˆ‘æœ¬æƒ³å¯¹æ¯”ä¸€ä¸‹åˆæˆäº‹ä»¶å¤„ç†æ˜¯ä¸æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä½†æˆ‘æŸ¥è¿‡Reactæºç packages&#47;react-dom&#47;src&#47;events&#47;å’Œä¸€äº›èµ„æ–™ï¼Œè¿˜æ²¡æœ‰å‘ç°æœ‰åœ°æ–¹è¯´æ˜è¿™ä¸€ç‚¹ã€‚<br><br>4. åœ¨React 17ï¼Œåˆæˆäº‹ä»¶å¤„ç†å‡½æ•°ä¸­ä¿®æ”¹å¤šæ¬¡stateï¼Œä¼šè‡ªåŠ¨æ‰¹å¤„ç†ï¼Œåªè§¦å‘ä¸€æ¬¡æ¸²æŸ“ï¼ŒåŸç”ŸDOMäº‹ä»¶å¤„ç†å‡½æ•°ä¸­å¦‚æœä¹Ÿä¿®æ”¹å¤šä¸ªstateï¼Œæ˜¯ä¸äº«å—è¿™ä¸ªå¾…é‡çš„ï¼›ä¸è¿‡è¿™ä¸ªä¼˜åŠ¿åœ¨React 18å·²ç»ä¸å­˜åœ¨äº†ï¼Œåªè¦æ˜¯äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ï¼Œéƒ½å¯ä»¥è‡ªåŠ¨æ‰¹å¤„ç†ï¼Œåªæ¸²æŸ“ä¸€æ¬¡ï¼š<br><br>elm.addEventListener(&#39;click&#39;, () =&gt; {<br>  setCount(c =&gt; c + 1);<br>  setFlag(f =&gt; !f);<br>  &#47;&#47; React will only re-render once at the end (that&#39;s batching!)<br>});<br><br>å…·ä½“å¯ä»¥å‚è€ƒ https:&#47;&#47;github.com&#47;reactwg&#47;react-18&#47;discussions&#47;21<br><br>å¦‚æœ‰è¡¥å……æˆ–å…¶ä»–è§‚ç‚¹ï¼Œæ¬¢è¿ç»§ç»­å›å¤è®¨è®ºã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-09-27 22:45:46</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/17/a8/1e/4ec85e24.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>joel</span>
  </div>
  <div class="_2_QraFYR_0">è¿˜æ²¡æœ‰æ›´å—</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-09-16 14:06:38</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/17/a8/1e/4ec85e24.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>joel</span>
  </div>
  <div class="_2_QraFYR_0">ç»ˆäºè¿½ä¸Šæ¥äº†</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å¥½ï¼Œjoelï¼Œæˆ‘çœ‹äº†ä¸‹ä½ ç•™è¨€çš„æ—¥æœŸï¼Œå­¦ä¹ é€Ÿåº¦å¿«å¾—è®©äººç¾¡æ…• :) å¾ˆé«˜å…´ä¸“æ èƒ½å¼•èµ·ä½ çš„å­¦ä¹ å…´è¶£ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-09-15 11:44:13</div>
  </div>
</div>
</div>
</li>
</ul>