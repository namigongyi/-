<audio title="20_å…³äºè·¨ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œä½ åªéœ€è¦è®°ä½è¿™ä¸‰æ‹›" src="https://static001.geekbang.org/resource/audio/1e/fc/1e5f7703bd5ef647cb041a7f8e2398fc.mp3" controls="controls"></audio> 
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆèˆªã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å¸¦ä½ ä¸€èµ·å­¦ä¹ äº†åœ¨Flutterä¸­å¦‚ä½•å“åº”ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆæ‰‹åŠ¿ï¼‰ã€‚æ‰‹åŠ¿å¤„ç†åœ¨Flutterä¸­åˆ†ä¸ºä¸¤ç§ï¼šåŸå§‹çš„æŒ‡é’ˆäº‹ä»¶å¤„ç†å’Œé«˜çº§çš„æ‰‹åŠ¿è¯†åˆ«ã€‚</p><p>å…¶ä¸­ï¼ŒæŒ‡é’ˆäº‹ä»¶ä»¥å†’æ³¡æœºåˆ¶åˆ†å‘ï¼Œé€šè¿‡Listenerå®Œæˆç›‘å¬ï¼›è€Œæ‰‹åŠ¿è¯†åˆ«åˆ™é€šè¿‡Gestureå¤„ç†ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶Flutterå¯ä»¥åŒæ—¶æ”¯æŒå¤šä¸ªæ‰‹åŠ¿ï¼ˆåŒ…æ‹¬ä¸€ä¸ªWidgetç›‘å¬å¤šä¸ªæ‰‹åŠ¿ï¼Œæˆ–æ˜¯å¤šä¸ªWidgetç›‘å¬åŒä¸€ä¸ªæ‰‹åŠ¿ï¼‰ï¼Œä½†æœ€ç»ˆåªä¼šæœ‰ä¸€ä¸ªWidgetçš„æ‰‹åŠ¿èƒ½å¤Ÿå“åº”ç”¨æˆ·è¡Œä¸ºã€‚ä¸ºäº†æ”¹å˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ‰‹åŠ¿ï¼Œä¿®æ”¹æ‰‹åŠ¿ç«æŠ€åœºå¯¹äºå¤šæ‰‹åŠ¿ä¼˜å…ˆçº§åˆ¤æ–­çš„é»˜è®¤è¡Œä¸ºã€‚</p><p>é™¤äº†éœ€è¦å“åº”å¤–éƒ¨çš„äº‹ä»¶ä¹‹å¤–ï¼ŒUIæ¡†æ¶çš„å¦ä¸€ä¸ªé‡è¦ä»»åŠ¡æ˜¯ï¼Œå¤„ç†å¥½å„ä¸ªç»„ä»¶ä¹‹é—´çš„æ•°æ®åŒæ­¥å…³ç³»ã€‚å°¤å…¶å¯¹äºFlutterè¿™æ ·å¤§é‡ä¾é ç»„åˆWidgetçš„è¡Œä¸ºæ¥å®ç°ç”¨æˆ·ç•Œé¢çš„æ¡†æ¶æ¥è¯´ï¼Œå¦‚ä½•ç¡®ä¿æ•°æ®çš„æ”¹å˜èƒ½å¤Ÿæ˜ å°„åˆ°æœ€ç»ˆçš„è§†è§‰æ•ˆæœä¸Šå°±æ˜¾å¾—æ›´ä¸ºé‡è¦ã€‚æ‰€ä»¥ï¼Œåœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°±ä¸ä½ ä»‹ç»åœ¨Flutterä¸­å¦‚ä½•è¿›è¡Œè·¨ç»„ä»¶æ•°æ®ä¼ é€’ã€‚</p><p>åœ¨ä¹‹å‰çš„åˆ†äº«ä¸­ï¼Œé€šè¿‡ç»„åˆåµŒå¥—çš„æ–¹å¼ï¼Œåˆ©ç”¨æ•°æ®å¯¹åŸºç¡€Widgetçš„æ ·å¼è¿›è¡Œè§†è§‰å±æ€§å®šåˆ¶ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†å¤šç§ç•Œé¢å¸ƒå±€ã€‚æ‰€ä»¥ï¼Œä½ åº”è¯¥å·²ç»ä½“ä¼šåˆ°äº†ï¼Œåœ¨Flutterä¸­å®ç°è·¨ç»„ä»¶æ•°æ®ä¼ é€’çš„æ ‡å‡†æ–¹å¼æ˜¯é€šè¿‡å±æ€§ä¼ å€¼ã€‚</p><!-- [[[read_end]]] --><p>ä½†æ˜¯ï¼Œå¯¹äºç¨å¾®å¤æ‚ä¸€ç‚¹çš„ã€å°¤å…¶è§†å›¾å±‚çº§æ¯”è¾ƒæ·±çš„UIæ ·å¼ï¼Œä¸€ä¸ªå±æ€§å¯èƒ½éœ€è¦è·¨è¶Šå¾ˆå¤šå±‚æ‰èƒ½ä¼ é€’ç»™å­ç»„ä»¶ï¼Œè¿™ç§ä¼ é€’æ–¹å¼å°±ä¼šå¯¼è‡´ä¸­é—´å¾ˆå¤šå¹¶ä¸éœ€è¦è¿™ä¸ªå±æ€§çš„ç»„ä»¶ä¹Ÿéœ€è¦æ¥æ”¶å…¶å­Widgetçš„æ•°æ®ï¼Œä¸ä»…ç¹çè€Œä¸”å†—ä½™ã€‚</p><p>æ‰€ä»¥ï¼Œå¯¹äºæ•°æ®çš„è·¨å±‚ä¼ é€’ï¼ŒFlutterè¿˜æä¾›äº†ä¸‰ç§æ–¹æ¡ˆï¼šInheritedWidgetã€Notificationå’ŒEventBusã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†ä¾æ¬¡ä¸ºä½ è®²è§£è¿™ä¸‰ç§æ–¹æ¡ˆã€‚</p><h2>InheritedWidget</h2><p>InheritedWidgetæ˜¯Flutterä¸­çš„ä¸€ä¸ªåŠŸèƒ½å‹Widgetï¼Œé€‚ç”¨äºåœ¨Widgetæ ‘ä¸­å…±äº«æ•°æ®çš„åœºæ™¯ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é«˜æ•ˆåœ°å°†æ•°æ®åœ¨Widgetæ ‘ä¸­è¿›è¡Œè·¨å±‚ä¼ é€’ã€‚</p><p>åœ¨å‰é¢çš„ç¬¬16ç¯‡æ–‡ç« â€œ<a href="https://time.geekbang.org/column/article/112148">ä»å¤œé—´æ¨¡å¼è¯´èµ·ï¼Œå¦‚ä½•å®šåˆ¶ä¸åŒé£æ ¼çš„Appä¸»é¢˜ï¼Ÿ</a>â€ä¸­ï¼Œæˆ‘ä¸ä½ ä»‹ç»äº†å¦‚ä½•é€šè¿‡Themeå»è®¿é—®å½“å‰ç•Œé¢çš„æ ·å¼é£æ ¼ï¼Œä»è€Œè¿›è¡Œæ ·å¼å¤ç”¨çš„ä¾‹å­ï¼Œæ¯”å¦‚Theme.of(context).primaryColorã€‚</p><p><strong>Themeç±»æ˜¯é€šè¿‡InheritedWidgetå®ç°çš„å…¸å‹æ¡ˆä¾‹</strong>ã€‚åœ¨å­Widgetä¸­é€šè¿‡Theme.ofæ–¹æ³•æ‰¾åˆ°ä¸Šå±‚Themeçš„Widgetï¼Œè·å–åˆ°å…¶å±æ€§çš„åŒæ—¶ï¼Œå»ºç«‹å­Widgetå’Œä¸Šå±‚çˆ¶Widgetçš„è§‚å¯Ÿè€…å…³ç³»ï¼Œå½“ä¸Šå±‚çˆ¶Widgetå±æ€§ä¿®æ”¹çš„æ—¶å€™ï¼Œå­Widgetä¹Ÿä¼šè§¦å‘æ›´æ–°ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä»¥Flutterå·¥ç¨‹æ¨¡æ¿ä¸­çš„è®¡æ•°å™¨ä¸ºä¾‹ï¼Œä¸ä½ è¯´æ˜InheritedWidgetçš„ä½¿ç”¨æ–¹æ³•ã€‚</p><ul>
<li>é¦–å…ˆï¼Œä¸ºäº†ä½¿ç”¨InheritedWidgetï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿è‡ªå®ƒçš„æ–°ç±»CountContainerã€‚</li>
<li>ç„¶åï¼Œæˆ‘ä»¬å°†è®¡æ•°å™¨çŠ¶æ€countå±æ€§æ”¾åˆ°CountContainerä¸­ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªofæ–¹æ³•æ–¹ä¾¿å…¶å­Widgetåœ¨Widgetæ ‘ä¸­æ‰¾åˆ°å®ƒã€‚</li>
<li>æœ€åï¼Œæˆ‘ä»¬é‡å†™äº†updateShouldNotifyæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨Flutteråˆ¤æ–­InheritedWidgetæ˜¯å¦éœ€è¦é‡å»ºï¼Œä»è€Œé€šçŸ¥ä¸‹å±‚è§‚å¯Ÿè€…ç»„ä»¶æ›´æ–°æ•°æ®æ—¶è¢«è°ƒç”¨åˆ°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç›´æ¥åˆ¤æ–­countæ˜¯å¦ç›¸ç­‰å³å¯ã€‚</li>
</ul><pre><code>class CountContainer extends InheritedWidget {
  //æ–¹ä¾¿å…¶å­Widgetåœ¨Widgetæ ‘ä¸­æ‰¾åˆ°å®ƒ
  static CountContainer of(BuildContext context) =&gt; context.inheritFromWidgetOfExactType(CountContainer) as CountContainer;
  
  final int count;

  CountContainer({
    Key key,
    @required this.count,
    @required Widget child,
  }): super(key: key, child: child);

  // åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°
  @override
  bool updateShouldNotify(CountContainer oldWidget) =&gt; count != oldWidget.count;
}
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨CountContainerä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¹¶ç”¨0åˆå§‹åŒ–countã€‚éšååœ¨å…¶å­Widget Counterä¸­ï¼Œæˆ‘ä»¬é€šè¿‡InheritedCountContainer.ofæ–¹æ³•æ‰¾åˆ°å®ƒï¼Œè·å–è®¡æ•°çŠ¶æ€countå¹¶å±•ç¤ºï¼š</p><pre><code>class _MyHomePageState extends State&lt;MyHomePage&gt; {
  @override
  Widget build(BuildContext context) {
   //å°†CountContainerä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¹¶ä½¿ç”¨0ä½œä¸ºåˆå§‹åŒ–count
    return CountContainer(
      count: 0,
      child: Counter()
    );
  }
}

class Counter extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    //è·å–InheritedWidgetèŠ‚ç‚¹
    CountContainer state = CountContainer.of(context);
    return Scaffold(
      appBar: AppBar(title: Text(&quot;InheritedWidget demo&quot;)),
      body: Text(
        'You have pushed the button this many times: ${state.count}',
      ),
    );
}
</code></pre><p>è¿è¡Œä¸€ä¸‹ï¼Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/da/2e/da4662202739ac00969b111d1c30f12e.png?wh=640*1136" alt=""></p><center><span class="reference">å›¾1 InheritedWidgetä½¿ç”¨æ–¹æ³•</span></center><p>å¯ä»¥çœ‹åˆ°InheritedWidgetçš„ä½¿ç”¨æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ— è®ºCounteråœ¨CountContainerä¸‹å±‚ä»€ä¹ˆä½ç½®ï¼Œéƒ½èƒ½è·å–åˆ°å…¶çˆ¶Widgetçš„è®¡æ•°å±æ€§countï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ä¼ é€’å±æ€§äº†ã€‚</p><p><strong>ä¸è¿‡ï¼ŒInheritedWidgetä»…æä¾›äº†æ•°æ®è¯»çš„èƒ½åŠ›ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä¿®æ”¹å®ƒçš„æ•°æ®ï¼Œåˆ™éœ€è¦æŠŠå®ƒå’ŒStatefulWidgetä¸­çš„Stateé…å¥—ä½¿ç”¨</strong>ã€‚æˆ‘ä»¬éœ€è¦æŠŠInheritedWidgetä¸­çš„æ•°æ®å’Œç›¸å…³çš„æ•°æ®ä¿®æ”¹æ–¹æ³•ï¼Œå…¨éƒ¨ç§»åˆ°StatefulWidgetä¸­çš„Stateä¸Šï¼Œè€ŒInheritedWidgetåªéœ€è¦ä¿ç•™å¯¹å®ƒä»¬çš„å¼•ç”¨ã€‚</p><p>æˆ‘ä»¬å¯¹ä¸Šé¢çš„ä»£ç ç¨åŠ ä¿®æ”¹ï¼Œåˆ æ‰CountContainerä¸­æŒæœ‰çš„countå±æ€§ï¼Œå¢åŠ å¯¹æ•°æ®æŒæœ‰è€…Stateï¼Œä»¥åŠæ•°æ®ä¿®æ”¹æ–¹æ³•çš„å¼•ç”¨ï¼š</p><pre><code>class CountContainer extends InheritedWidget {
  ...
  final _MyHomePageState model;//ç›´æ¥ä½¿ç”¨MyHomePageä¸­çš„Stateè·å–æ•°æ®
  final Function() increment;

  CountContainer({
    Key key,
    @required this.model,
    @required this.increment,
    @required Widget child,
  }): super(key: key, child: child);
  ...
}
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å°†countæ•°æ®å’Œå…¶å¯¹åº”çš„ä¿®æ”¹æ–¹æ³•æ”¾åœ¨äº†Stateä¸­ï¼Œä»ç„¶ä½¿ç”¨CountContainerä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œå®Œæˆäº†æ•°æ®å’Œä¿®æ”¹æ–¹æ³•çš„åˆå§‹åŒ–ã€‚</p><p>åœ¨å…¶å­Widget Counterä¸­ï¼Œæˆ‘ä»¬è¿˜æ˜¯é€šè¿‡InheritedCountContainer.ofæ–¹æ³•æ‰¾åˆ°å®ƒï¼Œå°†è®¡æ•°çŠ¶æ€countä¸UIå±•ç¤ºåŒæ­¥ï¼Œå°†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ä¸æ•°æ®ä¿®æ”¹åŒæ­¥ï¼š</p><pre><code>class _MyHomePageState extends State&lt;MyHomePage&gt; {
  int count = 0;
  void _incrementCounter() =&gt; setState(() {count++;});//ä¿®æ”¹è®¡æ•°å™¨

  @override
  Widget build(BuildContext context) {
    return CountContainer(
      model: this,//å°†è‡ªèº«ä½œä¸ºmodeläº¤ç»™CountContainer
      increment: _incrementCounter,//æä¾›ä¿®æ”¹æ•°æ®çš„æ–¹æ³•
      child:Counter()
    );
  }
}

class Counter extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    //è·å–InheritedWidgetèŠ‚ç‚¹
    CountContainer state = CountContainer.of(context);
    return Scaffold(
      ...
      body: Text(
        'You have pushed the button this many times: ${state.model.count}', //å…³è”æ•°æ®è¯»æ–¹æ³•
      ),
      floatingActionButton: FloatingActionButton(onPressed: state.increment), //å…³è”æ•°æ®ä¿®æ”¹æ–¹æ³•
    );
  }
}
</code></pre><p>è¿è¡Œä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å·²ç»å®ç°InheritedWidgetæ•°æ®çš„è¯»å†™äº†ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/d1/35/d18d85bdd7d8ccf095535db077f3cd35.gif?wh=636*1140" alt=""></p><center><span class="reference">å›¾2 InheritedWidgetæ•°æ®ä¿®æ”¹ç¤ºä¾‹</span></center><h2>Notification</h2><p>Notificationæ˜¯Flutterä¸­è¿›è¡Œè·¨å±‚æ•°æ®å…±äº«çš„å¦ä¸€ä¸ªé‡è¦çš„æœºåˆ¶ã€‚å¦‚æœè¯´InheritedWidgetçš„æ•°æ®æµåŠ¨æ–¹å¼æ˜¯ä»çˆ¶Widgetåˆ°å­Widgeté€å±‚ä¼ é€’ï¼Œé‚£Notificaitonåˆ™æ°æ°ç›¸åï¼Œæ•°æ®æµåŠ¨æ–¹å¼æ˜¯ä»å­Widgetå‘ä¸Šä¼ é€’è‡³çˆ¶Widgetã€‚è¿™æ ·çš„æ•°æ®ä¼ é€’æœºåˆ¶é€‚ç”¨äºå­WidgetçŠ¶æ€å˜æ›´ï¼Œå‘é€é€šçŸ¥ä¸ŠæŠ¥çš„åœºæ™¯ã€‚</p><p>åœ¨å‰é¢çš„ç¬¬13ç¯‡æ–‡ç« â€œ<a href="https://time.geekbang.org/column/article/110859">ç»å…¸æ§ä»¶ï¼ˆäºŒï¼‰ï¼šUITableView/ListViewåœ¨Flutterä¸­æ˜¯ä»€ä¹ˆï¼Ÿ</a>â€ä¸­ï¼Œæˆ‘ä¸ä½ ä»‹ç»äº†ScrollNotificationçš„ä½¿ç”¨æ–¹æ³•ï¼šListViewåœ¨æ»šåŠ¨æ—¶ä¼šåˆ†å‘é€šçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šå±‚ä½¿ç”¨NotificationListenerç›‘å¬ScrollNotificationï¼Œæ ¹æ®å…¶çŠ¶æ€åšå‡ºç›¸åº”çš„å¤„ç†ã€‚</p><p>è‡ªå®šä¹‰é€šçŸ¥çš„ç›‘å¬ä¸ScrollNotificationå¹¶æ— ä¸åŒï¼Œè€Œå¦‚æœæƒ³è¦å®ç°è‡ªå®šä¹‰é€šçŸ¥ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç»§æ‰¿Notificationç±»ã€‚Notificationç±»æä¾›äº†dispatchæ–¹æ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ²¿ç€contextå¯¹åº”çš„ElementèŠ‚ç‚¹æ ‘å‘ä¸Šé€å±‚å‘é€é€šçŸ¥ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹å§ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªé€šçŸ¥å’Œå­Widgetã€‚å­Widgetæ˜¯ä¸€ä¸ªæŒ‰é’®ï¼Œåœ¨ç‚¹å‡»æ—¶ä¼šå‘é€é€šçŸ¥ï¼š</p><pre><code>class CustomNotification extends Notification {
  CustomNotification(this.msg);
  final String msg;
}

//æŠ½ç¦»å‡ºä¸€ä¸ªå­Widgetç”¨æ¥å‘é€šçŸ¥
class CustomChild extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return RaisedButton(
      //æŒ‰é’®ç‚¹å‡»æ—¶åˆ†å‘é€šçŸ¥
      onPressed: () =&gt; CustomNotification(&quot;Hi&quot;).dispatch(context),
      child: Text(&quot;Fire Notification&quot;),
    );
  }
}
</code></pre><p>è€Œåœ¨å­Widgetçš„çˆ¶Widgetä¸­ï¼Œæˆ‘ä»¬ç›‘å¬äº†è¿™ä¸ªé€šçŸ¥ï¼Œä¸€æ—¦æ”¶åˆ°é€šçŸ¥ï¼Œå°±ä¼šè§¦å‘ç•Œé¢åˆ·æ–°ï¼Œå±•ç¤ºæ”¶åˆ°çš„é€šçŸ¥ä¿¡æ¯ï¼š</p><pre><code>class _MyHomePageState extends State&lt;MyHomePage&gt; {
  String _msg = &quot;é€šçŸ¥ï¼š&quot;;
  @override
  Widget build(BuildContext context) {
    //ç›‘å¬é€šçŸ¥
    return NotificationListener&lt;CustomNotification&gt;(
        onNotification: (notification) {
          setState(() {_msg += notification.msg+&quot;  &quot;;});//æ”¶åˆ°å­Widgeté€šçŸ¥ï¼Œæ›´æ–°msg
        },
        child:Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: &lt;Widget&gt;[Text(_msg),CustomChild()],//å°†å­WidgetåŠ å…¥åˆ°è§†å›¾æ ‘ä¸­
        )
    );
  }
}
</code></pre><p>è¿è¡Œä¸€ä¸‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ¯æ¬¡ç‚¹å‡»æŒ‰é’®ä¹‹åï¼Œç•Œé¢ä¸Šéƒ½ä¼šå‡ºç°æœ€æ–°çš„é€šçŸ¥ä¿¡æ¯ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/e8/dd/e8c504730c0580dc699a0807039c76dd.gif?wh=636*1132" alt=""></p><center><span class="reference">å›¾3 è‡ªå®šä¹‰Notification</span></center><h2>EventBus</h2><p>æ— è®ºæ˜¯InheritedWidgetè¿˜æ˜¯Notificaitonï¼Œå®ƒä»¬çš„ä½¿ç”¨åœºæ™¯éƒ½éœ€è¦ä¾é Widgetæ ‘ï¼Œä¹Ÿå°±æ„å‘³ç€åªèƒ½åœ¨æœ‰çˆ¶å­å…³ç³»çš„Widgetä¹‹é—´è¿›è¡Œæ•°æ®å…±äº«ã€‚ä½†æ˜¯ï¼Œç»„ä»¶é—´æ•°æ®ä¼ é€’è¿˜æœ‰ä¸€ç§å¸¸è§åœºæ™¯ï¼šè¿™äº›ç»„ä»¶é—´ä¸å­˜åœ¨çˆ¶å­å…³ç³»ã€‚è¿™æ—¶ï¼Œäº‹ä»¶æ€»çº¿EventBuså°±ç™»åœºäº†ã€‚</p><p>äº‹ä»¶æ€»çº¿æ˜¯åœ¨Flutterä¸­å®ç°è·¨ç»„ä»¶é€šä¿¡çš„æœºåˆ¶ã€‚å®ƒéµå¾ªå‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œå…è®¸è®¢é˜…è€…è®¢é˜…äº‹ä»¶ï¼Œå½“å‘å¸ƒè€…è§¦å‘äº‹ä»¶æ—¶ï¼Œè®¢é˜…è€…å’Œå‘å¸ƒè€…ä¹‹é—´å¯ä»¥é€šè¿‡äº‹ä»¶è¿›è¡Œäº¤äº’ã€‚å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´æ— éœ€æœ‰çˆ¶å­å…³ç³»ï¼Œç”šè‡³éWidgetå¯¹è±¡ä¹Ÿå¯ä»¥å‘å¸ƒ/è®¢é˜…ã€‚è¿™äº›ç‰¹ç‚¹ä¸å…¶ä»–å¹³å°çš„äº‹ä»¶æ€»çº¿æœºåˆ¶æ˜¯ç±»ä¼¼çš„ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªè·¨é¡µé¢é€šä¿¡çš„ä¾‹å­ï¼Œæ¥çœ‹ä¸€ä¸‹äº‹ä»¶æ€»çº¿çš„å…·ä½“ä½¿ç”¨æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒEventBusæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨pubspec.yamlæ–‡ä»¶ä¸­å£°æ˜å®ƒï¼š</p><pre><code>dependencies:  
  event_bus: 1.1.0
</code></pre><p>EventBusçš„ä½¿ç”¨æ–¹å¼çµæ´»ï¼Œå¯ä»¥æ”¯æŒä»»æ„å¯¹è±¡çš„ä¼ é€’ã€‚æ‰€ä»¥åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¼ è¾“æ•°æ®çš„è½½ä½“å°±é€‰æ‹©äº†ä¸€ä¸ªæœ‰å­—ç¬¦ä¸²å±æ€§çš„è‡ªå®šä¹‰äº‹ä»¶ç±»CustomEventï¼š</p><pre><code>class CustomEvent {
  String msg;
  CustomEvent(this.msg);
}
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå…¨å±€çš„eventBuså¯¹è±¡ï¼Œå¹¶åœ¨ç¬¬ä¸€ä¸ªé¡µé¢ç›‘å¬äº†CustomEventäº‹ä»¶ï¼Œä¸€æ—¦æ”¶åˆ°äº‹ä»¶ï¼Œå°±ä¼šåˆ·æ–°UIã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåƒä¸‡åˆ«å¿˜äº†åœ¨Stateè¢«é”€æ¯æ—¶æ¸…ç†æ‰äº‹ä»¶æ³¨å†Œï¼Œå¦åˆ™ä½ ä¼šå‘ç°Stateæ°¸è¿œè¢«EventBusæŒæœ‰ç€ï¼Œæ— æ³•é‡Šæ”¾ï¼Œä»è€Œé€ æˆå†…å­˜æ³„æ¼ï¼š</p><pre><code>//å»ºç«‹å…¬å…±çš„event bus
EventBus eventBus = new EventBus();
//ç¬¬ä¸€ä¸ªé¡µé¢
class _FirstScreenState extends  State&lt;FirstScreen&gt;  {

  String msg = &quot;é€šçŸ¥ï¼š&quot;;
  StreamSubscription subscription;
  @override
  initState() {
   //ç›‘å¬CustomEventäº‹ä»¶ï¼Œåˆ·æ–°UI
    subscription = eventBus.on&lt;CustomEvent&gt;().listen((event) {
      setState(() {msg+= event.msg;});//æ›´æ–°msg
    });
    super.initState();
  }
  dispose() {
    subscription.cancel();//Stateé”€æ¯æ—¶ï¼Œæ¸…ç†æ³¨å†Œ
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return new Scaffold(
      body:Text(msg),
      ...
    );
  }
}
</code></pre><p>æœ€åï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªé¡µé¢ä»¥æŒ‰é’®ç‚¹å‡»å›è°ƒçš„æ–¹å¼ï¼Œè§¦å‘äº†CustomEventäº‹ä»¶ï¼š</p><pre><code>class SecondScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return new Scaffold(
      ...
      body: RaisedButton(
          child: Text('Fire Event'),
          // è§¦å‘CustomEventäº‹ä»¶
          onPressed: ()=&gt; eventBus.fire(CustomEvent(&quot;hello&quot;))
      ),
    );
  }
}
</code></pre><p>è¿è¡Œä¸€ä¸‹ï¼Œå¤šç‚¹å‡»å‡ ä¸‹ç¬¬äºŒä¸ªé¡µé¢çš„æŒ‰é’®ï¼Œç„¶åè¿”å›æŸ¥çœ‹ç¬¬ä¸€ä¸ªé¡µé¢ä¸Šçš„æ¶ˆæ¯ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/5a/d5/5a50441b322568f4f3d77aea87d2aed5.gif?wh=640*1132" alt=""></p><center><span class="reference">å›¾4 EventBusç¤ºä¾‹</span></center><p>å¯ä»¥çœ‹åˆ°ï¼ŒEventBusçš„ä½¿ç”¨æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä½¿ç”¨é™åˆ¶ä¹Ÿç›¸å¯¹æœ€å°‘ã€‚</p><p>è¿™é‡Œæˆ‘å‡†å¤‡äº†ä¸€å¼ è¡¨æ ¼ï¼ŒæŠŠå±æ€§ä¼ å€¼ã€InheritedWidgetã€Notificationä¸EventBusè¿™å››ç§æ•°æ®å…±äº«æ–¹å¼çš„ç‰¹ç‚¹å’Œä½¿ç”¨åœºæ™¯åšäº†ç®€å•æ€»ç»“ï¼Œä¾›ä½ å‚è€ƒï¼š</p><p><img src="https://static001.geekbang.org/resource/image/b2/66/b2a78dbefdf30895504b2017355ae066.png?wh=570*237" alt=""></p><center><span class="reference">å›¾5 å±æ€§ä¼ å€¼ã€InheritedWidgetã€Notificationä¸EventBusæ•°æ®ä¼ é€’æ–¹å¼å¯¹æ¯”</span></center><h2>æ€»ç»“</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œã€‚æˆ‘ä»¬æ¥ç®€å•å›é¡¾ä¸‹åœ¨Flutterä¸­ï¼Œå¦‚ä½•å®ç°è·¨ç»„ä»¶çš„æ•°æ®å…±äº«ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è®¤è¯†äº†InheritedWidgetã€‚å¯¹äºè§†å›¾å±‚çº§æ¯”è¾ƒæ·±çš„UIæ ·å¼ï¼Œç›´æ¥é€šè¿‡å±æ€§ä¼ å€¼çš„æ–¹å¼ä¼šå¯¼è‡´å¾ˆå¤šä¸­é—´å±‚å¢åŠ å†—ä½™å±æ€§ï¼Œè€Œä½¿ç”¨InheritedWidgetå¯ä»¥å®ç°å­Widgetè·¨å±‚å…±äº«çˆ¶Widgetçš„å±æ€§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒInheritedWidgetä¸­çš„å±æ€§åœ¨å­Widgetä¸­åªèƒ½è¯»ï¼Œå¦‚æœæœ‰ä¿®æ”¹çš„åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒå’ŒStatefulWidgetä¸­çš„Stateé…å¥—ä½¿ç”¨ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å­¦ä¹ äº†Notificationï¼Œè¿™ç§ç”±ä¸‹åˆ°ä¸Šä¼ é€’æ•°æ®çš„è·¨å±‚å…±äº«æœºåˆ¶ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨NotificationListenerï¼Œåœ¨çˆ¶Widgetç›‘å¬æ¥è‡ªå­Widgetçš„äº‹ä»¶ã€‚</p><p>æœ€åï¼Œæˆ‘ä¸ä½ ä»‹ç»äº†EventBusï¼Œè¿™ç§æ— éœ€å‘å¸ƒè€…ä¸è®¢é˜…è€…ä¹‹é—´å­˜åœ¨çˆ¶å­å…³ç³»çš„æ•°æ®åŒæ­¥æœºåˆ¶ã€‚</p><p>æˆ‘æŠŠä»Šå¤©åˆ†äº«æ‰€æ¶‰åŠåˆ°çš„ä¸‰ç§è·¨ç»„ä»¶çš„<a href="https://github.com/cyndibaby905/20_data_transfer">æ•°æ®å…±äº«æ–¹å¼demo</a>æ”¾åˆ°äº†GitHubï¼Œä½ å¯ä»¥ä¸‹è½½ä¸‹æ¥è‡ªå·±è¿è¡Œï¼Œä½“ä¼šå®ƒä»¬ä¹‹é—´çš„å…±åŒç‚¹å’Œå·®å¼‚ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œæˆ‘æ¥ç»™ä½ ç•™ä¸‹ä¸€ä¸ªæ€è€ƒé¢˜å§ã€‚</p><p>è¯·ä½ åˆ†åˆ«æ¦‚æ‹¬å±æ€§ä¼ å€¼ã€InheritedWidgetã€Notificationä¸EventBusçš„ä¼˜ç¼ºç‚¹ã€‚</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ç­‰å¾…ä½ ï¼æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p></p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/13/55/e4/7061abd5.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Mr.J</span>
  </div>
  <div class="_2_QraFYR_0">è¯·ä½ åˆ†åˆ«æ¦‚æ‹¬å±æ€§ä¼ å€¼ã€InheritedWidgetã€Notification ä¸ EventBus çš„ä¼˜ç¼ºç‚¹ã€‚<br>Â·å±æ€§ä¼ å€¼ï¼šå•é¡µé¢åŒä¸€ä¸ªè§†å›¾æ ‘ä¸­ä½¿ç”¨ï¼Œæˆ–è€…é€šè¿‡æ„é€ æ–¹æ³•å°†å€¼ä¼ é€’è¿‡å»ï¼Œæœ‰ç‚¹ç›´æ¥å°†å€¼å¸¦è¿‡å»ï¼Œä¸éœ€è¦è¿‡å¤šçš„æ“ä½œï¼Œç¼ºç‚¹æ˜¯å¤šå±‚çº§çš„Widgetéœ€è¦ä¸€å±‚å±‚çš„ä¼ å€¼ï¼Œæ•ˆç‡å¾ˆä½ï¼›ä¸­é—´ä¸€å±‚å¿˜äº†ä¼ æ•´ä¸ªä¸‹æ¸¸éƒ½ä¸­æ–­ï¼Œè€Œä¸”ä¸­é—´æŸä¸€ä¸ªå±‚çº§ä¿®æ”¹äº†æ•°æ®ï¼Œä¸Šå±‚æ— æ³•åŠæ—¶æ›´æ–°ï¼›<br>Â·InheritedWidgetï¼šä¸»è¦ä½“ç°æ˜¯ä¸‹å±‚Widgetä¸»åŠ¨å»å‘ä¸Šå±‚æ‹¿æ•°æ®ï¼Œå®ç°ç›¸å¯¹å¤æ‚ï¼Œï¼ˆæœ‰ä¸ªç–‘é—®ï¼Œå¤šå±‚çš„è§†å›¾æ ‘ï¼Œåœ¨æœ€ä¸‹å±‚ç›´æ¥ä½¿ç”¨ofå¯ä»¥è·å–åˆ°æœ€ä¸Šå±‚çš„æ•°æ®å—ï¼Ÿï¼‰ï¼Œç¼ºç‚¹ä¼ å€¼æ–¹å‘çš„å•ä¸€ï¼›<br>Â·Notificationï¼šä¸InheritedWidgetç›¸åï¼Œä¸»è¦ä½“ç°æ¨æ•°æ®ï¼Œé’ˆå¯¹æ€§å¼ºï¼Œå…·ä½“é€šçŸ¥ç»™å“ªä¸ªWidgetæ˜ç¡®ï¼Œä¸éœ€è¦è·¨å¤šå±‚å®ç°ï¼Œç¼ºç‚¹å®ç°èµ·æ¥ç›¸å¯¹ç¹çç‚¹ï¼Œä¼ å€¼æ–¹å‘å•ä¸€ï¼›<br>Â·EventBusï¼šè®¢é˜…å…³ç³»ï¼Œé’ˆå¯¹æ€§å¼ºï¼Œå…¨å±€ä½¿ç”¨ï¼Œç¼ºç‚¹æ˜¯ä¸åŒçš„äº‹ä»¶éœ€è¦å®šä¹‰ä¸åŒçš„å®ä½“ï¼Œä¼ é€’æ—¶è¦åŒºåˆ†å“ªä¸ªäº‹ä»¶ä¼ é€’ç»™å“ªä¸ªæ§ä»¶ï¼Œé”€æ¯Widgetæ—¶ä¸èƒ½å¿˜è®°å–æ¶ˆè®¢é˜…ï¼›<br></div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ<br>InheritedWidget æ— è®ºè·¨å¤šå°‘å±‚éƒ½å¯ä»¥çš„</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-14 00:18:45</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è®¸ç«¥ç«¥</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆèƒ½è®²ä¸‹é—²é±¼çš„Reduxå—ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æ›´æ¨èProvider</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-13 11:59:30</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è®¸ç«¥ç«¥</span>
  </div>
  <div class="_2_QraFYR_0">è¯·ä½ åˆ†åˆ«æ¦‚æ‹¬å±æ€§ä¼ å€¼ã€InheritedWidgetã€Notification ä¸ EventBus çš„ä¼˜ç¼ºç‚¹ã€‚<br>å±æ€§ä¼ å€¼ï¼šç®€å•ï¼Œä½†è·¨å¤šä¸ªçˆ¶å­èŠ‚ç‚¹ä¸æ–¹ä¾¿<br>InheritedWidgetï¼šè·¨å¤šä¸ªçˆ¶å­èŠ‚ç‚¹æ–¹ä¾¿ï¼Œä½†ä¿®æ”¹æ•°æ®éº»çƒ¦<br>Notification ï¼šä¼ é€’äº‹ä»¶æ–¹ä¾¿ï¼Œè¯»å–ä¸æ–¹ä¾¿<br>EventBus ï¼šé€šè¿‡äº‹ä»¶æ€»çº¿ï¼Œå…¨å±€ï¼Œæ–¹ä¾¿ï¼Œä½†è¦è®°ä½äº‹ä»¶åç§°ï¼Œå…¨å±€å®¹æ˜“å†²çªï¼Œç»„ä»¶æ¶ˆé™¤è¦æ¸…ç†äº‹ä»¶ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-13 12:02:13</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/13/25/b0/2736225b.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å¯‚å¯ä¸ç‚¹çƒŸ</span>
  </div>
  <div class="_2_QraFYR_0">subscription = eventBus.on().listen((event) { setState(() {msg+= event.msg;});&#47;&#47;æ›´æ–°msg });eventè¿™æ ·æ¥æ”¶ä¼šå‡ºç°äº‹ä»¶æ··ä¹±ã€‚åº”è¯¥åŠ ä¸€å±‚åˆ¤æ–­<br>if(event.runtimeType == CustomEvent){<br>        setState(() {<br>          msg += event.msg;<br>        }); &#47;&#47;æ›´æ–°msg<br>      }</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-12-17 15:56:32</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/25/c8/7a950a91.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ·¡ï½</span>
  </div>
  <div class="_2_QraFYR_0">Blocå’Œscopedmodelç­‰ä¸€äº›çŠ¶æ€ç®¡ç†æ–¹æ¡ˆä¼šè®²å—ï¼Œæ›´å¯Œæ¨èé‚£äº›åšçŠ¶æ€ç®¡ç†å•Š</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æ¨èProvider</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-14 08:57:15</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/56/4b/3d4c0424.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ç¦æ¯æ»¡æº¢</span>
  </div>
  <div class="_2_QraFYR_0">ä¸ºä»€ä¹ˆæŠŠå±æ€§å’Œä¿®æ”¹å±æ€§çš„æ–¹æ³•æ”¾åœ¨InheritedWidgeté‡Œä¸å¯ä»¥å‘¢ï¼Ÿå­ç»„ä»¶è·å–çˆ¶ç»„ä»¶ï¼ŒåŒæ ·å¯ä»¥è°ƒç”¨çˆ¶ç»„ä»¶é‡Œçš„æ–¹æ³•ä¿®æ”¹å±æ€§å‘€ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-06-23 21:04:17</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/10/2c/330651c8.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>J</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘å¸¦ç€ MVVM å’Œ MVC çš„æƒ³æ³•å­¦ä¹ æœ¬èŠ‚å†…å®¹ï¼Œæ‚¨å°†åˆ°çš„ InheritedWidget è¿™ä¸ªè·¨å±‚åŠŸèƒ½ widget çš„ demo ï¼Œçœ‹åˆ°äº†ä¸€äº› æ•°æ®é©±åŠ¨ é¡µé¢çš„å½±å­ï¼Œä½†æ˜¯æ•´ä½“çš„æ•°æ®æµè½¬å’Œé¡µé¢å±•ç¤ºä¼¼ä¹ä¸å¤§æ¸…æ™°ï¼Œå¯ä»¥æŒ‡ç‚¹ä¸€ä¸‹ flutter çš„ MVC æˆ–è€… MVVM çš„ä»£ç ç»„ç»‡æ˜¯æ€æ ·çš„å—ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-08-13 16:13:03</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Geek_061196</span>
  </div>
  <div class="_2_QraFYR_0"> éšç€é¡¹ç›®çš„è¿­ä»£ï¼Œ Eventbus ä¼šè¶Šæ¥è¶Šä¸æ–¹ä¾¿ç»´æŠ¤ã€‚æœ‰æ²¡æœ‰ç±»ä¼¼é˜¿é‡Œçš„Arouterç»„ä»¶ï¼Œæ›¿ä»£Eventbuså®ç°ç»„ä»¶é—´é€šä¿¡å‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-08-10 18:07:58</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/44/59/b607b8c0.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ¯›æˆæ–¹</span>
  </div>
  <div class="_2_QraFYR_0">åœ¨å®é™…é¡¹ç›®ä¸­é‡åˆ°é—®é¢˜çš„æ—¶å€™ ç¿»é˜…è¿™é‡Œçš„æ–‡ç«  çœŸçš„å¾ˆæœ‰å¸®åŠ© ç»å¯¹æ˜¯å¹²è´§</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-02-01 09:49:33</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/1f/2a/c7/3fb66518.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Chvjs</span>
  </div>
  <div class="_2_QraFYR_0">ç°åœ¨ StreamSubscription æ˜¯ undefined äº†ï¼ŒAPI æ›´æ–°äº†å—ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-08-11 19:54:38</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqLkpGLibHdMIcdiazlpF6JOL5ZUz13yuxWBFeZrlsbaiaDxJictNslF9ic87lLtZic3DsHEXxfmTIHNwYA/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Geek_6b80e0</span>
  </div>
  <div class="_2_QraFYR_0">å±æ€§ä¼ å€¼ï¼Œæ˜¯åªèƒ½é€šè¿‡å±‚å±‚ä¼ é€’ï¼Œå®¹æ˜“ä¸¢å¤±å’Œä¸å¥½ä½¿ç”¨ã€‚<br>InheritedWidget å¯ä»¥è§£å†³è·¨å±‚ä¼ é€’ï¼Œçµæ´»æ€§æ¯”è¾ƒå¤§ï¼Œéœ€è¦æ ¹æ®ä¸åŒçš„éœ€æ±‚å®ç°ofé€»è¾‘ã€‚åªèƒ½ä»çˆ¶çº§å¾€å­çº§è¿›è¡Œä¼ é€’ã€‚<br>Notification å…¶å®ä¹Ÿæ˜¯é€šè¿‡è®¢é˜…æ¨¡å¼ï¼Œè¿›è¡Œä¼ é€’ï¼Œéœ€è¦å­çº§è§¦å‘ï¼Œçˆ¶çº§è®¢é˜…ã€‚<br>EventBus å…¨å±€å…±äº«ï¼Œæ²¡æœ‰çˆ¶å­é™åˆ¶ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-04-22 10:56:11</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/84/55/e5733ac5.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>JimLai</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®flutterå¯ä»¥è¾¾åˆ°ç±»ä¼¼å®‰å“ContentProviderå®ç°çš„è·¨è¿›ç¨‹æ•°æ®é€šè®¯çš„æ•ˆæœå—ï¼Ÿä¾‹å¦‚ï¼šä¸€ä¸ªç”±flutterå¼€å‘çš„appéƒ¨ç½²åˆ°å®‰å“è®¾å¤‡ä¸Šï¼Œä¸å¦ä¸€ä¸ªåŸç”Ÿå®‰å“appè¿›è¡Œæ•°æ®é€šè®¯ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-12-30 11:37:40</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/1e/e0/238fda97.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ğŸŒ</span>
  </div>
  <div class="_2_QraFYR_0">æˆ‘é€šè¿‡å­widgetç±»ç›´æ¥ä¿®æ”¹ä¼ å…¥çš„çˆ¶widgetä¸­çš„å˜é‡å¯ä»¥å—ï¼Ÿå®éªŒè¿‡ï¼Œå¦‚æœæ˜¯å¯¹è±¡çš„å˜é‡å¯ä»¥ç›´æ¥ä¿®æ”¹æ‰ã€‚<br><br>class Obj {<br>  int a;<br>  String b;<br><br>  Obj({this.a, this.b});<br>}<br>class OneWidget extends StatefulWidget {<br>  OneWidget({Key key}) : super(key: key);<br>  @override<br>  _OneWidgetState createState() =&gt; _OneWidgetState();<br>}<br>class _OneWidgetState extends State&lt;OneWidget&gt; {<br>  Obj obj;<br>  @override<br>  Widget build(BuildContext context) {<br>    return TwoWidget(obj: obj);<br>  }<br>}<br><br>class TwoWidget extends StatefulWidget {<br>  final Obj obj;<br>  TwoWidget({Key key, this.obj}) : super(key: key);<br>  @override<br>  _TwoWidgetState createState() =&gt; _TwoWidgetState();<br>}<br>class _TwoWidgetState extends State&lt;TwoWidget&gt; {<br>  @override<br>  Widget build(BuildContext context) {<br>    return FlatButton(<br>      onPressed: () {<br>        widget.obj.a = 123;<br>      },<br>      child: Text(&#39;ç‚¹å‡»&#39;),<br>    );<br>  }<br>}</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¯ä»¥å•Šï¼Œå¯¹è±¡æ˜¯å¼•ç”¨ä¼ é€’å°±æ²¡é—®é¢˜<br></p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-11-13 18:52:45</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/04/37/aa04f997.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å’Œå°èƒ–</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œdispose() { subscription.cancel();} è¿™é‡Œçš„ subscription å“ªé‡Œæ¥çš„å‘¢ï¼Ÿä¸æ˜¯åº”è¯¥æ˜¯ eventbus.destroy() å—?</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æ³¨å†Œé€šçŸ¥ï¼ˆè°ƒç”¨listenï¼‰çš„æ—¶å€™ä¼šè¿”å›ä¸€ä¸ªç›‘å¬å¯¹è±¡ï¼Œç”¨äºåç»­å–æ¶ˆäº‹ä»¶é€šçŸ¥</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-10 20:30:36</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/04/37/aa04f997.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å’Œå°èƒ–</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œä¸Šé¢æçš„é—®é¢˜ä¼¼ä¹æ‰¾åˆ°ç­”æ¡ˆäº†ã€‚<br><br>æŠŠ _incrementCounter ä¼ å…¥åˆ° CountContainer é‡Œé¢æˆ–è®¸æ˜¯ä¸ºäº†ç±»ä¼¼äº java é‡Œé¢çš„å¤šæ€ï¼Œå­ç±»å¯ä»¥æœ‰å¾ˆå¤šï¼ŒåŒæ—¶å­ç±»å¯ä»¥è‡ªå®šä¹‰å¾ˆå¤šè‡ªå·±çš„æ–¹æ³•ï¼Œä½†æ˜¯åœ¨è°ƒç”¨çš„æ—¶å€™éƒ½ç»Ÿä¸€è°ƒç”¨çˆ¶ç±»çš„åŒåæ–¹æ³•ã€‚<br><br>è€Œæˆ‘ç”¨ state.increment ä¹‹æ‰€ä»¥ä¸è¡Œï¼Œæ˜¯å› ä¸ºæˆ‘æ˜¯ onPressed: () =&gt; state.increment è¿™æ ·å†™çš„ï¼Œå¦‚æœæ”¹æˆ onPressed: () =&gt; state.increment() å…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæˆ–è€…æŒ‰ç…§è€å¸ˆé‚£ç§ onPressed çš„å†™æ³•ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br><br>onPressed: () =&gt; state.increment() æ˜¯å¦å¯ä»¥è®¤ä¸ºæ˜¯åœ¨ onPressed çš„å›è°ƒå“åº”é‡Œé¢è°ƒç”¨äº† state çš„ increment()  æ–¹æ³•è€Œå·²ï¼Œè€Œ onPressed: state.increment æ˜¯ä¸æ˜¯å¯ä»¥çœ‹æˆæ˜¯åœ¨æ‹¿ state çš„ increment å±æ€§åœ¨ç»™ onPressed è¿™ä¸ªå±æ€§èµ‹å€¼å‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµï¼Œä½ å·²ç»å¾—å‡ºæ­£ç¡®ç»“è®ºäº†</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-10 17:28:16</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/04/37/aa04f997.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å’Œå°èƒ–</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œè¯·é—®ä¸‹ç¬¬ä¸€ç§çˆ¶ä¼ å­çš„æ–¹å¼ï¼Œä¸ºå•¥è¦æŠŠ _incrementCounter ä¼ å…¥åˆ°CountContaineré‡Œé¢å‘¢ï¼Ÿåœ¨æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶é‡Œé¢ç›´æ¥ä½¿ç”¨ state.model._incrementCounter() ä¸æ˜¯ä¹Ÿå¯ä»¥å—ï¼Ÿ<br><br>å¦å¤–æˆ‘å‘ç°æˆ‘ç”¨state.model._incrementCounter()æ˜¯å¯ä»¥ï¼Œä½†æ˜¯ä½¿ç”¨ state.increment å´æ— æ³•è®© æ•°å­—å˜åŒ–ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: 1.ç›´æ¥ä½¿ç”¨Stateå½“ç„¶å¯ä»¥å‘€ï¼Œåªæ˜¯è¿™ä¸ªä¾‹å­æ˜¯æ¼”ç¤ºå¦‚ä½•é€šè¿‡InheritedWidgetè¿›è¡Œè¯»å†™æ•°æ®ã€‚InheritedWidgetåªèƒ½è¯»ä¸èƒ½å†™ï¼Œè¦å†™æ•°æ®å¾—é€šè¿‡Stateä¸­è½¬ä¸€å±‚<br>2.çœ‹è¯„è®ºä½ å·²ç»å¾—å‡ºç»“è®ºå•¦</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-10 16:50:28</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ODicJCxia34EqbeBCwQeyWxcc0F25RP9fnI1r3o1Nt7S3ibRCvQI6zUlUKORL0kZic0PmCGX912bCZ5ERXPE785ZTw/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å’–å•¡å‡‰äº†</span>
  </div>
  <div class="_2_QraFYR_0"> <br>class Counter extends StatelessWidget {<br>  @override<br>  Widget build(BuildContext context) {<br>    &#47;&#47; è·å– InheritedWidget èŠ‚ç‚¹<br>    CountContainer state = CountContainer.of(context);<br>    return Scaffold(<br>      â€¦<br>      body: Text(<br>        &#39;You have pushed the button this many times: ${state.model.count}&#39;, &#47;&#47; å…³è”æ•°æ®è¯»æ–¹æ³•<br>      ),<br>      floatingActionButton: FloatingActionButton(onPressed: state.increment), &#47;&#47; å…³è”æ•°æ®ä¿®æ”¹æ–¹æ³•<br>    );<br>  }<br>}<br>æˆ‘åœ¨å°è¯•çš„æ—¶å€™é‡åˆ°äº†é—®é¢˜ï¼Œè¿™æ®µä»£ç ä¸­çš„ state.increment ï¼Œæ²¡æœ‰ååº”ï¼Œæ”¹æˆstate.increment()æ‰èƒ½å“åº”ã€‚è¿™æ˜¯ä»€ä¹ˆé—®é¢˜</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: è¿™æ®µä»£ç åº”è¯¥æ˜¯æ²¡é—®é¢˜çš„ï¼Œå¦‚æœæ˜¯ç”¨ç®­å¤´å‡½æ•°æ‰ä¼šæœ‰é—®é¢˜</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-09 17:31:01</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/45/e9/3f121576.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å†å²è¯¾ä»£è¡¨</span>
  </div>
  <div class="_2_QraFYR_0">å¯ä»¥è®²ä¸€ä¸‹EventBusåœ¨Flutterä¸­æ€ä¹ˆå®ç°çš„å—</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: EventBusåŸç†æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡ä¸€ä¸ªå¯ä»¥è¢«å¤šäººå…±äº«ï¼ˆè®¢é˜…ï¼‰çš„æ•°æ®æµå°±å¯ä»¥å®ç°äº‹ä»¶çš„åˆ†å‘ã€‚Dartçš„event_buså®é™…ä¸Šå°±æ˜¯é€šè¿‡ä¸€ä¸ªå¯ä»¥è¢«å¤šä¸ªäººè®¢é˜…çš„Streamå®ç°çš„ï¼Œè€Œå…¶åº•å±‚çš„StreamControllerå°±æ˜¯ä¸“é—¨ç”¨æ¥ç»™Steamåˆ¶é€ æ•°æ®çš„ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-04 20:39:13</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/44/cd/04f3a16c.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>çœ‹ä¸æ‡‚çš„ä½ </span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆå…·ä½“è®²ä¸€ä¸‹providerçš„å®ç°ä¸æ€æƒ³ï¼Œè¿˜æœ‰blocçš„sixiabg</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: Providerä¼šè®²çš„</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-29 10:07:41</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/b6/18/ede273fe.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ptlCoder</span>
  </div>
  <div class="_2_QraFYR_0">ç³»ç»Ÿæ²¡æœ‰æä¾›ç¼“å­˜ç›¸å…³APIå˜›ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æœ‰å•Šã€‚ä½†æ˜¯å¯¹äºè·¨ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå­˜å–æ–¹å¼å¹¶ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å­˜å¥½äº†æ€ä¹ˆé€šçŸ¥å…¶ä»–ç»„ä»¶æ¥å–</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-27 22:17:47</div>
  </div>
</div>
</div>
</li>
</ul>