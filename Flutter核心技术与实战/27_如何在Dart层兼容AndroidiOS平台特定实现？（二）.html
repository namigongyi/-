<audio title="27_å¦‚ä½•åœ¨Dartå±‚å…¼å®¹AndroidiOSå¹³å°ç‰¹å®šå®ç°ï¼Ÿï¼ˆäºŒï¼‰" src="https://static001.geekbang.org/resource/audio/6b/63/6bafa784e653f95a94058ade8fdcea63.mp3" controls="controls"></audio> 
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆèˆªã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ä½ ä»‹ç»äº†æ–¹æ³•é€šé“ï¼Œè¿™ç§åœ¨Flutterä¸­å®ç°è°ƒç”¨åŸç”ŸAndroidã€iOSä»£ç çš„è½»é‡çº§è§£å†³æ–¹æ¡ˆã€‚ä½¿ç”¨æ–¹æ³•é€šé“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸç”Ÿä»£ç æ‰€æ‹¥æœ‰çš„èƒ½åŠ›ï¼Œä»¥æ¥å£å½¢å¼æä¾›ç»™Dartã€‚</p><p>è¿™æ ·ï¼Œå½“å‘èµ·æ–¹æ³•è°ƒç”¨æ—¶ï¼ŒFlutteråº”ç”¨ä¼šä»¥ç±»ä¼¼ç½‘ç»œå¼‚æ­¥è°ƒç”¨çš„æ–¹å¼ï¼Œå°†è¯·æ±‚æ•°æ®é€šè¿‡ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦æŒ‡å®šçš„æ–¹æ³•é€šé“ä¼ è¾“è‡³åŸç”Ÿä»£ç å®¿ä¸»ï¼›è€ŒåŸç”Ÿä»£ç å¤„ç†å®Œæ¯•åï¼Œä¼šå°†å“åº”ç»“æœé€šè¿‡æ–¹æ³•é€šé“å›ä¼ è‡³Flutterï¼Œä»è€Œå®ç°Dartä»£ç ä¸åŸç”ŸAndroidã€iOSä»£ç çš„äº¤äº’ã€‚è¿™ï¼Œä¸è°ƒç”¨ä¸€ä¸ªæœ¬åœ°çš„Dart å¼‚æ­¥APIå¹¶æ— å¤ªå¤šåŒºåˆ«ã€‚</p><p>é€šè¿‡æ–¹æ³•é€šé“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸç”Ÿæ“ä½œç³»ç»Ÿæä¾›çš„åº•å±‚èƒ½åŠ›ï¼Œä»¥åŠç°æœ‰åŸç”Ÿå¼€å‘ä¸­ä¸€äº›ç›¸å¯¹æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆï¼Œä»¥æ¥å£å°è£…çš„å½¢å¼åœ¨Dartå±‚å¿«é€Ÿæå®šï¼Œä»è€Œè§£å†³åŸç”Ÿä»£ç åœ¨Flutterä¸Šçš„å¤ç”¨é—®é¢˜ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Flutteræœ¬èº«æä¾›çš„ä¸°å¯Œæ§ä»¶ï¼Œåšå¥½UIæ¸²æŸ“ã€‚</p><p>åº•å±‚èƒ½åŠ›+åº”ç”¨å±‚æ¸²æŸ“ï¼Œçœ‹ä¼¼æˆ‘ä»¬å·²ç»æå®šäº†æ­å»ºä¸€ä¸ªå¤æ‚Appçš„æ‰€æœ‰å†…å®¹ã€‚ä½†ï¼ŒçœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ</p><h2>æ„å»ºä¸€ä¸ªå¤æ‚Appéƒ½éœ€è¦ä»€ä¹ˆï¼Ÿ</h2><p>åˆ«æ€¥ï¼Œåœ¨ä¸‹ç»“è®ºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæŒ‰ç…§å››è±¡é™åˆ†ææ³•ï¼ŒæŠŠèƒ½åŠ›å’Œæ¸²æŸ“åˆ†è§£æˆå››ä¸ªç»´åº¦ï¼Œåˆ†ææ„å»ºä¸€ä¸ªå¤æ‚Appéƒ½éœ€è¦ä»€ä¹ˆã€‚</p><p><img src="https://static001.geekbang.org/resource/image/d1/cc/d1826dfb3a8b688db04cbf5beb04f2cc.png?wh=1022*802" alt=""></p><center><span class="reference">å›¾1 å››è±¡é™åˆ†ææ³•</span></center><!-- [[[read_end]]] --><p>ç»è¿‡åˆ†æï¼Œæˆ‘ä»¬ç»ˆäºå‘ç°ï¼ŒåŸæ¥æ„å»ºä¸€ä¸ªAppéœ€è¦è¦†ç›–é‚£ä¹ˆå¤šçš„çŸ¥è¯†ç‚¹ï¼Œé€šè¿‡Flutterå’Œæ–¹æ³•é€šé“åªèƒ½æå®šåº”ç”¨å±‚æ¸²æŸ“ã€åº”ç”¨å±‚èƒ½åŠ›å’Œåº•å±‚èƒ½åŠ›ï¼Œå¯¹äºé‚£äº›æ¶‰åŠåˆ°åº•å±‚æ¸²æŸ“ï¼Œæ¯”å¦‚æµè§ˆå™¨ã€ç›¸æœºã€åœ°å›¾ï¼Œä»¥åŠåŸç”Ÿè‡ªå®šä¹‰è§†å›¾çš„åœºæ™¯ï¼Œè‡ªå·±åœ¨Flutterä¸Šé‡æ–°å¼€å‘ä¸€å¥—æ˜¾ç„¶ä¸å¤ªç°å®ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ··åˆè§†å›¾çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Flutterçš„Widgetæ ‘ä¸­æå‰é¢„ç•™ä¸€å—ç©ºç™½åŒºåŸŸï¼Œåœ¨Flutterçš„ç”»æ¿ä¸­ï¼ˆå³FlutterViewä¸FlutterViewControllerï¼‰åµŒå…¥ä¸€ä¸ªä¸ç©ºç™½åŒºåŸŸå®Œå…¨åŒ¹é…çš„åŸç”Ÿè§†å›¾ï¼Œå°±å¯ä»¥å®ç°æƒ³è¦çš„è§†è§‰æ•ˆæœäº†ã€‚</p><p>ä½†æ˜¯ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ¡ˆæå…¶ä¸ä¼˜é›…ï¼Œå› ä¸ºåµŒå…¥çš„åŸç”Ÿè§†å›¾å¹¶ä¸åœ¨Flutterçš„æ¸²æŸ“å±‚çº§ä¸­ï¼Œéœ€è¦åŒæ—¶åœ¨Flutterä¾§ä¸åŸç”Ÿä¾§åšå¤§é‡çš„é€‚é…å·¥ä½œï¼Œæ‰èƒ½å®ç°æ­£å¸¸çš„ç”¨æˆ·äº¤äº’ä½“éªŒã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼ŒFlutteræä¾›äº†ä¸€ä¸ªå¹³å°è§†å›¾ï¼ˆPlatform Viewï¼‰çš„æ¦‚å¿µã€‚å®ƒæä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…åœ¨Flutteré‡Œé¢åµŒå…¥åŸç”Ÿç³»ç»Ÿï¼ˆAndroidå’ŒiOSï¼‰çš„è§†å›¾ï¼Œå¹¶åŠ å…¥åˆ°Flutterçš„æ¸²æŸ“æ ‘ä¸­ï¼Œå®ç°ä¸Flutterä¸€è‡´çš„äº¤äº’ä½“éªŒã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œé€šè¿‡å¹³å°è§†å›¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†ä¸€ä¸ªåŸç”Ÿæ§ä»¶åŒ…è£…æˆFlutteræ§ä»¶ï¼ŒåµŒå…¥åˆ°Flutteré¡µé¢ä¸­ï¼Œå°±åƒä½¿ç”¨ä¸€ä¸ªæ™®é€šçš„Widgetä¸€æ ·ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä¸ä½ è¯¦ç»†è®²è¿°å¦‚ä½•ä½¿ç”¨å¹³å°è§†å›¾ã€‚</p><h2>å¹³å°è§†å›¾</h2><p>å¦‚æœè¯´æ–¹æ³•é€šé“è§£å†³çš„æ˜¯åŸç”Ÿèƒ½åŠ›é€»è¾‘å¤ç”¨é—®é¢˜ï¼Œé‚£ä¹ˆå¹³å°è§†å›¾è§£å†³çš„å°±æ˜¯åŸç”Ÿè§†å›¾å¤ç”¨é—®é¢˜ã€‚Flutteræä¾›äº†ä¸€ç§è½»é‡çº§çš„æ–¹æ³•ï¼Œè®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºåŸç”Ÿï¼ˆAndroidå’ŒiOSï¼‰çš„è§†å›¾ï¼Œé€šè¿‡ä¸€äº›ç®€å•çš„Dartå±‚æ¥å£å°è£…ä¹‹åï¼Œå°±å¯ä»¥å°†å®ƒæ’å…¥Widgetæ ‘ä¸­ï¼Œå®ç°åŸç”Ÿè§†å›¾ä¸Flutterè§†å›¾çš„æ··ç”¨ã€‚</p><p>ä¸€æ¬¡å…¸å‹çš„å¹³å°è§†å›¾ä½¿ç”¨è¿‡ç¨‹ä¸æ–¹æ³•é€šé“ç±»ä¼¼ï¼š</p><ul>
<li>é¦–å…ˆï¼Œç”±ä½œä¸ºå®¢æˆ·ç«¯çš„Flutterï¼Œé€šè¿‡å‘åŸç”Ÿè§†å›¾çš„Flutterå°è£…ç±»ï¼ˆåœ¨iOSå’ŒAndroidå¹³å°åˆ†åˆ«æ˜¯UIKitViewå’ŒAndroidViewï¼‰ä¼ å…¥è§†å›¾æ ‡è¯†ç¬¦ï¼Œç”¨äºå‘èµ·åŸç”Ÿè§†å›¾çš„åˆ›å»ºè¯·æ±‚ï¼›</li>
<li>ç„¶åï¼ŒåŸç”Ÿä»£ç ä¾§å°†å¯¹åº”åŸç”Ÿè§†å›¾çš„åˆ›å»ºäº¤ç»™å¹³å°è§†å›¾å·¥å‚ï¼ˆPlatformViewFactoryï¼‰å®ç°ï¼›</li>
<li>æœ€åï¼Œåœ¨åŸç”Ÿä»£ç ä¾§å°†è§†å›¾æ ‡è¯†ç¬¦ä¸å¹³å°è§†å›¾å·¥å‚è¿›è¡Œå…³è”æ³¨å†Œï¼Œè®©Flutterå‘èµ·çš„è§†å›¾åˆ›å»ºè¯·æ±‚å¯ä»¥ç›´æ¥æ‰¾åˆ°å¯¹åº”çš„è§†å›¾åˆ›å»ºå·¥å‚ã€‚</li>
</ul><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä½¿ç”¨Widgeté‚£æ ·ï¼Œä½¿ç”¨åŸç”Ÿè§†å›¾äº†ã€‚æ•´ä¸ªæµç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/2b/e8/2b3afbb05585c474e4dc2d18bf6066e8.png?wh=1108*768" alt=""></p><center><span class="reference">å›¾2 å¹³å°è§†å›¾ç¤ºä¾‹</span></center><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¥ä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹ï¼Œä¹Ÿå°±æ˜¯å°†ä¸€ä¸ªçº¢è‰²çš„åŸç”Ÿè§†å›¾å†…åµŒåˆ°Flutterä¸­ï¼Œä¸ä½ æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨å¹³å°è§†å›¾ã€‚è¿™éƒ¨åˆ†å†…å®¹ä¸»è¦åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š</p><ul>
<li>ä½œä¸ºè°ƒç”¨å‘èµ·æ–¹çš„Flutterï¼Œå¦‚ä½•å®ç°åŸç”Ÿè§†å›¾çš„æ¥å£è°ƒç”¨ï¼Ÿ</li>
<li>å¦‚ä½•åœ¨åŸç”Ÿï¼ˆAndroidå’ŒiOSï¼‰ç³»ç»Ÿå®ç°æ¥å£ï¼Ÿ</li>
</ul><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°†åˆ†åˆ«ä¸ä½ è®²è¿°è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p><h3>Flutterå¦‚ä½•å®ç°åŸç”Ÿè§†å›¾çš„æ¥å£è°ƒç”¨ï¼Ÿ</h3><p>åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨SampleViewçš„å†…éƒ¨ï¼Œåˆ†åˆ«ä½¿ç”¨äº†åŸç”ŸAndroidã€iOSè§†å›¾çš„å°è£…ç±»AndroidViewå’ŒUIkitViewï¼Œå¹¶ä¼ å…¥äº†ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºå’ŒåŸç”Ÿè§†å›¾å»ºç«‹å…³è”ï¼š</p><pre><code>class SampleView extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    //ä½¿ç”¨Androidå¹³å°çš„AndroidViewï¼Œä¼ å…¥å”¯ä¸€æ ‡è¯†ç¬¦sampleView
    if (defaultTargetPlatform == TargetPlatform.android) {
      return AndroidView(viewType: 'sampleView');
    } else {
      //ä½¿ç”¨iOSå¹³å°çš„UIKitViewï¼Œä¼ å…¥å”¯ä¸€æ ‡è¯†ç¬¦sampleView
      return UiKitView(viewType: 'sampleView');
    }
  }
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå¹³å°è§†å›¾åœ¨Flutterä¾§çš„ä½¿ç”¨æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œä¸æ™®é€šWidgetå¹¶æ— æ˜æ˜¾åŒºåˆ«ã€‚è€Œå…³äºæ™®é€šWidgetçš„ä½¿ç”¨æ–¹å¼ï¼Œä½ å¯ä»¥å‚è€ƒç¬¬<a href="https://time.geekbang.org/column/article/110292">12</a>ã€<a href="https://time.geekbang.org/column/article/110859">13</a>ç¯‡çš„ç›¸å…³å†…å®¹è¿›è¡Œå¤ä¹ ã€‚</p><p>è°ƒç”¨æ–¹çš„å®ç°æå®šäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸç”Ÿä»£ç ä¸­å®Œæˆè§†å›¾åˆ›å»ºçš„å°è£…ï¼Œå»ºç«‹ç›¸å…³çš„ç»‘å®šå…³ç³»ã€‚åŒæ ·çš„ï¼Œç”±äºéœ€è¦åŒæ—¶é€‚é…Androidå’ŒiOSå¹³å°ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«åœ¨ä¸¤ä¸ªç³»ç»Ÿä¸Šå®Œæˆå¯¹åº”çš„æ¥å£å®ç°ã€‚</p><h3>å¦‚ä½•åœ¨åŸç”Ÿç³»ç»Ÿå®ç°æ¥å£ï¼Ÿ</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹<strong>Androidç«¯çš„å®ç°</strong>ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«åˆ›å»ºäº†å¹³å°è§†å›¾å·¥å‚å’ŒåŸç”Ÿè§†å›¾å°è£…ç±»ï¼Œå¹¶é€šè¿‡è§†å›¾å·¥å‚çš„createæ–¹æ³•ï¼Œå°†å®ƒä»¬å…³è”èµ·æ¥ï¼š</p><pre><code>//è§†å›¾å·¥å‚ç±»
class SampleViewFactory extends PlatformViewFactory {
    private final BinaryMessenger messenger;
    //åˆå§‹åŒ–æ–¹æ³•
    public SampleViewFactory(BinaryMessenger msger) {
        super(StandardMessageCodec.INSTANCE);
        messenger = msger;
    }
    //åˆ›å»ºåŸç”Ÿè§†å›¾å°è£…ç±»ï¼Œå®Œæˆå…³è”
    @Override
    public PlatformView create(Context context, int id, Object obj) {
        return new SimpleViewControl(context, id, messenger);
    }
}
//åŸç”Ÿè§†å›¾å°è£…ç±»
class SimpleViewControl implements PlatformView {
    private final View view;//ç¼“å­˜åŸç”Ÿè§†å›¾
    //åˆå§‹åŒ–æ–¹æ³•ï¼Œæå‰åˆ›å»ºå¥½è§†å›¾
    public SimpleViewControl(Context context, int id, BinaryMessenger messenger) {
        view = new View(context);
        view.setBackgroundColor(Color.rgb(255, 0, 0));
    }
    
    //è¿”å›åŸç”Ÿè§†å›¾
    @Override
    public View getView() {
        return view;
    }
    //åŸç”Ÿè§†å›¾é”€æ¯å›è°ƒ
    @Override
    public void dispose() {
    }
}
</code></pre><p>å°†åŸç”Ÿè§†å›¾å°è£…ç±»ä¸åŸç”Ÿè§†å›¾å·¥å‚å®Œæˆå…³è”åï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å°†Flutterä¾§çš„è°ƒç”¨ä¸è§†å›¾å·¥å‚ç»‘å®šèµ·æ¥äº†ã€‚ä¸ä¸Šä¸€ç¯‡æ–‡ç« è®²è¿°çš„æ–¹æ³•é€šé“ç±»ä¼¼ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦åœ¨MainActivityä¸­è¿›è¡Œç»‘å®šæ“ä½œï¼š</p><pre><code>protected void onCreate(Bundle savedInstanceState) {
  ...
  Registrar registrar =    registrarFor(&quot;samples.chenhang/native_views&quot;);//ç”Ÿæˆæ³¨å†Œç±»
  SampleViewFactory playerViewFactory = new SampleViewFactory(registrar.messenger());//ç”Ÿæˆè§†å›¾å·¥å‚

registrar.platformViewRegistry().registerViewFactory(&quot;sampleView&quot;, playerViewFactory);//æ³¨å†Œè§†å›¾å·¥å‚
}
</code></pre><p>å®Œæˆç»‘å®šä¹‹åï¼Œå¹³å°è§†å›¾è°ƒç”¨å“åº”çš„Androidéƒ¨åˆ†å°±æå®šäº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹<strong>iOSç«¯çš„å®ç°</strong>ã€‚</p><p>ä¸Androidç±»ä¼¼ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦åˆ†åˆ«åˆ›å»ºå¹³å°è§†å›¾å·¥å‚å’ŒåŸç”Ÿè§†å›¾å°è£…ç±»ï¼Œå¹¶é€šè¿‡è§†å›¾å·¥å‚çš„createæ–¹æ³•ï¼Œå°†å®ƒä»¬å…³è”èµ·æ¥ï¼š</p><pre><code>//å¹³å°è§†å›¾å·¥å‚
@interface SampleViewFactory : NSObject&lt;FlutterPlatformViewFactory&gt;
- (instancetype)initWithMessenger:(NSObject&lt;FlutterBinaryMessenger&gt;*)messager;
@end

@implementation SampleViewFactory{
  NSObject&lt;FlutterBinaryMessenger&gt;*_messenger;
}

- (instancetype)initWithMessenger:(NSObject&lt;FlutterBinaryMessenger&gt; *)messager{
  self = [super init];
  if (self) {
    _messenger = messager;
  }
  return self;
}

-(NSObject&lt;FlutterMessageCodec&gt; *)createArgsCodec{
  return [FlutterStandardMessageCodec sharedInstance];
}

//åˆ›å»ºåŸç”Ÿè§†å›¾å°è£…å®ä¾‹
-(NSObject&lt;FlutterPlatformView&gt; *)createWithFrame:(CGRect)frame viewIdentifier:(int64_t)viewId arguments:(id)args{
  SampleViewControl *activity = [[SampleViewControl alloc] initWithWithFrame:frame viewIdentifier:viewId arguments:args binaryMessenger:_messenger];
  return activity;
}
@end

//å¹³å°è§†å›¾å°è£…ç±»
@interface SampleViewControl : NSObject&lt;FlutterPlatformView&gt;
- (instancetype)initWithWithFrame:(CGRect)frame viewIdentifier:(int64_t)viewId arguments:(id _Nullable)args binaryMessenger:(NSObject&lt;FlutterBinaryMessenger&gt;*)messenger;
@end

@implementation SampleViewControl{
    UIView * _templcateView;
}
//åˆ›å»ºåŸç”Ÿè§†å›¾
- (instancetype)initWithWithFrame:(CGRect)frame viewIdentifier:(int64_t)viewId arguments:(id)args binaryMessenger:(NSObject&lt;FlutterBinaryMessenger&gt; *)messenger{
  if ([super init]) {
    _templcateView = [[UIView alloc] init];
    _templcateView.backgroundColor = [UIColor redColor];
  }
  return self;
}

-(UIView *)view{
  return _templcateView;
}

@end
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦æŠŠåŸç”Ÿè§†å›¾çš„åˆ›å»ºä¸Flutterä¾§çš„è°ƒç”¨å…³è”èµ·æ¥ï¼Œæ‰å¯ä»¥åœ¨Flutterä¾§æ‰¾åˆ°åŸç”Ÿè§†å›¾çš„å®ç°ï¼š</p><pre><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
  NSObject&lt;FlutterPluginRegistrar&gt;* registrar = [self registrarForPlugin:@&quot;samples.chenhang/native_views&quot;];//ç”Ÿæˆæ³¨å†Œç±»
  SampleViewFactory* viewFactory = [[SampleViewFactory alloc] initWithMessenger:registrar.messenger];//ç”Ÿæˆè§†å›¾å·¥å‚
    [registrar registerViewFactory:viewFactory withId:@&quot;sampleView&quot;];//æ³¨å†Œè§†å›¾å·¥å‚
 ...
}
</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨iOSå¹³å°ä¸Šï¼ŒFlutterå†…åµŒUIKitViewç›®å‰è¿˜å¤„äºæŠ€æœ¯é¢„è§ˆçŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦åœ¨Info.plistæ–‡ä»¶ä¸­å¢åŠ ä¸€é¡¹é…ç½®ï¼ŒæŠŠå†…åµŒåŸç”Ÿè§†å›¾çš„åŠŸèƒ½å¼€å…³è®¾ç½®ä¸ºtrueï¼Œæ‰èƒ½æ‰“å¼€è¿™ä¸ªéšè—åŠŸèƒ½ï¼š</p><pre><code>&lt;dict&gt;
   ...
  &lt;key&gt;io.flutter.embedded_views_preview&lt;/key&gt;
  &lt;true/&gt;
  ....
&lt;/dict&gt;
</code></pre><p>ç»è¿‡ä¸Šé¢çš„å°è£…ä¸ç»‘å®šï¼ŒAndroidç«¯ä¸iOSç«¯çš„å¹³å°è§†å›¾åŠŸèƒ½éƒ½å·²ç»å®ç°äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨Flutteråº”ç”¨é‡Œï¼Œåƒä½¿ç”¨æ™®é€šWidgetä¸€æ ·ï¼Œå»å†…åµŒåŸç”Ÿè§†å›¾äº†ï¼š</p><pre><code> Scaffold(
        backgroundColor: Colors.yellowAccent,
        body:  Container(width: 200, height:200,
            child: SampleView(controller: controller)
        ));
</code></pre><p>å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨iOSå’ŒAndroidå¹³å°çš„Flutteråº”ç”¨ä¸Šï¼Œå†…åµŒäº†ä¸€ä¸ªçº¢è‰²çš„åŸç”Ÿè§†å›¾ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/09/3f/095093cea18f8e18b6de2c94e447d03f.png?wh=2018*1792" alt=""></p><center><span class="reference">å›¾3 å†…åµŒåŸç”Ÿè§†å›¾ç¤ºä¾‹</span></center><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åŸç”Ÿè§†å›¾å°è£…åœ¨ä¸€ä¸ªStatelessWidgetä¸­ï¼Œå¯ä»¥æœ‰æ•ˆåº”å¯¹é™æ€å±•ç¤ºçš„åœºæ™¯ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´åŸç”Ÿè§†å›¾çš„æ ·å¼ï¼Œåˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</p><h2>å¦‚ä½•åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼ŒåŠ¨æ€åœ°è°ƒæ•´åŸç”Ÿè§†å›¾çš„æ ·å¼ï¼Ÿ</h2><p>ä¸åŸºäºå£°æ˜å¼çš„Flutter Widgetï¼Œæ¯æ¬¡å˜åŒ–åªèƒ½ä»¥æ•°æ®é©±åŠ¨å…¶è§†å›¾é”€æ¯é‡å»ºä¸åŒï¼ŒåŸç”Ÿè§†å›¾æ˜¯åŸºäºå‘½ä»¤å¼çš„ï¼Œå¯ä»¥ç²¾ç¡®åœ°æ§åˆ¶è§†å›¾å±•ç¤ºæ ·å¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸç”Ÿè§†å›¾çš„å°è£…ç±»ä¸­ï¼Œå°†å…¶æŒæœ‰çš„ä¿®æ”¹è§†å›¾å®ä¾‹ç›¸å…³çš„æ¥å£ï¼Œä»¥æ–¹æ³•é€šé“çš„æ–¹å¼æš´éœ²ç»™Flutterï¼Œè®©Flutterä¹Ÿå¯ä»¥æ‹¥æœ‰åŠ¨æ€è°ƒæ•´è§†å›¾è§†è§‰æ ·å¼çš„èƒ½åŠ›ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¥ä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹æ¥æ¼”ç¤ºå¦‚ä½•åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´å†…åµŒåŸç”Ÿè§†å›¾çš„èƒŒæ™¯é¢œè‰²ã€‚</p><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°åŸç”Ÿè§†å›¾çš„ä¸€ä¸ªåˆå§‹åŒ–å±æ€§ï¼Œå³onPlatformViewCreatedï¼šåŸç”Ÿè§†å›¾ä¼šåœ¨å…¶åˆ›å»ºå®Œæˆåï¼Œä»¥å›è°ƒçš„å½¢å¼é€šçŸ¥è§†å›¾idï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ—¶å€™æ³¨å†Œæ–¹æ³•é€šé“ï¼Œè®©åç»­çš„è§†å›¾ä¿®æ”¹è¯·æ±‚é€šè¿‡è¿™æ¡é€šé“ä¼ é€’ç»™åŸç”Ÿè§†å›¾ã€‚</p><p>ç”±äºæˆ‘ä»¬åœ¨åº•å±‚ç›´æ¥æŒæœ‰äº†åŸç”Ÿè§†å›¾çš„å®ä¾‹ï¼Œå› æ­¤ç†è®ºä¸Šå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªåŸç”Ÿè§†å›¾çš„Flutterå°è£…ç±»ä¸Šæä¾›è§†å›¾ä¿®æ”¹æ–¹æ³•ï¼Œè€Œä¸ç®¡å®ƒåˆ°åº•æ˜¯StatelessWidgetè¿˜æ˜¯StatefulWidgetã€‚ä½†ä¸ºäº†éµç…§Flutterçš„Widgetè®¾è®¡ç†å¿µï¼Œæˆ‘ä»¬è¿˜æ˜¯å†³å®šå°†è§†å›¾å±•ç¤ºä¸è§†å›¾æ§åˆ¶åˆ†ç¦»ï¼Œå³ï¼šå°†åŸç”Ÿè§†å›¾å°è£…ä¸ºä¸€ä¸ªStatefulWidgetä¸“é—¨ç”¨äºå±•ç¤ºï¼Œé€šè¿‡å…¶controlleråˆå§‹åŒ–å‚æ•°ï¼Œåœ¨è¿è¡ŒæœŸä¿®æ”¹åŸç”Ÿè§†å›¾çš„å±•ç¤ºæ•ˆæœã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>//åŸç”Ÿè§†å›¾æ§åˆ¶å™¨
class NativeViewController {
  MethodChannel _channel;
  //åŸç”Ÿè§†å›¾å®Œæˆåˆ›å»ºåï¼Œé€šè¿‡idç”Ÿæˆå”¯ä¸€æ–¹æ³•é€šé“
  onCreate(int id) {
    _channel = MethodChannel('samples.chenhang/native_views_$id');
  }
  //è°ƒç”¨åŸç”Ÿè§†å›¾æ–¹æ³•ï¼Œæ”¹å˜èƒŒæ™¯é¢œè‰²
  Future&lt;void&gt; changeBackgroundColor() async {
    return _channel.invokeMethod('changeBackgroundColor');
  }
}

//åŸç”Ÿè§†å›¾Flutterä¾§å°è£…ï¼Œç»§æ‰¿è‡ªStatefulWidget
class SampleView extends StatefulWidget {
  const SampleView({
    Key key,
    this.controller,
  }) : super(key: key);

  //æŒæœ‰è§†å›¾æ§åˆ¶å™¨
  final NativeViewController controller;
  @override
  State&lt;StatefulWidget&gt; createState() =&gt; _SampleViewState();
}

class _SampleViewState extends State&lt;SampleView&gt; {
  //æ ¹æ®å¹³å°ç¡®å®šè¿”å›ä½•ç§å¹³å°è§†å›¾
  @override
  Widget build(BuildContext context) {
    if (defaultTargetPlatform == TargetPlatform.android) {
      return AndroidView(
        viewType: 'sampleView',
        //åŸç”Ÿè§†å›¾åˆ›å»ºå®Œæˆåï¼Œé€šè¿‡onPlatformViewCreatedäº§ç”Ÿå›è°ƒ
        onPlatformViewCreated: _onPlatformViewCreated,
      );
    } else {
      return UiKitView(viewType: 'sampleView',
        //åŸç”Ÿè§†å›¾åˆ›å»ºå®Œæˆåï¼Œé€šè¿‡onPlatformViewCreatedäº§ç”Ÿå›è°ƒ
        onPlatformViewCreated: _onPlatformViewCreated
      );
    }
  }
  //åŸç”Ÿè§†å›¾åˆ›å»ºå®Œæˆåï¼Œè°ƒç”¨controlçš„onCreateæ–¹æ³•ï¼Œä¼ å…¥view id
  _onPlatformViewCreated(int id) {
    if (widget.controller == null) {
      return;
    }
    widget.controller.onCreate(id);
  }
}
</code></pre><p>Flutterçš„è°ƒç”¨æ–¹å®ç°æå®šäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«çœ‹çœ‹Androidå’ŒiOSç«¯çš„å®ç°ã€‚</p><p>ç¨‹åºçš„æ•´ä½“ç»“æ„ä¸ä¹‹å‰å¹¶æ— ä¸åŒï¼Œåªæ˜¯åœ¨è¿›è¡ŒåŸç”Ÿè§†å›¾åˆå§‹åŒ–æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å®Œæˆæ–¹æ³•é€šé“çš„æ³¨å†Œå’Œç›¸å…³äº‹ä»¶çš„å¤„ç†ï¼›åœ¨å“åº”æ–¹æ³•è°ƒç”¨æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ–¹æ³•åï¼Œå¦‚æœå®Œå…¨åŒ¹é…ï¼Œåˆ™ä¿®æ”¹è§†å›¾èƒŒæ™¯ï¼Œå¦åˆ™è¿”å›å¼‚å¸¸ã€‚</p><p>Androidç«¯æ¥å£å®ç°ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>class SimpleViewControl implements PlatformView, MethodCallHandler {
    private final MethodChannel methodChannel;
    ...
    public SimpleViewControl(Context context, int id, BinaryMessenger messenger) {
        ...
        //ç”¨view idæ³¨å†Œæ–¹æ³•é€šé“
        methodChannel = new MethodChannel(messenger, &quot;samples.chenhang/native_views_&quot; + id);
        //è®¾ç½®æ–¹æ³•é€šé“å›è°ƒ
        methodChannel.setMethodCallHandler(this);
    }
    //å¤„ç†æ–¹æ³•è°ƒç”¨æ¶ˆæ¯
    @Override
    public void onMethodCall(MethodCall methodCall, MethodChannel.Result result) {
        //å¦‚æœæ–¹æ³•åå®Œå…¨åŒ¹é…
        if (methodCall.method.equals(&quot;changeBackgroundColor&quot;)) {
            //ä¿®æ”¹è§†å›¾èƒŒæ™¯ï¼Œè¿”å›æˆåŠŸ
            view.setBackgroundColor(Color.rgb(0, 0, 255));
            result.success(0);
        }else {
            //è°ƒç”¨æ–¹å‘èµ·äº†ä¸€ä¸ªä¸æ”¯æŒçš„APIè°ƒç”¨
            result.notImplemented();
        }
    }
  ...
}
</code></pre><p>iOSç«¯æ¥å£å®ç°ä»£ç ï¼š</p><pre><code>@implementation SampleViewControl{
    ...
    FlutterMethodChannel* _channel;
}

- (instancetype)initWithWithFrame:(CGRect)frame viewIdentifier:(int64_t)viewId arguments:(id)args binaryMessenger:(NSObject&lt;FlutterBinaryMessenger&gt; *)messenger{
    if ([super init]) {
        ...
        //ä½¿ç”¨view idå®Œæˆæ–¹æ³•é€šé“çš„åˆ›å»º
        _channel = [FlutterMethodChannel methodChannelWithName:[NSString stringWithFormat:@&quot;samples.chenhang/native_views_%lld&quot;, viewId] binaryMessenger:messenger];
        //è®¾ç½®æ–¹æ³•é€šé“çš„å¤„ç†å›è°ƒ
        __weak __typeof__(self) weakSelf = self;
        [_channel setMethodCallHandler:^(FlutterMethodCall* call, FlutterResult result) {
            [weakSelf onMethodCall:call result:result];
        }];
    }
    return self;
}

//å“åº”æ–¹æ³•è°ƒç”¨æ¶ˆæ¯
- (void)onMethodCall:(FlutterMethodCall*)call result:(FlutterResult)result {
    //å¦‚æœæ–¹æ³•åå®Œå…¨åŒ¹é…
    if ([[call method] isEqualToString:@&quot;changeBackgroundColor&quot;]) {
        //ä¿®æ”¹è§†å›¾èƒŒæ™¯è‰²ï¼Œè¿”å›æˆåŠŸ
        _templcateView.backgroundColor = [UIColor blueColor];
        result(@0);
    } else {
        //è°ƒç”¨æ–¹å‘èµ·äº†ä¸€ä¸ªä¸æ”¯æŒçš„APIè°ƒç”¨
        result(FlutterMethodNotImplemented);
    }
}
 ...
@end
</code></pre><p>é€šè¿‡æ³¨å†Œæ–¹æ³•é€šé“ï¼Œä»¥åŠæš´éœ²çš„changeBackgroundColoræ¥å£ï¼ŒAndroidç«¯ä¸iOSç«¯ä¿®æ”¹å¹³å°è§†å›¾èƒŒæ™¯é¢œè‰²çš„åŠŸèƒ½éƒ½å·²ç»å®ç°äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨Flutteråº”ç”¨è¿è¡ŒæœŸé—´ï¼Œä¿®æ”¹åŸç”Ÿè§†å›¾å±•ç¤ºæ ·å¼äº†ï¼š</p><pre><code>class DefaultState extends State&lt;DefaultPage&gt; {
  NativeViewController controller;
  @override
  void initState() {
    controller = NativeViewController();//åˆå§‹åŒ–åŸç”ŸViewæ§åˆ¶å™¨
	super.initState();
  }
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
          ...
          //å†…åµŒåŸç”ŸView
          body:  Container(width: 200, height:200,
              child: SampleView(controller: controller)
          ),
         //è®¾ç½®ç‚¹å‡»è¡Œä¸ºï¼šæ”¹å˜è§†å›¾é¢œè‰² 
         floatingActionButton: FloatingActionButton(onPressed: ()=&gt;controller.changeBackgroundColor())
    );
  }
}
</code></pre><p>è¿è¡Œä¸€ä¸‹ï¼Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/fd/ac/fd1f6d7280aaacb3294d7733706fc8ac.gif?wh=720*1256" alt=""></p><center><span class="reference">å›¾4 åŠ¨æ€ä¿®æ”¹åŸç”Ÿè§†å›¾æ ·å¼</span></center><h2>æ€»ç»“</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œã€‚æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ä»Šå¤©çš„ä¸»è¦å†…å®¹å§ã€‚</p><p>å¹³å°è§†å›¾è§£å†³äº†åŸç”Ÿæ¸²æŸ“èƒ½åŠ›çš„å¤ç”¨é—®é¢˜ï¼Œä½¿å¾—Flutterèƒ½å¤Ÿé€šè¿‡è½»é‡çº§çš„ä»£ç å°è£…ï¼ŒæŠŠåŸç”Ÿè§†å›¾ç»„è£…æˆä¸€ä¸ªFlutteræ§ä»¶ã€‚</p><p>Flutteræä¾›äº†å¹³å°è§†å›¾å·¥å‚å’Œè§†å›¾æ ‡è¯†ç¬¦ä¸¤ä¸ªæ¦‚å¿µï¼Œå› æ­¤Dartå±‚å‘èµ·çš„è§†å›¾åˆ›å»ºè¯·æ±‚å¯ä»¥é€šè¿‡æ ‡è¯†ç¬¦ç›´æ¥æ‰¾åˆ°å¯¹åº”çš„è§†å›¾åˆ›å»ºå·¥å‚ï¼Œä»è€Œå®ç°åŸç”Ÿè§†å›¾ä¸Flutterè§†å›¾çš„èåˆå¤ç”¨ã€‚å¯¹äºéœ€è¦åœ¨è¿è¡ŒæœŸåŠ¨æ€è°ƒç”¨åŸç”Ÿè§†å›¾æ¥å£çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸç”Ÿè§†å›¾çš„å°è£…ç±»ä¸­æ³¨å†Œæ–¹æ³•é€šé“ï¼Œå®ç°ç²¾ç¡®æ§åˆ¶åŸç”Ÿè§†å›¾å±•ç¤ºçš„æ•ˆæœã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºFlutterä¸åŸç”Ÿæ¸²æŸ“æ–¹å¼å®Œå…¨ä¸åŒï¼Œå› æ­¤è½¬æ¢ä¸åŒçš„æ¸²æŸ“æ•°æ®ä¼šæœ‰è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ã€‚å¦‚æœåœ¨ä¸€ä¸ªç•Œé¢ä¸ŠåŒæ—¶å®ä¾‹åŒ–å¤šä¸ªåŸç”Ÿæ§ä»¶ï¼Œå°±ä¼šå¯¹æ€§èƒ½é€ æˆéå¸¸å¤§çš„å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é¿å…åœ¨ä½¿ç”¨Flutteræ§ä»¶ä¹Ÿèƒ½å®ç°çš„æƒ…å†µä¸‹å»ä½¿ç”¨å†…åµŒå¹³å°è§†å›¾ã€‚</p><p>å› ä¸ºè¿™æ ·åšï¼Œä¸€æ–¹é¢éœ€è¦åˆ†åˆ«åœ¨Androidå’ŒiOSç«¯å†™å¤§é‡çš„é€‚é…æ¡¥æ¥ä»£ç ï¼Œè¿èƒŒäº†è·¨å¹³å°æŠ€æœ¯çš„æœ¬æ„ï¼Œä¹Ÿå¢åŠ äº†åç»­çš„ç»´æŠ¤æˆæœ¬ï¼›å¦ä¸€æ–¹é¢æ¯•ç«Ÿé™¤å»åœ°å›¾ã€WebViewã€ç›¸æœºç­‰æ¶‰åŠåº•å±‚æ–¹æ¡ˆçš„ç‰¹æ®Šæƒ…å†µå¤–ï¼Œå¤§éƒ¨åˆ†åŸç”Ÿä»£ç èƒ½å¤Ÿå®ç°çš„UIæ•ˆæœï¼Œå®Œå…¨å¯ä»¥ç”¨Flutterå®ç°ã€‚</p><p>æˆ‘æŠŠä»Šå¤©åˆ†äº«æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æ‰“åŒ…åˆ°äº†<a href="https://github.com/cyndibaby905/27_native_view">GitHub</a>ä¸­ï¼Œä½ å¯ä»¥ä¸‹è½½ä¸‹æ¥ï¼Œåå¤è¿è¡Œå‡ æ¬¡ï¼ŒåŠ æ·±ç†è§£ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸‹ä¸€é“æ€è€ƒé¢˜å§ã€‚</p><p>è¯·ä½ åœ¨åŠ¨æ€è°ƒæ•´åŸç”Ÿè§†å›¾æ ·å¼çš„ä»£ç åŸºç¡€ä¸Šï¼Œå¢åŠ é¢œè‰²å‚æ•°ï¼Œä»¥å®ç°åŠ¨æ€å˜æ›´åŸç”Ÿè§†å›¾é¢œè‰²çš„éœ€æ±‚ã€‚</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ç­‰å¾…ä½ ï¼æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p></p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/51/61/9c5beba4.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å®‡</span>
  </div>
  <div class="_2_QraFYR_0">æ€è€ƒé¢˜å®ç°æ€è·¯<br><br>dartå±‚è®¾ç½®é¢œè‰²å‚æ•°çš„æ–¹æ³•ï¼š<br>changeBackgroundColor(int r, int g, int b) async<br>  {<br>    _channel.invokeMethod(&#39;changeBackgroundColor&#39;, {&quot;r&quot;:r, &quot;g&quot;:g, &quot;b&quot;:b});<br>  }<br><br>dartå±‚è°ƒç”¨ï¼š<br>controller.changeBackgroundColor(0, 255, 255)<br><br>android nativeå±‚å®ç°ï¼š<br>if (methodCall.method.equals(&quot;changeBackgroundColor&quot;)) {<br>      int r = methodCall.argument(&quot;r&quot;);<br>      int g = methodCall.argument(&quot;g&quot;);<br>      int b = methodCall.argument(&quot;b&quot;);<br>      view.setBackgroundColor(Color.rgb(r, g, b));<br>      result.success(0);<br>    }else {<br>      result.notImplemented();<br>    }<br></div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµğŸ‘</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-02 21:14:05</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è®¸ç«¥ç«¥</span>
  </div>
  <div class="_2_QraFYR_0">å¦™å•Šï¼Œé€šè¿‡å¹³å°è§†å›¾ï¼ŒFlutterå°±å¯ä»¥ä½¿ç”¨åŸç”Ÿè§†å›¾äº†ï¼Œè¿™æ ·ï¼ŒåŸºæœ¬æ‰€æœ‰éœ€æ±‚éƒ½å¯ä»¥å®ç°äº†ã€‚å¦‚æœç¤¾åŒºå†ç¹è£ä¸€ç‚¹ï¼Œè®¸å¤šç»„ä»¶éƒ½å¯ä»¥æ‹¿æ¥å³ç”¨ï¼Œé‚£å¼€å‘éœ€æ±‚çš„é€Ÿåº¦å°±æ˜¯ç›¸å½“å¿«äº†ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-29 14:01:18</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/e7/bd/cb2fb958.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Verios</span>
  </div>
  <div class="_2_QraFYR_0"> æ¯æ¬¡ widget é‡å»ºï¼Œéƒ½ä¼šcreateä¸€ä¸ªåŸç”Ÿ view å—ï¼Ÿ<br></div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-03-19 18:51:20</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/18/bc/0e/c76861eb.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>jianwei</span>
  </div>
  <div class="_2_QraFYR_0">floatingActionButton: FloatingActionButton(<br>	onPressed: () =&gt; controller.changeBackground(&#39;#FFFFFF&#39;),<br>),<br><br>Future&lt;void&gt; changeBackground(String colorString) async {<br>	try {<br>	  return _channel.invokeMethod(&#39;changeBackgroundColor&#39;, &lt;String, dynamic&gt; {<br>	    &#39;color&#39;: colorString<br>	  });<br>	} catch (e) {<br>	}<br>}<br><br>- (void)onMethodCall:(FlutterMethodCall*)call result:(FlutterResult)result {<br>    if ([call.method isEqualToString:@&quot;changeBackgroundColor&quot;]) {<br>        NSString *colorString = call.arguments[@&quot;color&quot;];<br>        if (colorString.length != 0) {<br>            _templcateView.backgroundColor = [UIColor colorWithHexString:colorString];<br>            result(@0);<br>            return;<br>        }<br>    }<br>    result(FlutterMethodNotImplemented);<br>}</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-01-08 12:44:16</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/0b/73/4f1c9676.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>èˆ’å¤§é£</span>
  </div>
  <div class="_2_QraFYR_0">åè¿‡æ¥ï¼Œå¯ä»¥åœ¨åŸç”Ÿé¡µé¢ä¸­åµŒå…¥ä¸€å°å—Flutterè§†å›¾å—</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¯ä»¥ï¼ŒActivityå†…åµŒflutterViewå…¶å®å°±æ˜¯è¿™ç§æ–¹å¼ï¼Œåªæ˜¯è¿™ä¸ªè§†å›¾å¤§å°æ˜¯æ•´ä¸ªå±å¹•</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-10-10 13:58:04</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/55/28/7dd45ca0.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å¥‡å¾—éš†å†¬å¼º</span>
  </div>
  <div class="_2_QraFYR_0">è¿™ä¸ªæ˜¯ä¸æ˜¯ä¸€ä¸ª NativeViewController å¯¹åº”ä¸€ä¸ª Widgtï¼Ÿï¼Ÿå› ä¸º id ä¸ä¸€æ ·</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2023-04-05 19:55:47</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/19/71/6f/07e1452a.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å¾®å°˜</span>
  </div>
  <div class="_2_QraFYR_0">è¿™ä¸€èŠ‚å«é‡‘é‡é«˜å•Šï¼Œä¸çŸ¥é“windows æ˜¯å¦ä¹Ÿå¯ä»¥æä¾›æ’ä»¶ç»™dartç«¯ä½¿ç”¨å‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-11-14 23:46:51</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/20/89/33/6c66ed4a.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>äº”ååº¦ç°é»‘</span>
  </div>
  <div class="_2_QraFYR_0">Flutter é¡µé¢åµŒå…¥åŸç”Ÿè§†å›¾ï¼Œæœ‰æ»šåŠ¨æ¡çš„æƒ…å†µï¼ŒåŸç”Ÿè§†å›¾å®šä½é—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-11-29 08:16:35</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/17/6d/0a/8e7f0f04.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>åˆ˜æ´ªæ—</span>
  </div>
  <div class="_2_QraFYR_0">å¯¹å‰ç«¯æ¥è¯´æ˜¯ä¸æ˜¯è¿˜è¦å­¦å®‰å“å’ŒiOSå¼€å‘å•Š</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-05-04 22:19:04</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6ADlY3IFt3Rs1aVDyrTO2BiaV8wiabypPwbXhbPcyqicCvnTV9lUYHULVqUab7ww4taX5QbmFyatLQ/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Geek_cc0a3b</span>
  </div>
  <div class="_2_QraFYR_0">å†…åµŒåŸç”Ÿç©ºé—´ï¼Œäº‹ä»¶å“åº”æ¯”å¦‚onClickæ˜¯ç›´æ¥åœ¨åŸç”Ÿå±‚å“åº”äº†å§ï¼Œflutterä¸éœ€è¦è´Ÿè´£å¤„ç†åŸç”Ÿäº‹ä»¶çš„å“åº”å§ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-04-27 17:59:49</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/46/c0/cdc50180.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å°å¼º</span>
  </div>
  <div class="_2_QraFYR_0">&#47;&#47;åŸç”Ÿè§†å›¾é”€æ¯å›è°ƒ    @Override    public void dispose() {    }<br>å®‰å“ä¸Šæœ‰è¿™ä¸ªå›è°ƒï¼Œæ€ä¹ˆiOSæ²¡æœ‰å¯¹åº”çš„å›è°ƒï¼Œåˆšå¥½é¡¹ç›®é‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼ŒæœŸå¾…è€å¸ˆè§£æƒ‘</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-04-25 18:34:28</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ— å</span>
  </div>
  <div class="_2_QraFYR_0">iOS å¹³å°è§†å›¾ä¸­ï¼š-(NSObject&lt;FlutterPlatformView&gt; *)createWithFrame:(CGRect)frame viewIdentifier:(int64_t)viewId arguments:(id)args{}<br>ä¸ºä½•frameçš„å€¼éƒ½æ˜¯(0.0, 0.0, 0.0, 0.0)ï¼Œä¸ºä½•æ²¡æœ‰å®½é«˜ï¼Ÿè¿™é‡Œä¸åº”è¯¥æ˜¯æ˜¾ç¤ºçš„è§†å›¾å¤§å°å—ï¼Ÿ<br></div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-08-14 22:52:58</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>lala</span>
  </div>
  <div class="_2_QraFYR_0">  _onPlatformViewCreated(int id) {<br>    if (widget.controller == null) {<br>      return;<br>    }<br>    widget.controller.onCreate(id);<br>  }<br>ç¤ºä¾‹ä¸­idä¼ å€¼æ˜¯å¤šå°‘å‘¢ï¼Ÿè¯·è€å¸ˆè§£ç­”ä¸‹ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-08-12 23:57:57</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Geek_fdd35e</span>
  </div>
  <div class="_2_QraFYR_0">registrarFor(&quot;com.hangchen&#47;NativeViews&quot;); <br>registrarForè¿™ä¸ªæ–¹æ³•æ‰¾ä¸åˆ°äº†,è¯´æ²¡æœ‰å£°æ˜, flutter 1.0.0</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-07-24 17:08:50</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/akIbCt3y9ssJWI17UoalPcCICJboZoibSybpR3f6RoNYSFhLchLA0Kib0N1q15DI3DW8vF6K6wpt0TPh81Au44HQ/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>zeqin</span>
  </div>
  <div class="_2_QraFYR_0">é‚£æ€ä¹ˆå®ç°åŸç”Ÿå’Œfutteré—´äº’ç›¸ä¼ å€¼ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-06-04 09:07:32</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/f0/61/68462a07.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ— å</span>
  </div>
  <div class="_2_QraFYR_0">iOS ä¸­FlutterPlatformViewFactoryçš„func create(withFrame frame: CGRect, viewIdentifier viewId: Int64, arguments args: Any?)æ–¹æ³•ä¸­çš„frameå€¼éƒ½ä¸º0ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°æ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹ä¼šæœ‰å€¼ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-05-13 15:19:46</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/30/3c/c2c72e28.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ˜Ÿæ˜Ÿ</span>
  </div>
  <div class="_2_QraFYR_0">è¿™ä¸ªåœ¨io.flutter.embedding.android.FlutterActivityä¸­å¦‚ä½•ç»‘å®šå‘¢ï¼Œæ²¡æœ‰å“åº”çš„æ–¹æ³•å•Š</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-03-16 21:02:51</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/04/97/80740db0.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>JW</span>
  </div>
  <div class="_2_QraFYR_0">åœ¨flutterå·¥ç¨‹ä¸‹ .androidæ‰“å¼€çš„javaæ–‡ä»¶æ— æ³•ç¼–è¯‘å’Œæç¤ºï¼Œç¼–å†™æœ¬åœ°ä»£ç ä¸å‹å¥½ï¼Œæœ‰ä»€ä¹ˆåŠæ³•å—ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-03 18:24:53</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/91/30/432a7288.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>mqh</span>
  </div>
  <div class="_2_QraFYR_0">ç°åœ¨æ³¨å†Œæ’ä»¶çš„è¯éœ€è¦ç”¨FlutterPluginï¼Œç”¨æ–°æ¥å£çš„è¯å¦‚ä½•è¿›è¡Œæ³¨å†Œï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-01-06 23:17:01</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/18/56/f9/597cc541.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>kennen</span>
  </div>
  <div class="_2_QraFYR_0">iOSä¸­çš„frameå‚æ•°å¹¶æ²¡æœ‰ç”¨åˆ°ï¼Œflutteræ˜¯æ€ä¹ˆæŠŠå®½é«˜ä¼ ç»™iOSæ¥å±•ç¤ºçš„å‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä½ å›å¿†ä¸€ä¸‹iOSä¸­autolayoutå’Œautoreleaseä¸­çˆ¶å®¹å™¨çš„å¸ƒå±€å˜åŒ–å¯¹äºç»„ä»¶å¸ƒå±€çš„å½±å“</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-11-26 19:58:07</div>
  </div>
</div>
</div>
</li>
</ul>