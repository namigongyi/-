<audio title="36_æ–‡æœ¬èšç±»ï¼šå¦‚ä½•è¿‡æ»¤å†—ä½™çš„æ–°é—»ï¼Ÿ" src="https://static001.geekbang.org/resource/audio/74/74/74db4f5a980744960b6025741a3bc274.mp3" controls="controls"></audio> 
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ç”³ã€‚</p><p>å‰ä¸¤èŠ‚ï¼Œæˆ‘è®²äº†å‘é‡ç©ºé—´æ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•åœ¨ä¿¡æ¯æ£€ç´¢é¢†åŸŸä¸­è¿ç”¨å‘é‡ç©ºé—´æ¨¡å‹ã€‚å‘é‡ç©ºé—´æ¨¡å‹æä¾›äº†è¡¡é‡å‘é‡ä¹‹é—´çš„è·ç¦»æˆ–è€…ç›¸ä¼¼åº¦çš„æœºåˆ¶ï¼Œè€Œè¿™ç§æœºåˆ¶å¯ä»¥è¡¡é‡æŸ¥è¯¢å’Œè¢«æŸ¥è¯¢æ•°æ®ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ï¼Œè€Œå¯¹äºæ–‡æœ¬æ£€ç´¢æ¥è¯´ï¼ŒæŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦å¯ä½œä¸ºæ–‡æ¡£çš„ç›¸å…³æ€§ã€‚</p><p>å®é™…ä¸Šï¼Œé™¤äº†æ–‡æ¡£çš„ç›¸å…³æ€§ï¼Œè·ç¦»æˆ–è€…ç›¸ä¼¼åº¦è¿˜å¯ä»¥ç”¨åœ¨æœºå™¨å­¦ä¹ çš„ç®—æ³•ä¸­ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠå¦‚ä½•åœ¨èšç±»ç®—æ³•ä¸­ä½¿ç”¨å‘é‡ç©ºé—´æ¨¡å‹ï¼Œå¹¶æœ€ç»ˆå®ç°è¿‡æ»¤é‡å¤æ–‡ç« ã€‚</p><h2>èšç±»ç®—æ³•</h2><p>åœ¨æ¦‚ç‡ç»Ÿè®¡æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†åˆ†ç±»ï¼ˆClassification/Categorizationï¼‰å’Œå›å½’ï¼ˆRegressionï¼‰è¿™ä¸¤ç§ç›‘ç£å¼å­¦ä¹ ï¼ˆSupervised Learningï¼‰ã€‚ç›‘ç£å¼å­¦ä¹ é€šè¿‡è®­ç»ƒèµ„æ–™å­¦ä¹ å¹¶å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶ä¾æ­¤æ¨¡å‹å¯¹æ–°çš„å®ä¾‹è¿›è¡Œé¢„æµ‹ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨å®é™…åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°å¦ä¸€ç§æ›´ä¸ºå¤æ‚çš„æƒ…å†µã€‚è¿™æ—¶å€™ä¸å­˜åœ¨ä»»ä½•å…³äºæ ·æœ¬çš„å…ˆéªŒçŸ¥è¯†ï¼Œè€Œæ˜¯éœ€è¦æœºå™¨åœ¨æ²¡äººæŒ‡å¯¼çš„æƒ…å½¢ä¸‹ï¼Œå»å°†å¾ˆå¤šä¸œè¥¿è¿›è¡Œå½’ç±»ã€‚ç”±äºç¼ºä¹è®­ç»ƒæ ·æœ¬ï¼Œè¿™ç§å­¦ä¹ è¢«ç§°ä¸ºâ€œéç›‘ç£å­¦ä¹ â€ï¼ˆUnsupervised Learningï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„èšç±»ï¼ˆClusteringï¼‰ã€‚åœ¨è¿™ç§å­¦ä¹ ä½“ç³»ä¸­ï¼Œç³»ç»Ÿå¿…é¡»é€šè¿‡ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•å‘ç°æ ·æœ¬çš„å†…åœ¨ç›¸ä¼¼æ€§ï¼Œå¹¶æŠŠæ•°æ®å¯¹è±¡ä»¥ç¾¤ç»„ï¼ˆClusterï¼‰çš„å½¢å¼è¿›è¡Œåˆ’åˆ†ã€‚</p><!-- [[[read_end]]] --><p>è°ˆåˆ°ç›¸ä¼¼æ€§ï¼Œä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†åˆ©ç”¨ç‰¹å¾å‘é‡å’Œå‘é‡ç©ºé—´æ¨¡å‹ï¼Œè¿™ç¡®å®æ˜¯å¯è¡Œçš„æ–¹æ³•ã€‚ä¸è¿‡ï¼Œä¸ºäº†è®©ä½ å…¨é¢äº†è§£åœ¨æ•´ä¸ªéç›‘ç£å¼å­¦ä¹ ä¸­ï¼Œå¦‚ä½•è¿ç”¨å‘é‡ç©ºé—´ï¼Œè®©æˆ‘å…ˆä»ä¸€ä¸ªå…·ä½“çš„èšç±»ç®—æ³•å¼€å§‹ã€‚</p><p>è¿™ä¸ªç®—æ³•çš„åç§°æ˜¯Kå‡å€¼ï¼ˆK-Meansï¼‰èšç±»ç®—æ³•ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªä»»æ„å¤šçš„æ•°æ®ä¸Šï¼Œå¾—åˆ°ä¸€ä¸ªäº‹å…ˆå®šå¥½ç¾¤ç»„æ•°é‡ï¼ˆKï¼‰çš„èšç±»ç»“æœã€‚è¿™ç§ç®—æ³•çš„ä¸­å¿ƒæ€æƒ³æ˜¯ï¼šå°½é‡æœ€å¤§åŒ–æ€»çš„ç¾¤ç»„å†…ç›¸ä¼¼åº¦ï¼ŒåŒæ—¶å°½é‡æœ€å°åŒ–ç¾¤ç»„ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚ç¾¤ç»„å†…æˆ–ç¾¤ç»„é—´çš„ç›¸ä¼¼åº¦ï¼Œæ˜¯é€šè¿‡å„ä¸ªæˆå‘˜å’Œç¾¤ç»„è´¨å¿ƒç›¸æ¯”è¾ƒæ¥ç¡®å®šçš„ã€‚æƒ³æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯åœ¨æ ·æœ¬æ•°é‡è¾¾åˆ°ä¸€å®šè§„æ¨¡åï¼Œå¸Œæœ›é€šè¿‡æ’åˆ—ç»„åˆæ‰€æœ‰çš„ç¾¤ç»„åˆ’åˆ†ï¼Œæ¥æ‰¾åˆ°æœ€å¤§æ€»ç¾¤ç»„å†…çš„ç›¸ä¼¼åº¦å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚äºæ˜¯äººä»¬æå‡ºå¦‚ä¸‹çš„æ±‚è¿‘ä¼¼è§£çš„æ–¹æ³•ã€‚</p><ol>
<li>
<p>ä»Nä¸ªæ•°æ®å¯¹è±¡ä¸­éšæœºé€‰å–kä¸ªå¯¹è±¡ä½œä¸ºè´¨å¿ƒï¼Œè¿™é‡Œæ¯ä¸ªç¾¤ç»„çš„è´¨å¿ƒå®šä¹‰æ˜¯ï¼Œç¾¤ç»„å†…æ‰€æœ‰æˆå‘˜å¯¹è±¡çš„å¹³å‡å€¼ã€‚å› ä¸ºæ˜¯ç¬¬ä¸€è½®ï¼Œæ‰€ä»¥ç¬¬iä¸ªç¾¤ç»„çš„è´¨å¿ƒå°±æ˜¯ç¬¬iä¸ªå¯¹è±¡ï¼Œè€Œä¸”è¿™æ—¶å€™æˆ‘ä»¬åªæœ‰è¿™ä¸€ä¸ªç»„å‘˜ã€‚</p>
</li>
<li>
<p>å¯¹å‰©ä½™çš„å¯¹è±¡ï¼Œæµ‹é‡å®ƒå’Œæ¯ä¸ªè´¨å¿ƒçš„ç›¸ä¼¼åº¦ï¼Œå¹¶æŠŠå®ƒå½’åˆ°æœ€è¿‘çš„è´¨å¿ƒæ‰€å±çš„ç¾¤ç»„ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¯´è·ç¦»ï¼Œä¹Ÿå¯ä»¥è¯´ç›¸ä¼¼åº¦ï¼Œåªæ˜¯ä¸¤è€…å‘ˆç°åæ¯”å…³ç³»ã€‚</p>
</li>
<li>
<p>é‡æ–°è®¡ç®—å·²ç»å¾—åˆ°çš„å„ä¸ªç¾¤ç»„çš„è´¨å¿ƒã€‚è¿™é‡Œè´¨å¿ƒçš„è®¡ç®—æ˜¯å…³é”®ï¼Œå¦‚æœä½¿ç”¨ç‰¹å¾å‘é‡æ¥è¡¨ç¤ºçš„æ•°æ®å¯¹è±¡ï¼Œé‚£ä¹ˆæœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯å–ç¾¤ç»„å†…æˆå‘˜çš„ç‰¹å¾å‘é‡ï¼Œå°†å®ƒä»¬çš„å¹³å‡å€¼ä½œä¸ºè´¨å¿ƒçš„å‘é‡è¡¨ç¤ºã€‚</p>
</li>
<li>
<p>è¿­ä»£ä¸Šé¢çš„ç¬¬2æ­¥å’Œç¬¬3æ­¥ï¼Œç›´è‡³æ–°çš„è´¨å¿ƒä¸åŸè´¨å¿ƒç›¸ç­‰æˆ–ç›¸å·®ä¹‹å€¼å°äºæŒ‡å®šé˜ˆå€¼ï¼Œç®—æ³•ç»“æŸã€‚</p>
</li>
</ol><p>æˆ‘ä»¥äºŒç»´ç©ºé—´ä¸ºä¾‹å­ï¼Œç”»å¼ å›¾æ¥å±•ç¤ºä¸€ä¸‹æ•°æ®å¯¹è±¡èšç±»çš„è¿‡ç¨‹ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/56/0e/5642c36e8780997ee36ed53380ae880e.png?wh=1222*476" alt=""></p><p>åœ¨è¿™å¼ å›¾ä¸­ï¼Œ( a )ã€( b )ã€( c )ä¸‰æ­¥åˆ†åˆ«å±•ç¤ºäº†è´¨å¿ƒå’Œç¾¤ç»„é€æ­¥è°ƒæ•´çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬ä¸€ä¸€æ¥çœ‹ã€‚(a)æ­¥éª¤æ˜¯é€‰æ‹©åˆå§‹è´¨å¿ƒï¼Œè´¨å¿ƒç”¨ä¸åŒé¢œè‰²çš„xè¡¨ç¤ºï¼›( b )æ­¥éª¤å¼€å§‹è¿›è¡Œèšç±»ï¼ŒæŠŠç‚¹åˆ†é…åˆ°æœ€è¿‘çš„è´¨å¿ƒæ‰€åœ¨çš„ç»„ï¼›( c )æ­¥éª¤é‡æ–°è®¡ç®—æ¯ä¸ªç¾¤ç»„çš„è´¨å¿ƒï¼Œä½ ä¼šå‘ç°xçš„ä½ç½®å‘ç”Ÿäº†æ”¹å˜ã€‚ä¹‹åå°±æ˜¯å¦‚æ­¤é‡å¤ï¼Œè¿›å…¥ä¸‹ä¸€è½®èšç±»ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒKå‡å€¼ç®—æ³•æ˜¯é€šè¿‡ä¸æ–­è¿­ä»£ã€è°ƒæ•´Kä¸ªèšç±»è´¨å¿ƒçš„ç®—æ³•ã€‚è€Œè´¨å¿ƒæˆ–è€…ç¾¤ç»„çš„ä¸­å¿ƒç‚¹ï¼Œæ˜¯é€šè¿‡æ±‚ç¾¤ç»„æ‰€åŒ…å«çš„æˆå‘˜ä¹‹å¹³å‡å€¼æ¥è®¡ç®—çš„ã€‚</p><h2>ä½¿ç”¨å‘é‡ç©ºé—´è¿›è¡Œèšç±»</h2><p>æ˜ç™½äº†Kå‡å€¼èšç±»ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼Œå†æ¥ç†è§£å‘é‡ç©ºé—´æ¨¡å‹åœ¨å…¶ä¸­çš„è¿ç”¨å°±ä¸éš¾äº†ã€‚æˆ‘è¿˜æ˜¯ä»¥æ–‡æœ¬èšç±»ä¸ºä¾‹ï¼Œè®²è®²å¦‚ä½•ä½¿ç”¨å‘é‡ç©ºé—´æ¨¡å‹å’Œèšç±»ç®—æ³•ï¼Œå»é™¤é‡å¤çš„æ–°é—»ã€‚</p><p>æˆ‘ä»¬åœ¨çœ‹æ–°é—»çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½å¸Œæœ›ä¸æ–­çœ‹åˆ°æ–°çš„å†…å®¹ã€‚å¯æ˜¯ï¼Œç”±äºç°åœ¨çš„æŠ¥é“æ¸ é“éå¸¸ä¸°å¯Œï¼Œç»å¸¸ä¼šå‡ºç°çƒ­ç‚¹æ–°é—»éœ¸å ç‰ˆé¢çš„æƒ…å†µã€‚å‡å¦‚æˆ‘ä»¬ä¸æƒ³æ€»æ˜¯çœ‹åˆ°é‡å¤çš„æ–°é—»ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰ä¸€ç§åšæ³•å°±æ˜¯å¯¹æ–°é—»è¿›è¡Œèšç±»ï¼Œé‚£ä¹ˆå†…å®¹éå¸¸ç±»ä¼¼çš„æ–‡ç« å°±ä¼šè¢«èšåˆ°åŒä¸€ä¸ªåˆ†ç»„ï¼Œç„¶åå¯¹æ¯ä¸ªåˆ†ç»„æˆ‘ä»¬åªé€‰æ‹©1åˆ°2ç¯‡æ˜¾ç¤ºå°±å¤Ÿäº†ã€‚</p><p>åŸºæœ¬æ€è·¯ç¡®å®šåï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªæ–¹æ³•åˆ†ä¸ºä¸‰ä¸ªä¸»è¦æ­¥éª¤ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼ŒæŠŠæ–‡æ¡£é›†åˆéƒ½è½¬æ¢æˆå‘é‡çš„å½¢å¼ã€‚è¿™å—æˆ‘ä¸Šä¸€èŠ‚è®²è¿‡äº†ï¼Œä½ è¦æ˜¯ä¸è®°å¾—äº†ï¼Œå¯ä»¥è‡ªå·±å›å»å¤ä¹ ä¸€ä¸‹ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨Kå‡å€¼ç®—æ³•å¯¹æ–‡æ¡£é›†åˆè¿›è¡Œèšç±»ã€‚è¿™ä¸ªç®—æ³•çš„å…³é”®æ˜¯å¦‚ä½•ç¡®å®šæ•°æ®å¯¹è±¡å’Œåˆ†ç»„è´¨å¿ƒä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚é’ˆå¯¹è¿™ç‚¹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªç‚¹éœ€è¦å…³æ³¨ã€‚</p><ul>
<li>
<p>ä½¿ç”¨å‘é‡ç©ºé—´ä¸­çš„è·ç¦»æˆ–è€…å¤¹è§’ä½™å¼¦åº¦é‡ï¼Œè®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç›¸ä¼¼åº¦ã€‚</p>
</li>
<li>
<p>è®¡ç®—è´¨å¿ƒçš„å‘é‡ã€‚Kå‡å€¼é‡Œï¼Œè´¨å¿ƒæ˜¯åˆ†ç»„é‡Œæˆå‘˜çš„å¹³å‡å€¼ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ±‚åˆ†ç»„é‡Œæ‰€æœ‰æ–‡æ¡£å‘é‡çš„å¹³å‡å€¼ã€‚æ±‚æ³•éå¸¸ç›´è§‚ï¼Œå°±æ˜¯åˆ†åˆ«ä¸ºæ¯ç»´åˆ†é‡æ±‚å¹³å‡å€¼ï¼Œæˆ‘æŠŠå…·ä½“çš„è®¡ç®—å…¬å¼åˆ—åœ¨è¿™é‡Œï¼š</p>
</li>
</ul><p><img src="https://static001.geekbang.org/resource/image/7f/43/7f47f218d42e6d33b4af132c6d536543.png?wh=274*114" alt=""></p><p>å…¶ä¸­ï¼Œ$x_{i}$è¡¨ç¤ºå‘é‡çš„ç¬¬iä¸ªåˆ†é‡ï¼Œ$x_{ij}$è¡¨ç¤ºç¬¬jä¸ªå‘é‡çš„ç¬¬$i$ä¸ªåˆ†é‡ï¼Œè€Œ$j=1,2,â€¦,n$è¡¨ç¤ºå±äºæŸä¸ªåˆ†ç»„çš„æ‰€æœ‰å‘é‡ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œåœ¨æ¯ä¸ªåˆ†ç±»ä¸­ï¼Œé€‰å‡ºå’Œè´¨å¿ƒæœ€æ¥è¿‘çš„å‡ ç¯‡æ–‡ç« ä½œä¸ºä»£è¡¨ã€‚è€Œå…¶ä»–çš„æ–‡ç« ä½œä¸ºå†—ä½™çš„å†…å®¹è¿‡æ»¤æ‰ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä½¿ç”¨Pythoné‡Œçš„sklearnåº“ï¼Œæ¥å±•ç¤ºä½¿ç”¨æ¬§æ°è·ç¦»çš„Kå‡å€¼ç®—æ³•ã€‚</p><h2>Pythonä¸­çš„Kå‡å€¼ç®—æ³•</h2><p>åœ¨å°è¯•ä¸‹é¢çš„ä»£ç ä¹‹å‰ï¼Œä½ éœ€è¦çœ‹çœ‹è‡ªå·±çš„æœºå™¨ä¸Šæ˜¯ä¸æ˜¯å·²ç»å®‰è£…äº†scikit-learnã€‚Scikit-learnæ˜¯Pythonå¸¸ç”¨çš„æœºå™¨å­¦ä¹ åº“ï¼Œå®ƒæä¾›äº†å¤§é‡çš„æœºå™¨å­¦ä¹ ç®—æ³•çš„å®ç°å’Œç›¸å…³çš„æ–‡æ¡£ï¼Œç”šè‡³è¿˜å†…ç½®äº†ä¸€äº›å…¬å¼€æ•°æ®é›†ï¼Œæ˜¯æˆ‘ä»¬å®è·µæœºå™¨å­¦ä¹ ç®—æ³•çš„å¥½å¸®æ‰‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä½¿ç”¨sklearnåº“ä¸­çš„CountVectorizerï¼Œå¯¹ä¸€ä¸ªæµ‹è¯•çš„æ–‡æ¡£é›†åˆæ„å»ºç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯è¯å…¸ã€‚è¿™ä¸ªæµ‹è¯•é›†åˆæœ‰7å¥è¯ï¼Œ2å¥å…³äºç¯®çƒï¼Œ2å¥å…³äºç”µå½±ï¼Œè¿˜æœ‰3å¥å…³äºæ¸¸æˆã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>from sklearn.feature_extraction.text import CountVectorizer

#æ¨¡æ‹Ÿæ–‡æ¡£é›†åˆ
corpus = ['I like great basketball game',
          'This video game is the best action game I have ever played',
          'I really really like basketball',
          'How about this movie? Is the plot great?',
          'Do you like RPG game?',
          'You can try this FPS game',
          'The movie is really great, so great! I enjoy the plot']

#æŠŠæ–‡æœ¬ä¸­çš„è¯è¯­è½¬æ¢ä¸ºè¯å…¸å’Œç›¸åº”çš„å‘é‡
vectorizer = CountVectorizer()
vectors = vectorizer.fit_transform(corpus)

#è¾“å‡ºæ‰€æœ‰çš„è¯æ¡ï¼ˆæ‰€æœ‰ç»´åº¦çš„ç‰¹å¾ï¼‰
print('æ‰€æœ‰çš„è¯æ¡ï¼ˆæ‰€æœ‰ç»´åº¦çš„ç‰¹å¾ï¼‰')
print(vectorizer.get_feature_names())
print('\n')

#è¾“å‡º(æ–‡ç« ID, è¯æ¡ID) è¯é¢‘
print('(æ–‡ç« ID, è¯æ¡ID) è¯é¢‘')
print(vectors)
print('\n')
</code></pre><p>ä»è¿è¡Œçš„ç»“æœä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªè¯å…¸é‡ŒåŒ…å«äº†å“ªäº›è¯ï¼Œä»¥åŠæ¯ä¸ªè¯åœ¨æ¯ä¸ªæ–‡æ¡£é‡Œçš„è¯é¢‘ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ¯”è¯é¢‘tfæ›´å¥½çš„tf-idfæœºåˆ¶ï¼ŒTfidfTransformerå¯ä»¥å¸®åŠ©æˆ‘ä»¬åšåˆ°è¿™ç‚¹ï¼Œä»£ç å’Œæ³¨é‡Šå¦‚ä¸‹ï¼š</p><pre><code>from sklearn.feature_extraction.text import TfidfTransformer

#æ„å»ºtfidfçš„å€¼
transformer = TfidfTransformer()
tfidf = transformer.fit_transform(vectorizer.fit_transform(corpus))

# è¾“å‡ºæ¯ä¸ªæ–‡æ¡£çš„å‘é‡
tfidf_array = tfidf.toarray()
words = vectorizer.get_feature_names()

for i in range(len(tfidf_array)):
    print (&quot;*********ç¬¬&quot;, i + 1, &quot;ä¸ªæ–‡æ¡£ä¸­ï¼Œæ‰€æœ‰è¯è¯­çš„tf-idf*********&quot;)
    # è¾“å‡ºå‘é‡ä¸­æ¯ä¸ªç»´åº¦çš„å–å€¼
    for j in range(len(words)):
        print(words[j], ' ', tfidf_array[i][j])
    print('\n')
</code></pre><p>è¿è¡Œçš„ç»“æœå±•ç¤ºäº†æ¯ä¸ªæ–‡æ¡£ä¸­ï¼Œæ¯ä¸ªè¯çš„tfidfæƒé‡ï¼Œä½ å¯ä»¥è‡ªå·±æ‰‹åŠ¨éªŒç®—ä¸€ä¸‹ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡ŒKå‡å€¼èšç±»äº†ã€‚ç”±äºæœ‰ç¯®çƒã€ç”µå½±å’Œæ¸¸æˆ3ä¸ªç±»åˆ«ï¼Œæˆ‘é€‰æ‹©çš„Kæ˜¯3ï¼Œå¹¶åœ¨KMeansçš„æ„é€ å‡½æ•°ä¸­è®¾ç½®n_clustersä¸º3ã€‚</p><pre><code>from sklearn.cluster import KMeans

#è¿›è¡Œèšç±»ï¼Œåœ¨æˆ‘è¿™ä¸ªç‰ˆæœ¬é‡Œé»˜è®¤ä½¿ç”¨çš„æ˜¯æ¬§æ°è·ç¦»
clusters = KMeans(n_clusters=3)
s = clusters.fit(tfidf_array)

#è¾“å‡ºæ‰€æœ‰è´¨å¿ƒç‚¹ï¼Œå¯ä»¥çœ‹åˆ°è´¨å¿ƒç‚¹çš„å‘é‡æ˜¯ç»„å†…æˆå‘˜å‘é‡çš„å¹³å‡å€¼
print('æ‰€æœ‰è´¨å¿ƒç‚¹çš„å‘é‡')
print(clusters.cluster_centers_)
print('\n')

#è¾“å‡ºæ¯ä¸ªæ–‡æ¡£æ‰€å±çš„åˆ†ç»„
print('æ¯ä¸ªæ–‡æ¡£æ‰€å±çš„åˆ†ç»„')
print(clusters.labels_)

#è¾“å‡ºæ¯ä¸ªåˆ†ç»„å†…çš„æ–‡æ¡£
dict = {}
for i in range(len(clusters.labels_)):
    label = clusters.labels_[i]
    if label not in dict.keys():
        dict[label] = []
        dict[label].append(corpus[i])
    else:
        dict[label].append(corpus[i])
print(dict)
</code></pre><p>ä¸ºäº†å¸®åŠ©ä½ çš„ç†è§£ï¼Œæˆ‘è¾“å‡ºäº†æ¯ä¸ªç¾¤ç»„çš„è´¨å¿ƒï¼Œä¹Ÿå°±æ˜¯å…¶ä¸­æˆå‘˜å‘é‡çš„å¹³å‡å€¼ã€‚æœ€åï¼Œæˆ‘ä¹Ÿè¾“å‡ºäº†3ä¸ªç¾¤ç»„ä¸­æ‰€åŒ…å«çš„å¥å­ã€‚åœ¨æˆ‘æœºå™¨ä¸Šçš„è¿è¡Œç»“æœæ˜¾ç¤ºï¼Œç³»ç»Ÿå¯ä»¥æŠŠå±äº3ä¸ªè¯é¢˜çš„å¥å­åŒºåˆ†å¼€æ¥ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>{2: ['I like great basketball game', 'I really really like basketball'], 0: ['This video game is the best action game I have ever played', 'Do you like RPG game?', 'You can try this FPS game'], 1: ['How about this movie? Is the plot great?', 'The movie is really great, so great! I enjoy the plot']}
</code></pre><p>ä¸è¿‡ï¼Œç”±äºKMeanså…·ä½“çš„å®ç°å¯èƒ½ä¸ä¸€æ ·ï¼Œè€Œä¸”åˆå§‹è´¨å¿ƒçš„é€‰æ‹©ä¹Ÿæœ‰ä¸€å®šéšæœºæ€§ï¼Œæ‰€ä»¥ä½ çœ‹åˆ°çš„ç»“æœå¯èƒ½ç¨æœ‰ä¸åŒã€‚</p><h2>æ€»ç»“</h2><p>è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»‹ç»äº†å¦‚ä½•åœ¨æœºå™¨å­¦ä¹ çš„èšç±»ç®—æ³•ä¸­ï¼Œä½¿ç”¨å‘é‡ç©ºé—´æ¨¡å‹ã€‚åœ¨èšç±»ä¸­ï¼Œæ•°æ®å¯¹è±¡ä¹‹é—´çš„ç›¸ä¼¼åº¦æ˜¯å¾ˆå…³é”®çš„ã€‚å¦‚æœæˆ‘ä»¬æŠŠæ ·æœ¬è½¬æ¢ä¸ºå‘é‡ï¼Œç„¶åä½¿ç”¨å‘é‡ç©ºé—´ä¸­çš„è·ç¦»æˆ–è€…å¤¹è§’ä½™å¼¦ï¼Œå°±å¾ˆè‡ªç„¶çš„èƒ½è·å¾—è¿™ç§ç›¸ä¼¼åº¦ï¼Œæ‰€ä»¥å‘é‡ç©ºé—´æ¨¡å‹å’Œèšç±»ç®—æ³•å¯ä»¥å¾ˆå®¹æ˜“çš„ç»“åˆåœ¨ä¸€èµ·ã€‚</p><p>ä¸ºäº†ç»™ä½ åŠ æ·±å°è±¡ï¼Œæˆ‘ä»‹ç»äº†ä¸€ä¸ªå…·ä½“çš„Kå‡å€¼ç®—æ³•ï¼Œä»¥åŠå‘é‡ç©ºé—´æ¨¡å‹åœ¨å…¶ä¸­æ‰€èµ·åˆ°çš„ä½œç”¨ï¼Œå¹¶é€šè¿‡Pythonçš„sklearnä»£ç æ¼”ç¤ºäº†å‡ ä¸ªå…³é”®çš„æ­¥éª¤ã€‚</p><p>å‘é‡ç©ºé—´æ¨¡å‹å’ŒKå‡å€¼ç®—æ³•çš„ç»“åˆï¼Œè™½ç„¶ç®€å•æ˜“æ‡‚ï¼Œä½†æ˜¯ä¸€å¼€å§‹æ€æ ·é€‰æ‹©è¿™ä¸ªç¾¤ç»„çš„æ•°é‡ï¼Œæ˜¯ä¸ªå…³é”®é—®é¢˜ã€‚æˆ‘ä»Šå¤©æ¼”ç¤ºçš„æµ‹è¯•æ•°æ®å¾ˆå°ï¼Œè€Œä¸”ä¸»é¢˜åˆ’åˆ†çš„ä¹Ÿéå¸¸æ˜æ˜¾ã€‚æ‰€ä»¥æˆ‘é€‰æ‹©èšç±»çš„æ•°é‡ä¸º3ã€‚</p><p>å¯æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¯¹äºä¸€ä¸ªæ–°çš„æ•°æ®é›†åˆï¼Œé€‰æ‹©å¤šå°‘æ¯”è¾ƒåˆé€‚å‘¢ï¼Ÿå¦‚æœè¿™ä¸ªKå€¼å–å¾—å¤ªå¤§ï¼Œç¾¤ç»„å¯èƒ½åˆ‡åˆ†å¤ªç»†ï¼Œæ¯ä¸ªä¹‹é—´åŒºåˆ«ä¸å¤§ã€‚å¦‚æœKå€¼å–å¾—å¤ªå°ï¼Œç¾¤ç»„çš„ç²’åº¦åˆå¤ªç²—ï¼Œé€ æˆç¾¤ç»„å†…å·®å¼‚æ¯”è¾ƒæ˜æ˜¾ã€‚å¯¹éç›‘ç£å¼çš„å­¦ä¹ æ¥è¯´ï¼Œè¿™ä¸ªå‚æ•°ç¡®å®éš¾ä»¥å¾—åˆ°å‡†ç¡®é¢„ä¼°ã€‚æˆ‘ä»¬å¯ä»¥äº‹å…ˆåœ¨ä¸€ä¸ªè¾ƒå°çš„æ•°æ®é›†åˆä¸Šè¿›è¡Œå°è¯•ï¼Œç„¶åæ ¹æ®ç»“æœå’Œåº”ç”¨åœºæ™¯ç¡®å®šä¸€ä¸ªç»éªŒå€¼ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä»Šå¤©æˆ‘ä½¿ç”¨çš„æ˜¯sklearné‡Œçš„KMeansåŒ…ï¼Œå®ƒä½¿ç”¨äº†å‘é‡é—´çš„æ¬§æ°è·ç¦»æ¥è¿›è¡Œèšç±»ã€‚ä½ å¯ä»¥å°è¯•å®ç°è‡ªå·±çš„Kå‡å€¼èšç±»ï¼Œå¹¶ä½¿ç”¨å‘é‡é—´çš„å¤¹è§’ä½™å¼¦ä½œä¸ºç›¸ä¼¼åº¦çš„åº¦é‡ã€‚</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå†™ä¸‹ä»Šå¤©çš„å­¦ä¹ ç¬”è®°ã€‚ä½ å¯ä»¥ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ çš„å¥½å‹ï¼Œå’Œä»–ä¸€èµ·ç²¾è¿›ã€‚</p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/6a/8e/7b6ea886.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Joe</span>
  </div>
  <div class="_2_QraFYR_0">def customKmeans(vec_array, n_clusters=3, epochs=50):<br>    &#39;&#39;&#39;<br>    @description: æ‰‹åŠ¨å®ç°kmeansï¼Œä»¥å‘é‡é—´çš„å¤¹è§’ä½™å¼¦ä½œä¸ºç›¸ä¼¼åº¦<br>                 æ ¹æ®ä¸Šè¿°tf-idfå¾—åˆ°çš„7æ¡æ–‡æœ¬å‘é‡tfidf_arrayï¼Œè¿›è¡Œèšç±»ç®—æ³•<br>    @param {type} vec_array- å‘é‡ç»„, n_clusters-èšç±»æ•°ç›®, epochs- è®­ç»ƒæ¬¡æ•°<br>    @return: cluster_labels- åˆ†ç±»æ ‡ç­¾<br>    &#39;&#39;&#39;<br><br>    # åˆå§‹åŒ–è´¨å¿ƒçš„ä½ç½®<br>    cluster_centers = []<br>    cluster_centers_indx = []<br>    while (len(cluster_centers_indx) &lt; n_clusters):<br>        indx = random.randint(0, len(vec_array)-1)<br>        if indx not in cluster_centers_indx:<br>            cluster_centers_indx.append(indx)<br>            cluster_centers.append(vec_array[indx])<br><br>    # åˆå§‹åŒ–å‘é‡ç±»åˆ«<br>    cluster_labels = [0] * len(vec_array)<br>    max_similarity = [-1] * len(vec_array)<br>    epoch = 0<br>    while(epoch &lt; epochs):<br>        # è®¡ç®—æ¯ä¸ªå‘é‡ä¸è´¨å¿ƒçš„ç›¸ä¼¼æ€§ï¼Œå¹¶å°†å…¶å½’çº³åˆ°æœ€è¿‘çš„è´¨å¿ƒé›†ç¾¤ä¸­<br>        for i in range(0, len(vec_array)):<br>            max_similarity[i] = computeCosine(vec_array[i], cluster_centers[0])<br>            for j in range(1, n_clusters):<br>                temp = computeCosine(vec_array[i], cluster_centers[j])<br>                if (temp &gt; max_similarity[i]):<br>                    max_similarity[i] = temp<br>                    cluster_labels[i] = j<br><br>        # æ›´æ–°è´¨å¿ƒä½ç½®<br>        for i in range(0, n_clusters):<br>            # æ‰¾åˆ°é›†ç¾¤å¯¹åº”åŸå‘é‡çš„ä¸‹æ ‡<br>            indxs = [indx for indx, cluster in enumerate(<br>                cluster_labels) if cluster == i]<br>            # æ ¹æ®é›†ç¾¤å‘é‡çš„å¹³å‡å€¼æ›´æ–°è´¨ç‚¹ä½ç½®<br>            cluster_centers[i] = np.average(<br>                [vec_array[indx] for indx in indxs], axis=0)<br><br>        # å½“æ»¡è¶³è¿­ä»£æ¬¡æ•°æˆ–å¹³å‡æœ€å¤§ç›¸ä¼¼æ€§æ—¶é€€å‡ºç®—æ³•<br>        epoch += 1<br>        if (np.average(max_similarity) &gt; 0.9):<br>            break<br>    return cluster_labels<br><br><br>def computeCosine(vec1, vec2):<br>    # è®¡ç®—å‘é‡é—´çš„ä½™å¼¦å€¼<br>    vecCosine = np.dot(vec1, vec2) &#47; \<br>        (np.linalg.norm(vec1) * np.linalg.norm(vec2))<br>    return vecCosine<br><br><br># åº”ç”¨customkmeans<br>labels = customKmeans(tfidf_array, n_clusters=3, epochs=1000)<br>print(labels)<br><br>è¾“å‡ºç»“æœï¼š<br>[0 2 0 1 2 2 1]</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-03-15 11:18:44</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>mickey</span>
  </div>
  <div class="_2_QraFYR_0"># encoding=utf-8<br>from sklearn.feature_extraction.text import CountVectorizer<br><br>#æ¨¡æ‹Ÿæ–‡æ¡£é›†åˆ<br>corpus = [&#39;I like great basketball game&#39;,<br>          &#39;This video game is the best action game I have ever played&#39;,<br>          &#39;I really really like basketball&#39;,<br>          &#39;How about this movie? Is the plot great?&#39;,<br>          &#39;Do you like RPG game?&#39;,<br>          &#39;You can try this FPS game&#39;,<br>          &#39;The movie is really great, so great! I enjoy the plot&#39;]<br><br>#æŠŠæ–‡æœ¬ä¸­çš„è¯è¯­è½¬æ¢ä¸ºè¯å…¸å’Œç›¸åº”çš„å‘é‡<br>vectorizer = CountVectorizer()<br>vectors = vectorizer.fit_transform(corpus)<br><br>from sklearn.feature_extraction.text import TfidfTransformer<br><br>#æ„å»ºtfidfçš„å€¼<br>transformer = TfidfTransformer()<br>tfidf = transformer.fit_transform(vectorizer.fit_transform(corpus))<br><br># è¾“å‡ºæ¯ä¸ªæ–‡æ¡£çš„å‘é‡<br>tfidf_array = tfidf.toarray()<br>words = vectorizer.get_feature_names()<br><br>from Bio.Cluster import kcluster<br><br>#è¿›è¡Œèšç±»ï¼Œä½¿ç”¨å‘é‡é—´çš„å¤¹è§’ä½™å¼¦ä½œä¸ºç›¸ä¼¼åº¦çš„åº¦é‡<br>clusterid, error, nfound  = kcluster(tfidf_array, nclusters=3, dist=&#39;u&#39;)<br>print(clusterid)<br>&#39;&#39;&#39;<br>Kmeans çš„æ¬§å¼è·ç¦»:[0 2 0 1 2 2 1]<br>Bio çš„å¤¹è§’ä½™å¼¦:[2 0 0 2 0 2 1]<br>&#39;&#39;&#39;</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å°è¯•äº†ä¸åŒçš„æ–¹æ³•ğŸ‘</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-03-08 11:29:55</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4e/c7/8c2d0a3d.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ä½™æ³½é”‹</span>
  </div>
  <div class="_2_QraFYR_0">è¯·é—®ä¸€ä¸‹è€å¸ˆï¼Œä½™å¼¦å¤¹è§’æœ¬è´¨ä¸Šå¯ä»¥è¯´æ˜¯å½’ä¸€åŒ–çš„æ¬§å¼è·ç¦»ä¹ˆï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¯ä»¥è¿™ä¹ˆè®¤ä¸º</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-04-09 14:15:14</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/1d/42/df/a034455d.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ç½—è€€é¾™@åå¿˜</span>
  </div>
  <div class="_2_QraFYR_0">èŒ¶è‰ºå¸ˆå­¦ç¼–ç¨‹<br><br>Kâ€”Meansç®—æ³•ï¼Œç»™æˆ‘çš„æ„Ÿè§‰ï¼Œå°±åƒæ˜¯åœ¨é“ºæ»¡é“å±‘çš„çº¸ä¸Šæ”¾å‡ ä¸ªç£é“ï¼Œé™„è¿‘çš„é“å±‘ä¼šå¸è¿‡æ¥ã€‚<br><br>å‘é‡ç©ºé—´æ¨¡å‹åˆ™æ˜¯æ¢ä¸Šæ›´å¼ºåŠ›çš„â€œç£é“â€ã€‚<br><br>â€¦â€¦<br><br>â€œä»€ä¹ˆè¿˜æœ‰æ²¡æœ‰å¸è¿‡æ¥çš„é“å±‘ï¼Œé‚£å°±ä¸ç”¨ç®¡äº†â€</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-04-28 14:40:06</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/6a/8e/7b6ea886.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Joe</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œç°åœ¨å¾ˆå¤šæœºå™¨å­¦ä¹ çš„ç®—æ³•éƒ½æœ‰ç°æˆçš„åº“äº†ï¼Œå¦‚sklearnç­‰ã€‚ä½†æ˜¯ç›´æ¥è°ƒåº“ï¼Œæ€»è§‰å¾—åœç•™åœ¨è¡¨é¢ã€‚è¯·é—®æœ‰æ²¡æœ‰å¿…è¦è‡ªå·±æ‰‹åŠ¨å»å®ç°ä¸€äº›ç»å…¸çš„æœºå™¨å­¦ä¹ ç®—æ³•å‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: è¿™æ˜¯ä¸€ä¸ªå¥½é—®é¢˜ï¼Œå¯ä»¥å‚ç…§ä¸“æ ä¸­çš„ä¸€äº›ä»‹ç»ï¼Œå°è¯•å®ç°æŸäº›ç®—æ³•ï¼ŒåŠ å¼ºå°è±¡ï¼Œç”šè‡³äºå°†æ¥å¯ä»¥æ ¹æ®å…·ä½“çš„åº”ç”¨ï¼Œå¯¹ç®—æ³•å®ç°è¿›è¡Œä¼˜åŒ–ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-03-14 22:54:48</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/91/00/2007d2f3.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>zhengfan</span>
  </div>
  <div class="_2_QraFYR_0">é»„è€å¸ˆæ‚¨å¥½ã€‚<br>æ‚¨åœ¨kå‡å€¼ç®—æ³•ä»‹ç»åé™„çš„å›¾ç¤ºï¼Œä¼¼ä¹å‘ˆç°å‡ºâ€œæ°å·§æŠŠåˆé€‰è´¨å¿ƒç‚¹é€‰åœ¨äº†ä¸åŒç¾¤ç»„ä¸­â€çš„æ•ˆæœã€‚è€Œä½œä¸ºkå‡å€¼ç®—æ³•çš„ç¬¬ä¸€æ­¥ï¼Œæœ€åˆè´¨å¿ƒçš„é€‰æ‹©æ˜¯å®Œå…¨éšæœºçš„ã€‚ä¹Ÿå°±æ˜¯å¾ˆæœ‰å¯èƒ½è¿™äº›åˆé€‰è´¨å¿ƒæ˜¯åœ¨åŒä¸€ä¸ªç¾¤ç»„ä¸­ã€‚è¯·é—®è¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¾ˆå¥½çš„é—®é¢˜ï¼Œä½œä¸ºéç›‘ç£å¼å­¦ä¹ ï¼Œè¿™æ˜¯ä¸ªå¾ˆå¤§çš„ç¼ºé™·ï¼Œå®é™…è¿ç”¨ä¸­é€šå¸¸è¯•éªŒä¸åŒçš„åˆå§‹å€¼ï¼Œæˆ–è€…é‡‡ç”¨å±‚æ¬¡åŒ–èšç±»ï¼Œå…ˆç»†åˆ†å¾ˆå¤šå°çš„ç±»ï¼Œç„¶åæ ¹æ®ç›¸ä¼¼åº¦è¿›è¡Œèšé›†</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-06-02 23:19:41</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Paul Shan</span>
  </div>
  <div class="_2_QraFYR_0">kmeansæ–¹æ³•ç”¨çš„æ˜¯åˆ©ç”¨å‡ ä½•ä¿¡æ¯å°†ç©ºé—´ç‚¹å½’ç±»çš„æ–¹æ³•ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯å½’å¥½ç±»çš„ç‚¹é›†è´¨å¿ƒä¹‹é—´çš„è·ç¦»è¿œï¼Œä½†æ˜¯é›†åˆå†…ç‚¹ä¹‹é—´è·ç¦»è¿‘çš„æ•ˆæœï¼Œå¯ä»¥ç±»æ¯”äºè½¯ä»¶å¼€å‘ä¸­çš„é«˜å†…èšä½è€¦åˆåŸåˆ™æ¥è®°å¿†ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å—¯ï¼Œè¿™ä¸ªæ¯”å–»å¥½ğŸ‘</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-26 05:42:06</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/ba/c5/bf9b71a9.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>BindyğŸŒ²</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œè¿™é‡Œå¦‚æœæ˜¯ä¸­æ–‡ï¼Œæ˜¯ä¸æ˜¯è¦åšåˆ†è¯å‘¢</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æ˜¯çš„ï¼Œå¦‚æœæ˜¯ä¸­æ–‡ï¼Œè‚¯å®šè¦åšåˆ†è¯çš„ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-04-10 09:16:53</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>013923</span>
  </div>
  <div class="_2_QraFYR_0">Keep fitï¼›Study wellï¼Œand Work hardï¼</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-09-14 12:57:30</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å»ºå¼º</span>
  </div>
  <div class="_2_QraFYR_0">æˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªç”¨å‘é‡å¤¹è§’çš„ä½™å¼¦åšèšç±»çš„ç®—æ³•ï¼Œä½†ä¸è®ºæ€ä¹ˆè°ƒæ•´ï¼Œèšç±»ç»“æœå’Œæ¬§æ°è·ç¦»ç®—æ³•éƒ½ä¸ä¸€æ ·ï¼Œæ˜¯ä¸æ˜¯å’Œåˆå§‹è´¨å¿ƒé€‰æ‹©æœ‰å…³ï¼Œè¿˜æ˜¯ç¨‹åºä¸­çš„ç®—æ³•æœ‰é—®é¢˜ï¼Œéœ€è¦è¯·æ•™è€å¸ˆï¼Œç¯‡å¹…æœ‰é™ï¼Œéƒ¨åˆ†ç¨‹åºä»£ç å¦‚ä¸‹ï¼š<br><br>    # ç”¨æ ·æœ¬æ‹Ÿåˆèšç±»ç®—æ³•æ¨¡å‹<br>    def fit(self, sample_matrix):<br>        #æ£€æŸ¥åˆ†ç±»ä¸ªæ•°æ˜¯å¦å¤§äºå¾…åˆ†ç±»çš„æ ·æœ¬æ•°<br>        if self.n_clusters &gt; len(sample_matrix):<br>            raise ValueError(&#39;cluster numbers must less than or equal to sample numbers&#39;)<br>        <br>        # åˆå§‹åŒ–è´¨å¿ƒï¼Œå–å‰nä¸ªæ ·æœ¬çš„å‘é‡ä½œä¸ºè´¨å¿ƒ<br>        self.cluster_centers_ = np.array([sample_matrix[0]])<br>        for j in range(1, self.n_clusters):<br>            self.cluster_centers_ = np.r_[self.cluster_centers_, [sample_matrix[j]]]<br>        # è¿­ä»£è®¡ç®—å„æ ·æœ¬ä¸è´¨å¿ƒçš„å¤¹è§’ï¼Œå¹¶æ›´æ–°åˆ†ç»„ï¼Œç›´åˆ°æ–°è´¨å¿ƒä¸æ—§è´¨å¿ƒä¹‹é—´çš„å·®è·å°äºæŒ‡å®šç²¾åº¦<br>        k = 0<br>        cluster = {}<br>        while True:<br>            cluster.clear()<br>            for i in range(len(sample_matrix)):<br>                max_cos = 0<br>                nearest_label = None<br>                for j in range(self.n_clusters):<br>                    cos = self.__cos(sample_matrix[i],self.cluster_centers_[j])<br>                    if max_cos &lt; cos:<br>                        max_cos = cos<br>                        nearest_label = j<br>                cluster.setdefault(nearest_label,[])<br>                cluster[nearest_label].append(i)<br>            <br>            #ä¿å­˜è€çš„è´¨å¿ƒï¼Œè®¡ç®—æ–°çš„è´¨å¿ƒ<br>            old_cluster_centers = self.cluster_centers_.copy()<br>            for j in range(self.n_clusters):<br>                self.cluster_centers_[j] = 0<br>                for i in cluster[j]:<br>                    self.cluster_centers_[j] += sample_matrix[i]<br>                self.cluster_centers_[j] = self.cluster_centers_[j] &#47; len(cluster[j])<br>            # ç”¨æ–¹å·®æ¯”è¾ƒæ–°è€è´¨å¿ƒä¹‹é—´çš„å·®è·<br>            if self.__variance(self.cluster_centers_, old_cluster_centers) &lt;= self.precision:<br>                break;<br>            k+=1<br>        # æ ¹æ®è®¡ç®—ç»“æœç»™æ ·æœ¬å½’ç±»<br>        self.labels_ = list(&#39;0&#39; * len(sample_matrix))<br>        for j in range(self.n_clusters):<br>            for i in cluster[j]:<br>                self.labels_[i] = j<br>        self.labels_ = np.array(self.labels_)<br> =================èšç±»ç»“æœ==========<br>æ¯ä¸ªæ–‡æ¡£æ‰€å±çš„åˆ†ç»„<br>[0 1 2 1 0 1 0]</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä»ç¨‹åºç‰‡æ®µçœ‹ï¼Œé€»è¾‘ä¸Šæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå¯èƒ½æ˜¯å’Œåˆå§‹è´¨å¿ƒçš„é€‰å–æœ‰å…³ï¼Œå¦å¤–æ¬§æ°è·ç¦»å’Œä½™å¼¦å¤¹è§’ä¹Ÿå¯èƒ½å¯¼è‡´ç»“æœçš„ä¸åŒï¼Œå› ä¸ºä½™å¼¦å¤¹è§’ç›¸å½“äºåšäº†å½’ä¸€åŒ–</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-09-23 23:21:09</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Eleven</span>
  </div>
  <div class="_2_QraFYR_0">çœ‹åˆ°è¿™é‡Œå°±æœ‰ç‚¹åƒåŠ›äº†ï¼Œå·¥ä½œä¸­æ²¡æœ‰æ¶‰åŠåˆ°è¿™å—ä¸œè¥¿...</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: åšæŒå°±ä¼šæœ‰æ”¶è·</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-06-28 22:10:35</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>éª‘è¡Œçš„æŒæŸœJ</span>
  </div>
  <div class="_2_QraFYR_0">æˆ‘è¿™é‡Œå‘é‡é—´ä½¿ç”¨æ¬§å¼è·ç¦»å¾—åˆ°çš„æ˜¯ï¼š[1 0 1 2 1 0 2]<br>è€Œå‘é‡é—´ç”¨å¤¹è§’ä½™å¼¦å¾—åˆ°çš„æ˜¯ï¼š[2 1 2 1 0 0 1]<br>scikit-learnæ²¡æœ‰ç›¸åº”çš„å¤¹è§’ä½™å¼¦åŒ…ï¼Œæ‰€ä»¥è¦ç”¨åé¢è¿™ä¸ªBiopythonã€‚<br>å»ºè®®å¤§å®¶å¯ä»¥å»Biopythonå®˜ç½‘çœ‹çœ‹ç›¸å…³ç”¨æ³•ï¼Œç”¨anacondaå®‰è£…Biopythonçš„æŒ‡ä»¤æ˜¯ ï¼š<br>conda install -c conda-forge biopython <br>è¿™æ˜¯ä¸­æ–‡æ–‡æ¡£åœ°å€ï¼šhttps:&#47;&#47;biopython-cn.readthedocs.io&#47;zh_CN&#47;latest&#47;cn&#47;chr15.html<br>è¿™æ˜¯è‹±æ–‡çš„ï¼šhttps:&#47;&#47;biopython.org&#47;wiki&#47;Download</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æ„Ÿè°¢æä¾›è¿™ä¹ˆå¤šä¿¡æ¯ç»™å¤§å®¶</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-06-19 13:52:41</div>
  </div>
</div>
</div>
</li>
</ul>