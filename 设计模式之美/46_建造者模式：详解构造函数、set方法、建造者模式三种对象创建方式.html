<audio title="46_å»ºé€ è€…æ¨¡å¼ï¼šè¯¦è§£æ„é€ å‡½æ•°ã€setæ–¹æ³•ã€å»ºé€ è€…æ¨¡å¼ä¸‰ç§å¯¹è±¡åˆ›å»ºæ–¹å¼" src="https://static001.geekbang.org/resource/audio/29/2e/29c4e8aaae344f12ee3c7090a19f4d2e.mp3" controls="controls"></audio> 
<p>ä¸Šä¸¤èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å·¥å‚æ¨¡å¼ï¼Œè®²äº†å·¥å‚æ¨¡å¼çš„åº”ç”¨åœºæ™¯ï¼Œå¹¶å¸¦ä½ å®ç°äº†ä¸€ä¸ªç®€å•çš„DIå®¹å™¨ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å†æ¥å­¦ä¹ å¦å¤–ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œ<strong>Builderæ¨¡å¼</strong>ï¼Œä¸­æ–‡ç¿»è¯‘ä¸º<strong>å»ºé€ è€…æ¨¡å¼</strong>æˆ–è€…<strong>æ„å»ºè€…æ¨¡å¼</strong>ï¼Œä¹Ÿæœ‰äººå«å®ƒ<strong>ç”Ÿæˆå™¨æ¨¡å¼</strong>ã€‚</p><p>å®é™…ä¸Šï¼Œå»ºé€ è€…æ¨¡å¼çš„åŸç†å’Œä»£ç å®ç°éå¸¸ç®€å•ï¼ŒæŒæ¡èµ·æ¥å¹¶ä¸éš¾ï¼Œéš¾ç‚¹åœ¨äºåº”ç”¨åœºæ™¯ã€‚æ¯”å¦‚ï¼Œä½ æœ‰æ²¡æœ‰è€ƒè™‘è¿‡è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼šç›´æ¥ä½¿ç”¨æ„é€ å‡½æ•°æˆ–è€…é…åˆsetæ–¹æ³•å°±èƒ½åˆ›å»ºå¯¹è±¡ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå‘¢ï¼Ÿå»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼éƒ½å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œé‚£å®ƒä»¬ä¸¤ä¸ªçš„åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p>è¯ä¸å¤šè¯´ï¼Œå¸¦ç€ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬å¼€å§‹ä»Šå¤©çš„å­¦ä¹ å§ï¼</p><h2>ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ</h2><p>åœ¨å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨newå…³é”®å­—è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°æ¥å®Œæˆã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼Œä»€ä¹ˆæƒ…å†µä¸‹è¿™ç§æ–¹å¼å°±ä¸é€‚ç”¨äº†ï¼Œå°±éœ€è¦é‡‡ç”¨å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå¯¹è±¡å‘¢ï¼Ÿä½ å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ï¼Œä¸‹é¢æˆ‘é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥å¸¦ä½ çœ‹ä¸€ä¸‹ã€‚</p><p>å‡è®¾æœ‰è¿™æ ·ä¸€é“è®¾è®¡é¢è¯•é¢˜ï¼šæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªèµ„æºæ± é…ç½®ç±»ResourcePoolConfigã€‚è¿™é‡Œçš„èµ„æºæ± ï¼Œä½ å¯ä»¥ç®€å•ç†è§£ä¸ºçº¿ç¨‹æ± ã€è¿æ¥æ± ã€å¯¹è±¡æ± ç­‰ã€‚åœ¨è¿™ä¸ªèµ„æºæ± é…ç½®ç±»ä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªæˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯å¯é…ç½®é¡¹ã€‚ç°åœ¨ï¼Œè¯·ä½ ç¼–å†™ä»£ç å®ç°è¿™ä¸ªResourcePoolConfigç±»ã€‚</p><!-- [[[read_end]]] --><p><img src="https://static001.geekbang.org/resource/image/21/59/21f970b7c0d6b5afa6aa09ca14f55059.jpg?wh=2463*936" alt=""></p><p>åªè¦ä½ ç¨å¾®æœ‰ç‚¹å¼€å‘ç»éªŒï¼Œé‚£å®ç°è¿™æ ·ä¸€ä¸ªç±»å¯¹ä½ æ¥è¯´å¹¶ä¸æ˜¯ä»¶éš¾äº‹ã€‚æœ€å¸¸è§ã€æœ€å®¹æ˜“æƒ³åˆ°çš„å®ç°æ€è·¯å¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚å› ä¸ºmaxTotalã€maxIdleã€minIdleä¸æ˜¯å¿…å¡«å˜é‡ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºResourcePoolConfigå¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡å¾€æ„é€ å‡½æ•°ä¸­ï¼Œç»™è¿™å‡ ä¸ªå‚æ•°ä¼ é€’nullå€¼ï¼Œæ¥è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼ã€‚</p><pre><code>public class ResourcePoolConfig {
  private static final int DEFAULT_MAX_TOTAL = 8;
  private static final int DEFAULT_MAX_IDLE = 8;
  private static final int DEFAULT_MIN_IDLE = 0;

  private String name;
  private int maxTotal = DEFAULT_MAX_TOTAL;
  private int maxIdle = DEFAULT_MAX_IDLE;
  private int minIdle = DEFAULT_MIN_IDLE;

  public ResourcePoolConfig(String name, Integer maxTotal, Integer maxIdle, Integer minIdle) {
    if (StringUtils.isBlank(name)) {
      throw new IllegalArgumentException(&quot;name should not be empty.&quot;);
    }
    this.name = name;

    if (maxTotal != null) {
      if (maxTotal &lt;= 0) {
        throw new IllegalArgumentException(&quot;maxTotal should be positive.&quot;);
      }
      this.maxTotal = maxTotal;
    }

    if (maxIdle != null) {
      if (maxIdle &lt; 0) {
        throw new IllegalArgumentException(&quot;maxIdle should not be negative.&quot;);
      }
      this.maxIdle = maxIdle;
    }

    if (minIdle != null) {
      if (minIdle &lt; 0) {
        throw new IllegalArgumentException(&quot;minIdle should not be negative.&quot;);
      }
      this.minIdle = minIdle;
    }
  }
  //...çœç•¥getteræ–¹æ³•...
}
</code></pre><p>ç°åœ¨ï¼ŒResourcePoolConfigåªæœ‰4ä¸ªå¯é…ç½®é¡¹ï¼Œå¯¹åº”åˆ°æ„é€ å‡½æ•°ä¸­ï¼Œä¹Ÿåªæœ‰4ä¸ªå‚æ•°ï¼Œå‚æ•°çš„ä¸ªæ•°ä¸å¤šã€‚ä½†æ˜¯ï¼Œå¦‚æœå¯é…ç½®é¡¹é€æ¸å¢å¤šï¼Œå˜æˆäº†8ä¸ªã€10ä¸ªï¼Œç”šè‡³æ›´å¤šï¼Œé‚£ç»§ç»­æ²¿ç”¨ç°åœ¨çš„è®¾è®¡æ€è·¯ï¼Œæ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¼šå˜å¾—å¾ˆé•¿ï¼Œä»£ç åœ¨å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ä¸Šéƒ½ä¼šå˜å·®ã€‚åœ¨ä½¿ç”¨æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å®¹æ˜“æé”™å„å‚æ•°çš„é¡ºåºï¼Œä¼ é€’è¿›é”™è¯¯çš„å‚æ•°å€¼ï¼Œå¯¼è‡´éå¸¸éšè”½çš„bugã€‚</p><pre><code>// å‚æ•°å¤ªå¤šï¼Œå¯¼è‡´å¯è¯»æ€§å·®ã€å‚æ•°å¯èƒ½ä¼ é€’é”™è¯¯
ResourcePoolConfig config = new ResourcePoolConfig(&quot;dbconnectionpool&quot;, 16, null, 8, null, false , true, 10, 20ï¼Œfalseï¼Œ true);
</code></pre><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•ä½ åº”è¯¥ä¹Ÿå·²ç»æƒ³åˆ°äº†ï¼Œé‚£å°±æ˜¯ç”¨set()å‡½æ•°æ¥ç»™æˆå‘˜å˜é‡èµ‹å€¼ï¼Œä»¥æ›¿ä»£å†—é•¿çš„æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬ç›´æ¥çœ‹ä»£ç ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚å…¶ä¸­ï¼Œé…ç½®é¡¹nameæ˜¯å¿…å¡«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°æ„é€ å‡½æ•°ä¸­è®¾ç½®ï¼Œå¼ºåˆ¶åˆ›å»ºç±»å¯¹è±¡çš„æ—¶å€™å°±è¦å¡«å†™ã€‚å…¶ä»–é…ç½®é¡¹maxTotalã€maxIdleã€minIdleéƒ½ä¸æ˜¯å¿…å¡«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡set()å‡½æ•°æ¥è®¾ç½®ï¼Œè®©ä½¿ç”¨è€…è‡ªä¸»é€‰æ‹©å¡«å†™æˆ–è€…ä¸å¡«å†™ã€‚</p><pre><code>public class ResourcePoolConfig {
  private static final int DEFAULT_MAX_TOTAL = 8;
  private static final int DEFAULT_MAX_IDLE = 8;
  private static final int DEFAULT_MIN_IDLE = 0;

  private String name;
  private int maxTotal = DEFAULT_MAX_TOTAL;
  private int maxIdle = DEFAULT_MAX_IDLE;
  private int minIdle = DEFAULT_MIN_IDLE;
  
  public ResourcePoolConfig(String name) {
    if (StringUtils.isBlank(name)) {
      throw new IllegalArgumentException(&quot;name should not be empty.&quot;);
    }
    this.name = name;
  }

  public void setMaxTotal(int maxTotal) {
    if (maxTotal &lt;= 0) {
      throw new IllegalArgumentException(&quot;maxTotal should be positive.&quot;);
    }
    this.maxTotal = maxTotal;
  }

  public void setMaxIdle(int maxIdle) {
    if (maxIdle &lt; 0) {
      throw new IllegalArgumentException(&quot;maxIdle should not be negative.&quot;);
    }
    this.maxIdle = maxIdle;
  }

  public void setMinIdle(int minIdle) {
    if (minIdle &lt; 0) {
      throw new IllegalArgumentException(&quot;minIdle should not be negative.&quot;);
    }
    this.minIdle = minIdle;
  }
  //...çœç•¥getteræ–¹æ³•...
}
</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹æ–°çš„ResourcePoolConfigç±»è¯¥å¦‚ä½•ä½¿ç”¨ã€‚æˆ‘å†™äº†ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æ²¡æœ‰äº†å†—é•¿çš„å‡½æ•°è°ƒç”¨å’Œå‚æ•°åˆ—è¡¨ï¼Œä»£ç åœ¨å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ä¸Šæé«˜äº†å¾ˆå¤šã€‚</p><pre><code>// ResourcePoolConfigä½¿ç”¨ä¸¾ä¾‹
ResourcePoolConfig config = new ResourcePoolConfig(&quot;dbconnectionpool&quot;);
config.setMaxTotal(16);
config.setMaxIdle(8);
</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡æœ‰ç”¨åˆ°å»ºé€ è€…æ¨¡å¼ï¼Œé€šè¿‡æ„é€ å‡½æ•°è®¾ç½®å¿…å¡«é¡¹ï¼Œé€šè¿‡set()æ–¹æ³•è®¾ç½®å¯é€‰é…ç½®é¡¹ï¼Œå°±èƒ½å®ç°æˆ‘ä»¬çš„è®¾è®¡éœ€æ±‚ã€‚å¦‚æœæˆ‘ä»¬æŠŠé—®é¢˜çš„éš¾åº¦å†åŠ å¤§ç‚¹ï¼Œæ¯”å¦‚ï¼Œè¿˜éœ€è¦è§£å†³ä¸‹é¢è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œé‚£ç°åœ¨çš„è®¾è®¡æ€è·¯å°±ä¸èƒ½æ»¡è¶³äº†ã€‚</p><ul>
<li>æˆ‘ä»¬åˆšåˆšè®²åˆ°ï¼Œnameæ˜¯å¿…å¡«çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°æ„é€ å‡½æ•°ä¸­ï¼Œå¼ºåˆ¶åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å°±è®¾ç½®ã€‚å¦‚æœå¿…å¡«çš„é…ç½®é¡¹æœ‰å¾ˆå¤šï¼ŒæŠŠè¿™äº›å¿…å¡«é…ç½®é¡¹éƒ½æ”¾åˆ°æ„é€ å‡½æ•°ä¸­è®¾ç½®ï¼Œé‚£æ„é€ å‡½æ•°å°±åˆä¼šå‡ºç°å‚æ•°åˆ—è¡¨å¾ˆé•¿çš„é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬æŠŠå¿…å¡«é¡¹ä¹Ÿé€šè¿‡set()æ–¹æ³•è®¾ç½®ï¼Œé‚£æ ¡éªŒè¿™äº›å¿…å¡«é¡¹æ˜¯å¦å·²ç»å¡«å†™çš„é€»è¾‘å°±æ— å¤„å®‰æ”¾äº†ã€‚</li>
<li>é™¤æ­¤ä¹‹å¤–ï¼Œå‡è®¾é…ç½®é¡¹ä¹‹é—´æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚ï¼Œå¦‚æœç”¨æˆ·è®¾ç½®äº†maxTotalã€maxIdleã€minIdleå…¶ä¸­ä¸€ä¸ªï¼Œå°±å¿…é¡»æ˜¾å¼åœ°è®¾ç½®å¦å¤–ä¸¤ä¸ªï¼›æˆ–è€…é…ç½®é¡¹ä¹‹é—´æœ‰ä¸€å®šçš„çº¦æŸæ¡ä»¶ï¼Œæ¯”å¦‚ï¼ŒmaxIdleå’ŒminIdleè¦å°äºç­‰äºmaxTotalã€‚å¦‚æœæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ç°åœ¨çš„è®¾è®¡æ€è·¯ï¼Œé‚£è¿™äº›é…ç½®é¡¹ä¹‹é—´çš„ä¾èµ–å…³ç³»æˆ–è€…çº¦æŸæ¡ä»¶çš„æ ¡éªŒé€»è¾‘å°±æ— å¤„å®‰æ”¾äº†ã€‚</li>
<li>å¦‚æœæˆ‘ä»¬å¸Œæœ›ResourcePoolConfigç±»å¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡åœ¨åˆ›å»ºå¥½ä¹‹åï¼Œå°±ä¸èƒ½å†ä¿®æ”¹å†…éƒ¨çš„å±æ€§å€¼ã€‚è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±ä¸èƒ½åœ¨ResourcePoolConfigç±»ä¸­æš´éœ²set()æ–¹æ³•ã€‚</li>
</ul><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå»ºé€ è€…æ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠæ ¡éªŒé€»è¾‘æ”¾ç½®åˆ°Builderç±»ä¸­ï¼Œå…ˆåˆ›å»ºå»ºé€ è€…ï¼Œå¹¶ä¸”é€šè¿‡set()æ–¹æ³•è®¾ç½®å»ºé€ è€…çš„å˜é‡å€¼ï¼Œç„¶ååœ¨ä½¿ç”¨build()æ–¹æ³•çœŸæ­£åˆ›å»ºå¯¹è±¡ä¹‹å‰ï¼Œåšé›†ä¸­çš„æ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡ä¹‹åæ‰ä¼šåˆ›å»ºå¯¹è±¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æŠŠResourcePoolConfigçš„æ„é€ å‡½æ•°æ”¹ä¸ºprivateç§æœ‰æƒé™ã€‚è¿™æ ·æˆ‘ä»¬å°±åªèƒ½é€šè¿‡å»ºé€ è€…æ¥åˆ›å»ºResourcePoolConfigç±»å¯¹è±¡ã€‚å¹¶ä¸”ï¼ŒResourcePoolConfigæ²¡æœ‰æä¾›ä»»ä½•set()æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡å°±æ˜¯ä¸å¯å˜å¯¹è±¡äº†ã€‚</p><p>æˆ‘ä»¬ç”¨å»ºé€ è€…æ¨¡å¼é‡æ–°å®ç°äº†ä¸Šé¢çš„éœ€æ±‚ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class ResourcePoolConfig {
  private String name;
  private int maxTotal;
  private int maxIdle;
  private int minIdle;

  private ResourcePoolConfig(Builder builder) {
    this.name = builder.name;
    this.maxTotal = builder.maxTotal;
    this.maxIdle = builder.maxIdle;
    this.minIdle = builder.minIdle;
  }
  //...çœç•¥getteræ–¹æ³•...

  //æˆ‘ä»¬å°†Builderç±»è®¾è®¡æˆäº†ResourcePoolConfigçš„å†…éƒ¨ç±»ã€‚
  //æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Builderç±»è®¾è®¡æˆç‹¬ç«‹çš„éå†…éƒ¨ç±»ResourcePoolConfigBuilderã€‚
  public static class Builder {
    private static final int DEFAULT_MAX_TOTAL = 8;
    private static final int DEFAULT_MAX_IDLE = 8;
    private static final int DEFAULT_MIN_IDLE = 0;

    private String name;
    private int maxTotal = DEFAULT_MAX_TOTAL;
    private int maxIdle = DEFAULT_MAX_IDLE;
    private int minIdle = DEFAULT_MIN_IDLE;

    public ResourcePoolConfig build() {
      // æ ¡éªŒé€»è¾‘æ”¾åˆ°è¿™é‡Œæ¥åšï¼ŒåŒ…æ‹¬å¿…å¡«é¡¹æ ¡éªŒã€ä¾èµ–å…³ç³»æ ¡éªŒã€çº¦æŸæ¡ä»¶æ ¡éªŒç­‰
      if (StringUtils.isBlank(name)) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }
      if (maxIdle &gt; maxTotal) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }
      if (minIdle &gt; maxTotal || minIdle &gt; maxIdle) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }

      return new ResourcePoolConfig(this);
    }

    public Builder setName(String name) {
      if (StringUtils.isBlank(name)) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }
      this.name = name;
      return this;
    }

    public Builder setMaxTotal(int maxTotal) {
      if (maxTotal &lt;= 0) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }
      this.maxTotal = maxTotal;
      return this;
    }

    public Builder setMaxIdle(int maxIdle) {
      if (maxIdle &lt; 0) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }
      this.maxIdle = maxIdle;
      return this;
    }

    public Builder setMinIdle(int minIdle) {
      if (minIdle &lt; 0) {
        throw new IllegalArgumentException(&quot;...&quot;);
      }
      this.minIdle = minIdle;
      return this;
    }
  }
}

// è¿™æ®µä»£ç ä¼šæŠ›å‡ºIllegalArgumentExceptionï¼Œå› ä¸ºminIdle&gt;maxIdle
ResourcePoolConfig config = new ResourcePoolConfig.Builder()
        .setName(&quot;dbconnectionpool&quot;)
        .setMaxTotal(16)
        .setMaxIdle(10)
        .setMinIdle(12)
        .build();
</code></pre><p></p><p>å®é™…ä¸Šï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¯¹è±¡ï¼Œè¿˜èƒ½é¿å…å¯¹è±¡å­˜åœ¨æ— æ•ˆçŠ¶æ€ã€‚æˆ‘å†ä¸¾ä¸ªä¾‹å­è§£é‡Šä¸€ä¸‹ã€‚æ¯”å¦‚æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªé•¿æ–¹å½¢ç±»ï¼Œå¦‚æœä¸ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œé‡‡ç”¨å…ˆåˆ›å»ºåsetçš„æ–¹å¼ï¼Œé‚£å°±ä¼šå¯¼è‡´åœ¨ç¬¬ä¸€ä¸ªsetä¹‹åï¼Œå¯¹è±¡å¤„äºæ— æ•ˆçŠ¶æ€ã€‚å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>Rectangle r = new Rectange(); // r is invalid
r.setWidth(2); // r is invalid
r.setHeight(3); // r is valid
</code></pre><p>ä¸ºäº†é¿å…è¿™ç§æ— æ•ˆçŠ¶æ€çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨æ„é€ å‡½æ•°ä¸€æ¬¡æ€§åˆå§‹åŒ–å¥½æ‰€æœ‰çš„æˆå‘˜å˜é‡ã€‚å¦‚æœæ„é€ å‡½æ•°å‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå…ˆè®¾ç½®å»ºé€ è€…çš„å˜é‡ï¼Œç„¶åå†ä¸€æ¬¡æ€§åœ°åˆ›å»ºå¯¹è±¡ï¼Œè®©å¯¹è±¡ä¸€ç›´å¤„äºæœ‰æ•ˆçŠ¶æ€ã€‚</p><p>å®é™…ä¸Šï¼Œå¦‚æœæˆ‘ä»¬å¹¶ä¸æ˜¯å¾ˆå…³å¿ƒå¯¹è±¡æ˜¯å¦æœ‰çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€ï¼Œä¹Ÿä¸æ˜¯å¤ªåœ¨æ„å¯¹è±¡æ˜¯å¦æ˜¯å¯å˜çš„ã€‚æ¯”å¦‚ï¼Œå¯¹è±¡åªæ˜¯ç”¨æ¥æ˜ å°„æ•°æ®åº“è¯»å‡ºæ¥çš„æ•°æ®ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æš´éœ²set()æ–¹æ³•æ¥è®¾ç½®ç±»çš„æˆå‘˜å˜é‡å€¼æ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚è€Œä¸”ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ¥æ„å»ºå¯¹è±¡ï¼Œä»£ç å®é™…ä¸Šæ˜¯æœ‰ç‚¹é‡å¤çš„ï¼ŒResourcePoolConfigç±»ä¸­çš„æˆå‘˜å˜é‡ï¼Œè¦åœ¨Builderç±»ä¸­é‡æ–°å†å®šä¹‰ä¸€éã€‚</p><h2>ä¸å·¥å‚æ¨¡å¼æœ‰ä½•åŒºåˆ«ï¼Ÿ</h2><p>ä»ä¸Šé¢çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå»ºé€ è€…æ¨¡å¼æ˜¯è®©å»ºé€ è€…ç±»æ¥è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºå·¥ä½œã€‚ä¸Šä¸€èŠ‚è¯¾ä¸­è®²åˆ°çš„å·¥å‚æ¨¡å¼ï¼Œæ˜¯ç”±å·¥å‚ç±»æ¥è´Ÿè´£å¯¹è±¡åˆ›å»ºçš„å·¥ä½œã€‚é‚£å®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œå·¥å‚æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºä¸åŒä½†æ˜¯ç›¸å…³ç±»å‹çš„å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€çˆ¶ç±»æˆ–è€…æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥å†³å®šåˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡ï¼Œé€šè¿‡è®¾ç½®ä¸åŒçš„å¯é€‰å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€åœ°åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚</p><p>ç½‘ä¸Šæœ‰ä¸€ä¸ªç»å…¸çš„ä¾‹å­å¾ˆå¥½åœ°è§£é‡Šäº†ä¸¤è€…çš„åŒºåˆ«ã€‚</p><p>é¡¾å®¢èµ°è¿›ä¸€å®¶é¤é¦†ç‚¹é¤ï¼Œæˆ‘ä»¬åˆ©ç”¨å·¥å‚æ¨¡å¼ï¼Œæ ¹æ®ç”¨æˆ·ä¸åŒçš„é€‰æ‹©ï¼Œæ¥åˆ¶ä½œä¸åŒçš„é£Ÿç‰©ï¼Œæ¯”å¦‚æŠ«è¨ã€æ±‰å ¡ã€æ²™æ‹‰ã€‚å¯¹äºæŠ«è¨æ¥è¯´ï¼Œç”¨æˆ·åˆæœ‰å„ç§é…æ–™å¯ä»¥å®šåˆ¶ï¼Œæ¯”å¦‚å¥¶é…ªã€è¥¿çº¢æŸ¿ã€èµ·å¸ï¼Œæˆ‘ä»¬é€šè¿‡å»ºé€ è€…æ¨¡å¼æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„ä¸åŒé…æ–™æ¥åˆ¶ä½œæŠ«è¨ã€‚</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿä¸è¦å¤ªå­¦é™¢æ´¾ï¼Œéå¾—æŠŠå·¥å‚æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼åˆ†å¾—é‚£ä¹ˆæ¸…æ¥šï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œæ¯ä¸ªæ¨¡å¼ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Œèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ã€‚<strong>åªæœ‰äº†è§£äº†è¿™äº›æœ€æœ¬è´¨çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬æ‰èƒ½ä¸ç”Ÿæ¬ç¡¬å¥—ï¼Œæ‰èƒ½çµæ´»åº”ç”¨ï¼Œç”šè‡³å¯ä»¥æ··ç”¨å„ç§æ¨¡å¼åˆ›é€ å‡ºæ–°çš„æ¨¡å¼ï¼Œæ¥è§£å†³ç‰¹å®šåœºæ™¯çš„é—®é¢˜ã€‚</strong></p><h2>é‡ç‚¹å›é¡¾</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„å†…å®¹åˆ°æ­¤å°±è®²å®Œäº†ã€‚æˆ‘ä»¬ä¸€å—æ¥æ€»ç»“å›é¡¾ä¸€ä¸‹ï¼Œä½ éœ€è¦é‡ç‚¹æŒæ¡çš„å†…å®¹ã€‚</p><p>å»ºé€ è€…æ¨¡å¼çš„åŸç†å’Œå®ç°æ¯”è¾ƒç®€å•ï¼Œé‡ç‚¹æ˜¯æŒæ¡åº”ç”¨åœºæ™¯ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨ã€‚</p><p>å¦‚æœä¸€ä¸ªç±»ä¸­æœ‰å¾ˆå¤šå±æ€§ï¼Œä¸ºäº†é¿å…æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨è¿‡é•¿ï¼Œå½±å“ä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°é…åˆset()æ–¹æ³•æ¥è§£å†³ã€‚ä½†æ˜¯ï¼Œå¦‚æœå­˜åœ¨ä¸‹é¢æƒ…å†µä¸­çš„ä»»æ„ä¸€ç§ï¼Œæˆ‘ä»¬å°±è¦è€ƒè™‘ä½¿ç”¨å»ºé€ è€…æ¨¡å¼äº†ã€‚</p><ul>
<li>æˆ‘ä»¬æŠŠç±»çš„å¿…å¡«å±æ€§æ”¾åˆ°æ„é€ å‡½æ•°ä¸­ï¼Œå¼ºåˆ¶åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å°±è®¾ç½®ã€‚å¦‚æœå¿…å¡«çš„å±æ€§æœ‰å¾ˆå¤šï¼ŒæŠŠè¿™äº›å¿…å¡«å±æ€§éƒ½æ”¾åˆ°æ„é€ å‡½æ•°ä¸­è®¾ç½®ï¼Œé‚£æ„é€ å‡½æ•°å°±åˆä¼šå‡ºç°å‚æ•°åˆ—è¡¨å¾ˆé•¿çš„é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬æŠŠå¿…å¡«å±æ€§é€šè¿‡set()æ–¹æ³•è®¾ç½®ï¼Œé‚£æ ¡éªŒè¿™äº›å¿…å¡«å±æ€§æ˜¯å¦å·²ç»å¡«å†™çš„é€»è¾‘å°±æ— å¤„å®‰æ”¾äº†ã€‚</li>
<li>å¦‚æœç±»çš„å±æ€§ä¹‹é—´æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»æˆ–è€…çº¦æŸæ¡ä»¶ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨æ„é€ å‡½æ•°é…åˆset()æ–¹æ³•çš„è®¾è®¡æ€è·¯ï¼Œé‚£è¿™äº›ä¾èµ–å…³ç³»æˆ–çº¦æŸæ¡ä»¶çš„æ ¡éªŒé€»è¾‘å°±æ— å¤„å®‰æ”¾äº†ã€‚</li>
<li>å¦‚æœæˆ‘ä»¬å¸Œæœ›åˆ›å»ºä¸å¯å˜å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡åœ¨åˆ›å»ºå¥½ä¹‹åï¼Œå°±ä¸èƒ½å†ä¿®æ”¹å†…éƒ¨çš„å±æ€§å€¼ï¼Œè¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±ä¸èƒ½åœ¨ç±»ä¸­æš´éœ²set()æ–¹æ³•ã€‚æ„é€ å‡½æ•°é…åˆset()æ–¹æ³•æ¥è®¾ç½®å±æ€§å€¼çš„æ–¹å¼å°±ä¸é€‚ç”¨äº†ã€‚</li>
</ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ä»Šå¤©çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯¹æ¯”äº†å·¥å‚æ¨¡å¼å’Œå»ºé€ è€…æ¨¡å¼çš„åŒºåˆ«ã€‚å·¥å‚æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºä¸åŒä½†æ˜¯ç›¸å…³ç±»å‹çš„å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€çˆ¶ç±»æˆ–è€…æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥å†³å®šåˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„å¯é€‰å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€åœ°åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚</p><h2>è¯¾å ‚è®¨è®º</h2><p>åœ¨ä¸‹é¢çš„ConstructorArgç±»ä¸­ï¼Œå½“isRefä¸ºtrueçš„æ—¶å€™ï¼Œargè¡¨ç¤ºStringç±»å‹çš„refBeanIdï¼Œtypeä¸éœ€è¦è®¾ç½®ï¼›å½“isRefä¸ºfalseçš„æ—¶å€™ï¼Œargã€typeéƒ½éœ€è¦è®¾ç½®ã€‚è¯·æ ¹æ®è¿™ä¸ªéœ€æ±‚ï¼Œå®Œå–„ConstructorArgç±»ã€‚</p><pre><code> public class ConstructorArg {
    private boolean isRef;
    private Class type;
    private Object arg;
    // TODO: å¾…å®Œå–„...
  }
</code></pre><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œå¦‚æœæœ‰æ”¶è·ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Darren</span>
  </div>
  <div class="_2_QraFYR_0">ç®€å•ç†è§£å°±æ˜¯ï¼šå·¥å‚æ¨¡å¼æ˜¯æ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒClassçš„å¯¹è±¡ï¼Œæ„å»ºè€…æ¨¡å¼æ˜¯æ ¹æ®ä¸åŒå‚æ•°ç”Ÿæˆä¸€ä¸ªclassçš„ä¸åŒå¯¹è±¡ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-04-10 16:33:54</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>webmin</span>
  </div>
  <div class="_2_QraFYR_0">public class ConstructorArg {<br>    private boolean isRef;<br>    private Class type;<br>    private Object arg;<br><br>    public boolean isRef() {<br>        return isRef;<br>    }<br><br>    public Class getType() {<br>        return type;<br>    }<br><br>    public Object getArg() {<br>        return arg;<br>    }<br><br>    private ConstructorArg(Builder builder) {<br>        this.isRef = builder.isRef;<br>        this.type = builder.type;<br>        this.arg = builder.arg;<br>    }<br><br>    public static class Builder {<br>        private boolean isRef;<br>        private Class type;<br>        private Object arg;<br><br>        public ConstructorArg build() {<br>            if(isRef &amp;&amp; type != null) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br><br>            if (!isRef &amp;&amp; type == null) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br><br>            if (this.isRef &amp;&amp; (arg != null &amp;&amp; arg.getClass() != String.class)) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br><br>            if (!this.isRef &amp;&amp; arg == null) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br><br>            return new ConstructorArg(this);<br>        }<br><br>        public Builder setRef(boolean ref) {<br>            if(ref &amp;&amp; this.type != null) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br>            this.isRef = ref;<br>            return this;<br>        }<br><br>        public Builder setType(Class type) {<br>            if (this.isRef || type == null) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br>            this.type = type;<br>            return this;<br>        }<br><br>        public Builder setArg(Object arg) {<br>            if (this.isRef &amp;&amp; (arg != null &amp;&amp; arg.getClass() != String.class)) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br><br>            if (!this.isRef &amp;&amp; arg == null) {<br>                throw new IllegalArgumentException(&quot;...&quot;);<br>            }<br>            this.arg = arg;<br>            return this;<br>        }<br>    }<br>}</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 13:53:31</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/2f/7a/ab6c811c.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ç›¸é€¢æ˜¯ç¼˜</span>
  </div>
  <div class="_2_QraFYR_0">æ‰“å¡<br>ä¸€ã€ä½¿ç”¨åœºæ™¯ï¼š<br>1ï¼‰ç±»çš„æ„é€ å‡½æ•°å¿…å¡«å±æ€§å¾ˆå¤šï¼Œé€šè¿‡setè®¾ç½®ï¼Œæ²¡æœ‰åŠæ³•æ ¡éªŒå¿…å¡«å±æ€§<br>2ï¼‰å¦‚æœç±»çš„å±æ€§ä¹‹é—´æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ„é€ å‡½æ•°é…åˆsetæ–¹å¼ï¼Œæ— æ³•è¿›è¡Œä¾èµ–å…³ç³»å’Œçº¦æŸæ¡ä»¶æ ¡éªŒ<br>3ï¼‰éœ€è¦åˆ›å»ºä¸å¯å˜å¯¹è±¡ï¼Œä¸èƒ½æš´éœ²setæ–¹æ³•ã€‚<br>ï¼ˆå‰ææ˜¯éœ€è¦ä¼ é€’å¾ˆå¤šçš„å±æ€§ï¼Œå¦‚æœå±æ€§å¾ˆå°‘ï¼Œå¯ä»¥ä¸éœ€è¦å»ºé€ è€…æ¨¡å¼ï¼‰<br>äºŒã€å®ç°æ–¹å¼ï¼š<br>æŠŠæ„é€ å‡½æ•°å®šä¹‰ä¸ºprivateï¼Œå®šä¹‰public static class Builder å†…éƒ¨ç±»ï¼Œé€šè¿‡Builder ç±»çš„setæ–¹æ³•è®¾ç½®å±æ€§ï¼Œè°ƒç”¨buildæ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚<br><br>ä¸‰ã€å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«ï¼š<br>1ï¼‰å·¥å‚æ¨¡å¼ï¼šåˆ›å»ºä¸åŒçš„åŒä¸€ç±»å‹å¯¹è±¡ï¼ˆé›†æˆåŒä¸€ä¸ªçˆ¶ç±»æˆ–æ˜¯æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥åˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ï¼›<br>2ï¼‰å»ºé€ è€…æ¨¡å¼ï¼šåˆ›å»ºä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡ï¼Œé€šè¿‡å¾ˆå¤šå¯è®¾ç½®å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€çš„åˆ›å»ºå¯¹è±¡</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 17:40:18</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/44/47/3ddb94d0.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>javaadu</span>
  </div>
  <div class="_2_QraFYR_0">è¯¾å ‚è®¨è®ºé¢˜ï¼š<br><br>&#47;**<br> * åœ¨ä¸‹é¢çš„ ConstructorArg ç±»ä¸­ï¼Œ<br> * å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹çš„ refBeanIdï¼Œtype ä¸éœ€è¦è®¾ç½®ï¼›<br> * å½“ isRef ä¸º false çš„æ—¶å€™ï¼Œargã€type éƒ½éœ€è¦è®¾ç½®<br> *<br> * @author javaadu<br> *&#47;<br>public class ConstructorArg {<br>    private boolean isRef;<br>    private Class type;<br>    private Object arg;<br><br>    private ConstructorArg(Builder builder) {<br>        this.isRef = builder.isRef;<br>        this.type = builder.type;<br>        this.arg = builder.arg;<br>    }<br><br>    public static class Builder {<br>        private boolean isRef;<br>        private Class type;<br>        private Object arg;<br><br>        public ConstructorArg build() {<br>            if (arg == null) {<br>                throw new IllegalArgumentException(&quot;argå¿…é¡»è®¾ç½®&quot;);<br>            }<br>            if (isRef) {<br>                if (!(arg instanceof String)) {<br>                    throw new IllegalArgumentException(&quot;argå¿…é¡»ä¸ºStringç±»å‹çš„å¯¹è±¡&quot;);<br>                }<br>            } else {<br>                if (type == null) {<br>                    throw new IllegalArgumentException(&quot;argå¿…é¡»è®¾ç½®&quot;);<br>                }<br>            }<br><br>            return new ConstructorArg(this)<br>        }<br><br>        public Builder setRef(boolean ref) {<br>            isRef = ref;<br>            return this;<br>        }<br><br>        public Builder setArg(Object arg) {<br>            this.arg = arg;<br>            return this;<br>        }<br><br>        public Builder setType(Class type) {<br>            this.type = type;<br>            return this;<br>        }<br>    }<br>}</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 09:37:08</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/17/86/25/25ded6c3.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>zhengyu.nie</span>
  </div>
  <div class="_2_QraFYR_0">ä¾èµ–å…³ç³»ï¼ˆDependenciesï¼‰ã€åˆæ³•æ ¡éªŒï¼ˆPreconditionsï¼‰ã€ä¸å¯å˜ï¼ˆImmutableï¼‰ã€‚<br>äº‰å“¥è¿™å‡ ä¸ªæè¿°å¾ˆç²¾å‡†ï¼<br>å€Ÿç€æ€è·¯å»¶ä¼¸ä¸€ä¸‹çš„è¯ï¼Œå¾ˆå¤šåº“å’Œè®¾è®¡éƒ½æ˜¯ä»¥ä¸Šè¿™äº›ç†å¿µçš„ã€‚<br>æ¯”å¦‚com.google.guavaçš„æ ¡éªŒã€ä¸å¯å˜é›†åˆï¼Œå¤šçº¿ç¨‹è®¾è®¡æ¨¡å¼ä¸­çš„Immutableæ¨¡å¼ã€ä¿æŠ¤æ€§æ‹·è´ï¼ˆå…¶ä¸­åˆå¯ä»¥åˆ†æ·±æµ…apiï¼‰ï¼Œjava.lang.Stringçš„ä¸å¯å˜è®¾è®¡ã€‚è¿˜æœ‰å…³äºç±»çŠ¶æ€çš„æ§åˆ¶ï¼Œè¿˜æœ‰Effective Javaä¸­ç±»åˆ›å»ºè¿™ä¸€ç« ä¸­å¯¹äºæ„é€ æ–¹æ³•ã€setæ–¹æ³•ã€Builderæ„å»ºã€æšä¸¾ã€é™æ€å·¥å‚æ–¹æ³•æ„å»ºç­‰å¯¹æ¯”ï¼ŒåƒGuava Listsã€Setsã€Mapsã€ImmutableListè¿™ç§åˆ›å»ºæ–¹å¼ç°åœ¨ä¹Ÿå¾ˆä¸»æµäº†</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ğŸ‘</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-04-28 20:02:58</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å°æ–‡åŒå­¦</span>
  </div>
  <div class="_2_QraFYR_0">è¯´è¯´è‡ªå·±è¯»äº† Builder æ¨¡å¼çš„æœ€å¤§æ„Ÿæ‚Ÿï¼š<br>1ã€Builder æ¨¡å¼å¯ä»¥ä¿è¯å¯¹è±¡çš„çŠ¶æ€ã€‚<br>2ã€Builder æ¨¡å¼å¯ä»¥æŠŠå¯¹è±¡çš„æ„é€ é‰´å®šé€»è¾‘å†™åœ¨Builderç±»ä¸­ï¼Œä¿è¯äº†ç±»çš„ç®€æ´ã€‚<br><br>å¹³æ—¶æ™®æ™®é€šé€šåœ°ä½¿ç”¨ lombok ç”Ÿæˆ Builderï¼Œåº”è¯¥æ›´åŠ æ·±å…¥åœ°äº†è§£ä¸€ä¸‹ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-03-07 14:32:30</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/ca/c7/00e544c2.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>é»„æ—æ™´</span>
  </div>
  <div class="_2_QraFYR_0">æ‰“å¡~<br>æœ€è¿‘åŠå¹´ç”¨çš„æœ€å¤šçš„å°±æ˜¯Builderæ¨¡å¼äº†</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 22:12:03</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/17/c1/66/e8dfeef4.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ç‹æ¶›</span>
  </div>
  <div class="_2_QraFYR_0">æœ€è¿‘ï¼Œåœ¨å­¦ä¹ æœ¬ä¸“æ çš„è¿‡ç¨‹ä¸­ã€‚<br>é€æ¸ä½“ä¼šåˆ°â€œçŸ¥å…¶ç„¶ï¼Œæ›´çŸ¥å…¶æ‰€ä»¥ç„¶â€çš„æ„Ÿè§‰<br></div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 12:05:21</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/a0/a3/8da99bb0.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ä¸šä½™çˆ±å¥½è€…</span>
  </div>
  <div class="_2_QraFYR_0">åˆ›å»ºå‹æ¨¡å¼çš„ä½œç”¨åœ¨äºï¼Œå°†å¯¹è±¡â€œè·å–â€ï¼ˆæ²¡æœ‰ç”¨åˆ›å»ºï¼‰çš„è¿‡ç¨‹ç‹¬ç«‹å‡ºæ¥ï¼Œå½¢æˆå•ç‹¬çš„ç±»ã€‚è¿™åœ¨è·å–å¤æ‚æˆ–è€…æœ‰ç‰¹æ®Šéœ€æ±‚çš„å¯¹è±¡æ—¶å¯ä»¥æ›´å¥½çš„ä½“ç°å•ä¸€èŒè´£åŸåˆ™---æˆ‘è´Ÿè´£æ‹¿åˆ°ï¼ˆready to useï¼‰å¯¹è±¡,ä½ åªç®¡ä½¿ç”¨å°±å¯ä»¥äº†ã€‚ä½ ä¸éœ€è¦å…³ç³»æˆ‘æ˜¯ä¸æ˜¯æ‡’åŠ è½½ä¹‹ç±»çš„é—®é¢˜ã€‚<br><br>ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„å¯¹è±¡ï¼Œå®ƒçš„æ„ä¹‰ç»ä¸å•å•æ˜¯newä¸€ä¸‹å°±å®Œäº‹äº†ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—å…¶ä»–çš„è€ƒé‡ã€‚<br>å¦‚æœè¦æ±‚ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å¯¹è±¡ï¼Œå¦‚åŸºæœ¬ä¸å˜åŒ–çš„é…ç½®ä¿¡æ¯ç±»ï¼Œè¿™å°±æ˜¯å•ä¾‹æ¨¡å¼ã€‚å¦‚ä½•æ§åˆ¶åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå½“ç„¶æ˜¯æ‹¦æˆªæ‰æ‰€æœ‰å…¶ä»–åˆ›å»ºå¯¹è±¡çš„è·¯å¾„ï¼Œåªç•™ä¸‹ä¸€æ¡è·¯---ä½¿ç”¨ç±»å”¯ä¸€çš„é™æ€æ–¹æ³•è·å–å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œå•ä¾‹ä¸€èˆ¬éƒ½è¦æ±‚å°†æ„é€ æ–¹æ³•ç§æœ‰åŒ–ã€‚ï¼ˆspringçš„å•ä¾‹beanå…¶å®åªæ˜¯ä¸€ç§å•ä¾‹çš„çº¦å®šï¼Œä½ å®Œå…¨å¯ä»¥è‡ªå·±newä¸€ä¸ªã€‚ï¼‰å•ä¾‹æ¨¡å¼è¿˜è®¾è®¡åˆ°æ‡’åŠ è½½çš„é—®é¢˜ï¼Œä¸è¿‡ç”±äºåªæœ‰ä¸€ä¸ªè®¿é—®å…¥å£ï¼Œå¤„ç†èµ·æ¥æ¯”è¾ƒç®€å•ã€‚<br><br>å·¥å‚æ¨¡å¼å°±æ¯”è¾ƒçº¯ç²¹äº†ï¼Œå·¥å‚çš„æ„ä¹‰å°±æ˜¯åœ¨äºè·å–ä¸€ä¸ªå¯¹è±¡ã€‚ç®€å•å·¥å·¥å‚ç±»å¦‚æœæ˜¯æ— çŠ¶æ€çš„è¯ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•çš„å½¢å¼ï¼Œæ²¡æœ‰å¿…è¦æ¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡éƒ½å…ˆå¼„ä¸ªå®Œå…¨ä¸€æ ·çš„å·¥å‚å‡ºæ¥ã€‚<br>å½“éœ€è¦æœ‰æ ¹æ®ä¸åŒæƒ…å†µåˆ›å»ºä¸åŒå­ç±»çš„æ—¶å€™ï¼Œå¦‚æœåˆ†æ”¯ä¸å¤šçš„è¯ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨if else,ä¸è¿‡ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šæ€ã€‚ä¸åŒçš„æƒ…å†µåˆ›å»ºä¸åŒçš„å·¥å‚ï¼Œå°†ç›¸åº”å­ç±»å„å¼‚çš„åˆ›å»ºé€»è¾‘åˆ†å¼€ã€‚è¿™å°±æ˜¯å·¥å‚æ–¹æ³•ã€‚<br>è€Œå¦‚æœæ˜¯åˆ›å»ºä¸€ä¸ªäº§å“ç³»åˆ—çš„è¯ï¼Œå°±ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚<br><br>å»ºé€ è€…ç”¨äºå¤„ç†åˆ›å»ºå‚æ•°è¿‡å¤šçš„æƒ…å½¢ï¼ŒåŒæ—¶å¯ä»¥æ ¡éªŒå‚æ•°ï¼Œé¿å…å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­çš„ä¸ä¸€è‡´çŠ¶æ€ã€‚<br><br>åŸå‹ç”¨äºå¿«é€Ÿæ‹·è´ä¸€ä¸ªå¯¹è±¡ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-08-02 14:02:09</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/44/a7/171c1e86.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å•¦å•¦å•¦</span>
  </div>
  <div class="_2_QraFYR_0">ç”¨phpå®ç°äº†ä¸€ä¸ª<br>&lt;?php<br>class ResourcePoolConfig{<br>    private $maxTotal;<br>    private $maxIdle;<br>    private $minIdle;<br>    public function __construct(build $build)<br>    {<br>        $this-&gt;maxTotal = $build-&gt;maxTotal;<br>        $this-&gt;maxIdle = $build-&gt;maxIdle;<br>        $this-&gt;minIdle = $build-&gt;minIdle;<br>        echo &#39;maxTotal&#39;.$this-&gt;maxTotal;<br>        echo &#39;&lt;br &#47;&gt;&#39;;<br>        echo &#39;maxIdle&#39;.$this-&gt;maxIdle;<br>        echo &#39;&lt;br &#47;&gt;&#39;;<br>        echo &#39;minIdle&#39;.$this-&gt;minIdle;<br>        echo &#39;&lt;br &#47;&gt;&#39;;<br>    }<br>}<br><br>class Builder{<br>    public $maxTotal;<br>    public $maxIdle;<br>    public $minIdle;<br>    public function noodleValidate(){<br>        if($this-&gt;maxIdle&gt;$this-&gt;maxTotal){<br>            throw new Exception(&quot;maxIdleæŠ›å‡ºå¼‚å¸¸&quot;);<br>        }<br>        if($this-&gt;minIdle&gt;$this-&gt;maxTotal){<br>            throw new Exception(&quot;minIdleæŠ›å‡ºå¼‚å¸¸&quot;);<br>        }<br>    }<br><br>    public function setMaxTotal($value=20){<br>        $this-&gt;maxTotal = $value;<br>        return $this;<br>    }<br><br>    public function setMaxIdle($value=10){<br>        $this-&gt;maxIdle = $value;<br>        return $this;<br>    }<br><br>    public function setMinIdle($value=10){<br>        $this-&gt;minIdle = $value;<br>        return $this;<br>    }<br>}<br><br>$b = new Builder();<br>$b-&gt;setMaxTotal(5)-&gt;setMaxIdle()-&gt;setMinIdle()-&gt;noodleValidate();<br>new ResourcePoolConfig($b);</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 22:11:42</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/4e/d0/d8a5f720.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Kenå¼ äº‘å¿ </span>
  </div>
  <div class="_2_QraFYR_0">public class ConstructorArg {<br>    private boolean isRef;<br>    private Class type;<br>    private Object arg;<br>    public ConstructorArg(ConstructorArgBuilder builder) {<br>        this.isRef = builder.isRef;<br>        this.type = builder.type;<br>        this.arg = builder.arg;<br>    }<br>    public static class ConstructorArgBuilder {<br>        private boolean isRef;<br>        private Class type;<br>        private Object arg;<br>        public ConstructorArg builder() {<br>            if (arg == null) {<br>                throw new IllegalArgumentException(&quot;arg should not be null&quot;);<br>            }<br>            if (isRef == true) {<br>                if (arg instanceof String) {<br>                    type = String.class;<br>                } else {<br>                    throw  new IllegalArgumentException(&quot;when isRef is true,arg should be String type&quot;);<br>                }<br>            } else {<br>                type = arg.getClass();<br>            }<br>            return new ConstructorArg(this);<br>        }<br>        public ConstructorArgBuilder(boolean isRef) {<br>            this.isRef = isRef;<br>        }<br>        public ConstructorArgBuilder setArg(Object arg) {<br>            this.arg = arg;<br>            return this;<br>        }<br>    }<br>}<br> &#47;&#47; use case<br>ConstructorArg constructorArg = new ConstructorArgBuilder(true).setArg(0).builder();<br>ConstructorArg constructorArg1 = new ConstructorArgBuilder(false).setArg(1).builder();</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 11:41:49</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ¢¦å€šæ æ†</span>
  </div>
  <div class="_2_QraFYR_0">â€œå¦‚æœæˆ‘ä»¬å¹¶ä¸æ˜¯å¾ˆå…³å¿ƒå¯¹è±¡æ˜¯å¦æœ‰çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€â€<br><br>ä¸­é—´çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæ²¡ç†è§£ã€‚æ˜¯åœ¨å¤šçº¿ç¨‹ä¸‹ä¼šæœ‰é—®é¢˜å—ï¼Ÿå¦‚æœæ˜¯ï¼Œå¦‚æœæ˜¯ç±»å¯¹è±¡ï¼Œè¿™æœ¬èº«ä¸€ç»„æ“ä½œå°±åº”è¯¥åŠ é”ï¼Œå¦‚æœæ˜¯æ–¹æ³•å†…éƒ¨ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥æ²¡ç†è§£çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€ä¼šæ€ä¹ˆæ ·<br><br><br></div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-03-23 06:49:42</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/93/c7/86352ccc.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>1024</span>
  </div>
  <div class="_2_QraFYR_0">åšäº†ä¸€ä¸‹è¯¾åé¢˜ï¼Œå’Œå…¶ä»–åŒå­¦çš„ç­”æ¡ˆæ¯”è¾ƒäº†ä¸‹ï¼Œè¿˜æ˜¯æœ‰äº›ç–‘æƒ‘ï¼Œç–‘æƒ‘åœ¨å±æ€§çš„åˆ¤æ–­é€»è¾‘æ˜¯æ”¾åœ¨Builderçš„setAttr()å†…è¿˜æ˜¯æ”¾åœ¨build()å†…<br>ä¸ªäººè®¤ä¸ºï¼š<br>setAttr()æ”¾å±æ€§è‡ªå·±çš„é€»è¾‘åˆ¤æ–­ï¼Œæ¯”å¦‚ä¸è¦ä¸ºnullï¼Œä¸èƒ½å¤§äºæˆ–å°äºæŸä¸ªå¸¸é‡<br>build()æ–¹æ³•æ”¾å¤šä¸ªå±æ€§é—´çš„æ ¡éªŒé€»è¾‘ï¼Œå› ä¸ºè°ƒç”¨builde()æ—¶ï¼Œå±æ€§éƒ½setå®Œæˆï¼Œè¿™æ—¶å€™æ‰æœ‰æœºä¼šé€šè¿‡builde()æ¥å…¨å±€è€ƒè™‘æ‰€æœ‰å±æ€§çš„é€»è¾‘ã€‚<br>åŸºäºæ­¤ï¼Œæˆ‘çš„ç­”æ¡ˆå¦‚ä¸‹<br>public class ConstructorArg {<br>    private boolean isRef;<br>    private Class type;<br>    private Object arg;<br><br>    private ConstructorArg(Builder builder) {<br>        this.isRef = builder.isRef;<br>        this.type = builder.type;<br>        this.arg = builder.arg;<br>    }<br>    &#47;&#47; çœç•¥getteræ–¹æ³•<br><br>    public static class Builder {<br>        private Object arg;<br>        private Class type;<br>        private boolean isRef;<br><br>        private ConstructorArg build() {<br>            if (isRef) {<br>                if (!(arg instanceof String)) {<br>                    &#47;&#47;è¿™é‡ŒrefBeanIdæ˜¯ConstructorArgå—ï¼Ÿåªæ˜¯åˆ¤æ–­äº†ä¸‹argç±»å‹æ˜¯å¦ä¸ºString<br>                    throw new IllegalArgumentException(&quot;å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹refBeanId&quot;);<br>                }<br>                if (type != null) {<br>                    throw new IllegalArgumentException(&quot;å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œtype ä¸éœ€è¦è®¾ç½®&quot;);<br>                }<br>            }<br>            if (!isRef) {<br>                if (arg == null || type == null) {<br>                    throw new IllegalArgumentException(&quot;å½“ isRef ä¸º false çš„æ—¶å€™ï¼Œargã€type éƒ½éœ€è¦è®¾ç½®&quot;);<br>                }<br>            }<br>            return new ConstructorArg(this);<br>        }<br><br>        public Builder setRef(boolean ref) {<br>            isRef = ref;<br>            return this;<br>        }<br><br>        public Builder setArg(Object arg) {<br>            this.arg = arg;<br>            return this;<br>        }<br><br>        public Builder setType(Class type) {<br>            this.type = type;<br>            return this;<br>        }<br>    }<br>public static void main(String[] args) {<br>        ConstructorArg.Builder builder = new ConstructorArg.Builder();<br>&#47;&#47;        java.lang.IllegalArgumentException: å½“ isRef ä¸º true çš„æ—¶å€™ï¼Œarg è¡¨ç¤º String ç±»å‹refBeanId<br>        builder.setRef(true).setArg(1).build();<br>    }</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-03-07 14:54:21</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ä½•å¦¨</span>
  </div>
  <div class="_2_QraFYR_0">å»ºé€ è€…æ¨¡å¼:ç”¨äºå·²çŸ¥ç±»åˆ›å»ºï¼Œåˆ›å»ºæ„é€ å¤æ‚éœ€æ ¡éªŒå‚æ•°çš„ç±»<br>å·¥å‚æ¨¡å¼:ç”¨äºæœªçŸ¥ç±»åˆ›å»ºï¼Œæ ¹æ®ä¼ å…¥å‚æ•°åˆ›å»ºç›¸ä¼¼çš„ç±»å¤„ç†ä¸åŒé€»è¾‘</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-24 09:10:28</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/47/31/f35367c8.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å°æ™å­</span>
  </div>
  <div class="_2_QraFYR_0">è¯¾åè®¨è®ºé¢˜ï¼š<br><br> public class ConstructorArg {<br>    private boolean isRef;<br>    private Class type;<br>    private Object arg;<br>    &#47;&#47; TODO: å¾…å®Œå–„...<br><br>    private ConstructorArg(Builder builder) {<br>        this.isRef = builder.isRef;<br>        this.type  = builder.type;<br>        this.arg   = builder.arg;<br>    }<br><br>    public static class Builder {<br>        private boolean isRef;<br>        private Class type;<br>        private Object arg;<br><br>        public ConstructorArg build() {<br>            if (!isRef) {<br>                if (type == null || arg == null){<br>                    throw new IllegalArgumentException(&quot;type and arg must be set when isRef is false&quot;)<br>                }<br>            } else {<br>                if (!(arg instanceof String)) {<br>                    throw new IllegalArgumentException(&quot;arg must be a String instance when isRef is true&quot;)<br>                }<br>            }<br>            return new ConstructorArg(this);<br>        }<br>    }<br><br>    public Builder setIsRef(boolean isRef){<br>        this.isRef = isRef;<br>        return this;<br>    }<br><br>    public Builder setType(Class type) {<br>        this.type = type;<br>        return this;<br>    }<br><br>    public Builder setObject(Object arg) {<br>        this.arg = arg;<br>        return this;<br>    }<br>  }<br><br>  &#47;&#47;use case<br>  ConstructorArg ca = ConstructorArg.Builder()<br>        .setIfRef(false)<br>        .setType(Integer)<br>        .setObject(2)<br>        .build();</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 10:08:56</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/18/12/6c/61a598e9.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è‹æš®æ²‰è§</span>
  </div>
  <div class="_2_QraFYR_0">       å°äº‰å“¥ï¼Œæˆ‘åœ¨å­¦ä¹ å»ºé€ è€…æ¨¡å¼çš„æ—¶å€™ï¼Œå‘ç°ä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼å†™æ³•è·Ÿæ–‡ä¸­çš„ä¸å¤ªä¸€æ ·ï¼Œä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼å­˜åœ¨ç›‘å·¥ï¼ŒæŠ½è±¡Builderï¼Œå…·ä½“Builderï¼Œäº§å“ç±»ã€‚å¯ä»¥é€šè¿‡ä¸åŒçš„å…·ä½“Builderï¼Œåˆ›å»ºå¯¹åº”çš„äº§å“ç±»ã€‚è€Œä½ åœ¨æ–‡ç« ä¸­çš„è®¾è®¡æ¨¡å¼çš„å†™æ³•ï¼Œåœ¨æŸäº›æ–‡ç« ä¸­ï¼Œè¢«ç§°ä¸ºå˜ç§çš„æ„é€ è€…æ¨¡å¼ã€‚<br>       æˆ‘æ¯”è¾ƒäº†ä¸€ä¸‹ä¸¤ç§æ–¹å¼ï¼Œæ„Ÿè§‰ä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼éœ€è¦æå‰å®šä¹‰å¥½ä½ è¦ç”Ÿäº§çš„äº§å“å¯¹åº”çš„å±æ€§ï¼Œè€Œæ–‡ä¸­è¿™ç§æ–¹æ³•åˆ™æ˜¯åœ¨æ„å»ºäº§å“æ—¶ï¼Œè‡ªå·±åŠ¨æ€çš„è®¾ç½®äº§å“å±æ€§ï¼Œè™½ç„¶è¯´è¿™ç§æ–¹æ³•æ›´åŠ çµæ´»ï¼Œä½†æ˜¯ä¾µå…¥æ€§æ›´é«˜ã€‚<br>      é‚£ä¹ˆè€ƒè™‘åˆ°ä»¥åéœ€æ±‚å˜æ›´ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ˜¯ç”¨ä¼ ç»Ÿçš„æ„å»ºè€…æ¨¡å¼å‘¢ï¼Ÿä¸ç„¶è¦æ˜¯èµ„æºæ± å¯¹åº”çš„å‚æ•°å˜äº†ï¼Œå°±è¦ä¿®æ”¹ä¸šåŠ¡ä»£ç ä¸­çš„å‚æ•°äº†ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: åœ¨çœŸå®çš„é¡¹ç›®é‡Œï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨æˆ‘è¯´çš„è¿™ç§å®ç°æ–¹å¼å§ã€‚ä½ è¯´çš„ç›‘å·¥ã€æŠ½è±¡builderã€å…·ä½“builderçš„å®ç°æ–¹å¼ï¼Œæœ‰å…·ä½“çš„ä¾‹å­å—ï¼Ÿ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-05-21 15:38:32</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>J.Smile</span>
  </div>
  <div class="_2_QraFYR_0">å»ºé€ è€…æ¨¡å¼æ ¸å¿ƒä»£ç :<br>ResourcePoolConfig config = new ResourcePoolConfig.Builder()<br>        .setName(&quot;dbconnectionpool&quot;)<br>        .setMaxTotal(16)<br>        .setMaxIdle(10)<br>        .setMinIdle(12)<br>        .build();</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 07:03:51</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/QYKSUV20DMgBHAPLfgngdw4N8FHRCSBLCJueVRu9Ya1Ba2x4icx70zoVVFOZtG1K6TkHj5CFbuztQhRFyCjWXHQ/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>zaab</span>
  </div>
  <div class="_2_QraFYR_0">å†™å¾—çœŸå¥½ï¼Œä¹‹å‰çœ‹äº†å‡ æ¬¡ä¸çŸ¥é“å»ºé€ è€…æ¨¡å¼çš„ä½œç”¨ï¼Œä¸çŸ¥é“ä¸ºå•¥çœ‹äº†ä¸€ä¸‹è¿™ç¯‡æˆ‘å°±ç†è§£äº†ã€‚ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-12-11 10:16:41</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIma3PJUyqDEQKt40nEh3Jt840af6hKnuK8k8dIscm43EUzJwLvynbxRnvO9Ivibv7KssUSqoBdY1w/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„éœ€è¦</span>
  </div>
  <div class="_2_QraFYR_0">æ€»æ„Ÿè§‰åªæ˜¯æŠŠæ ¡éªŒé€»è¾‘æŒªåˆ°äº†bulder é‡Œã€‚æ²¡ç›´è§‚çš„æ„Ÿè§‰åˆ°builder çš„æœ‰ç‚¹å‘¢ã€‚è€å¸ˆ~</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 16:07:27</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/8a/02/828938c9.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Frank</span>
  </div>
  <div class="_2_QraFYR_0">å½“åœ¨å¼€å‘ä¸­éœ€è¦åˆ›å»ºä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œå¦‚æœå¿…å¡«å±æ€§å¾ˆå¤šï¼Œå±æ€§å­˜åœ¨å¤æ‚çš„æ ¡éªŒå’Œå±æ€§ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ¥é¿å…ç±»çš„æ„é€ å‡½æ•°å‚æ•°åˆ—è¡¨è¿‡é•¿ï¼Œå¯¼è‡´å¯è¯»æ€§å·®ï¼Œä¸æ˜“ä½¿ç”¨çš„é—®é¢˜ã€‚å»ºé€ è€…æ¨¡å¼å¯ä»¥å°†ç±»çš„æ„é€ æ–¹æ³•ç§æœ‰ï¼Œä¸æä¾›ç±»çš„setteræ–¹æ³•ï¼Œå› æ­¤å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸å˜çš„å¯¹è±¡ã€‚åŒæ—¶åœ¨æŸäº›åœºæ™¯ä¸‹å°†å±æ€§æ„é€ å¥½å¯ä»¥è§£å†³ç±»çš„æ— æ•ˆçŠ¶æ€ã€‚<br>ä½¿ç”¨æ€è·¯ï¼šæŠŠæ ¡éªŒé€»è¾‘æ”¾ç½®åˆ° Builder ç±»ä¸­ï¼Œå…ˆåˆ›å»ºå»ºé€ è€…ï¼Œå¹¶ä¸”é€šè¿‡ set() æ–¹æ³•è®¾ç½®å»ºé€ è€…çš„å˜é‡å€¼ï¼Œç„¶ååœ¨ä½¿ç”¨ build() æ–¹æ³•çœŸæ­£åˆ›å»ºå¯¹è±¡ä¹‹å‰ï¼Œåšé›†ä¸­çš„æ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡ä¹‹åæ‰ä¼šåˆ›å»ºå¯¹è±¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æŠŠä¸»ç±»çš„æ„é€ å‡½æ•°ä¸ºäº†private ç§æœ‰æƒé™ï¼Œåªèƒ½é€šè¿‡å»ºé€ è€…æ¥åˆ›å»º ç±»å¯¹è±¡ï¼Œå¹¶ä¸”ä¸»ç±»æ²¡æœ‰æä¾›ä»»ä½• set() æ–¹æ³•ï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡å°±æ˜¯ä¸å¯å˜å¯¹è±¡äº†ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-02-17 09:53:11</div>
  </div>
</div>
</div>
</li>
</ul>